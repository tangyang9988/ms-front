/*
 Leaflet 1.0.3+ed36a04, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2016 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*//* esri-leaflet - v2.0.8 - Tue Mar 21 2017 16:10:14 GMT-0700 (PDT)
 * Copyright (c) 2017 Environmental Systems Research Institute, Inc.
 * Apache-2.0 *//* globals L.Terraformer *//*
	Leaflet.contextmenu, a context menu for Leaflet.
	(c) 2015, Adam Ratcliffe, GeoSmart Maps Limited

	@preserve
*//*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster
 (c) 2012-2013, Dave Leaver, smartrak
*//*
 Leaflet.draw 0.4.9, a plugin that adds drawing and editing tools to Leaflet powered maps.
 (c) 2012-2017, Jacob Toye, Jon West, Smartrak, Leaflet

 https://github.com/Leaflet/Leaflet.draw
 http://leafletjs.com
 *//* global L */

// A layer control which provides for layer groupings.
// Author: Ishmael Smyrnow
/*
 (c) 2014, Vladimir Agafonkin
 simpleheat, a tiny JavaScript library for drawing heatmaps with Canvas
 https://github.com/mourner/simpleheat
*//**
 * [initialize description]
 * @param  {[type]} url                     [description]
 * @param  {[type]} options)                {                    this._url [description]
 * @param  {[type]} this.defaultWmtsParams) [description]
 * @return {[type]}                         [description]
 */
/*


 chroma.js - JavaScript library for color conversions

 Copyright (c) 2011-2017, Gregor Aisch
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:

 1. Redistributions of source code must retain the above copyright notice, this
    list of conditions and the following disclaimer.

 2. Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.

 3. The name Gregor Aisch may not be used to endorse or promote products
    derived from this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


*/
(function(f,g){"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define(g):f.proj4=g()})(this,function(){function f(a,b){if(a[b])return a[b];for(var e=Object.keys(a),c=b.toLowerCase().replace(T,""),h=-1,k,y;++h<e.length;)if(k=e[h],y=k.toLowerCase().replace(T,""),y===c)return a[k]}function g(a){if("string"!==typeof a)throw Error("not a string");this.text=a.trim();this.place=this.level=0;this.root=null;this.stack=[];this.currentObject=null;this.state=1}function d(a,b,e){Array.isArray(b)&&(e.unshift(b),b=null);e=e.reduce(function(a,b){c(b,a);return a},b?{}:a);b&&(a[b]=e)}function c(a,b){if(Array.isArray(a)){var e=a.shift();"PARAMETER"===e&&(e=a.shift());if(1===a.length)Array.isArray(a[0])?(b[e]={},c(a[0],b[e])):b[e]=a[0];else if(a.length)if("TOWGS84"===e)b[e]=a;else{Array.isArray(e)||(b[e]={});var h;switch(e){case "UNIT":case "PRIMEM":case "VERT_DATUM":b[e]={name:a[0].toLowerCase(),convert:a[1]};3===a.length&&c(a[2],b[e]);break;case "SPHEROID":case "ELLIPSOID":b[e]={name:a[0],a:a[1],rf:a[2]};4===a.length&&c(a[3],b[e]);break;case "PROJECTEDCRS":case "PROJCRS":case "GEOGCS":case "GEOCCS":case "PROJCS":case "LOCAL_CS":case "GEODCRS":case "GEODETICCRS":case "GEODETICDATUM":case "EDATUM":case "ENGINEERINGDATUM":case "VERT_CS":case "VERTCRS":case "VERTICALCRS":case "COMPD_CS":case "COMPOUNDCRS":case "ENGINEERINGCRS":case "ENGCRS":case "FITTED_CS":case "LOCAL_DATUM":case "DATUM":a[0]=["name",a[0]];d(b,e,a);break;default:for(h=-1;++h<a.length;)if(!Array.isArray(a[h]))return c(a,b[e]);return d(b,e,a)}}else b[e]=!0}else b[a]=!0}function b(a){return.017453292519943295*a}function l(a){function e(b){return b*(a.to_meter||1)}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):a.projName="object"===typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION;a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&("GEOGCS"===a.type?a.DATUM&&a.DATUM.SPHEROID&&(a.to_meter=a.UNIT.convert*a.DATUM.SPHEROID.a):(a.to_meter=a.UNIT.convert,10)));var c=a.GEOGCS;"GEOGCS"===a.type&&(c=a);if(c){a.datumCode=c.DATUM?c.DATUM.name.toLowerCase():c.name.toLowerCase();"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2));if("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)a.datumCode="nzgd49";"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84");"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6));"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8));~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72");c.DATUM&&c.DATUM.SPHEROID&&(a.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=c.DATUM.SPHEROID.a,a.rf=parseFloat(c.DATUM.SPHEROID.rf,10));~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")}a.b&&!isFinite(a.b)&&(a.b=a.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",b],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",b],["x0","false_easting",e],["y0","false_northing",e],["long0","central_meridian",b],["lat0","latitude_of_origin",b],["lat0","standard_parallel_1",b],["lat1","standard_parallel_1",b],["lat2","standard_parallel_2",b],["alpha","azimuth",b],["srsCode","name"]].forEach(function(b){var e=b[0],c=b[1];!(e in a)&&c in a&&(a[e]=a[c],3===b.length&&(a[e]=b[2](a[e])))});a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc);a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=.017453292519943295*(0<a.lat1?90:-90),a.lat_ts=a.lat1)}function a(b){var e=this;if(2===arguments.length){var c=arguments[1];"string"===typeof c?"+"===c.charAt(0)?a[b]=M(arguments[1]):a[b]=la(arguments[1]):a[b]=c}else if(1===arguments.length){if(Array.isArray(b))return b.map(function(b){Array.isArray(b)?a.apply(e,b):a(b)});if("string"===typeof b){if(b in a)return a[b]}else"EPSG"in b?a["EPSG:"+b.EPSG]=b:"ESRI"in b?a["ESRI:"+b.ESRI]=b:"IAU2000"in b?a["IAU2000:"+b.IAU2000]=b:console.log(b)}}function e(a){return da.some(function(b){return-1<a.indexOf(b)})}function h(b){if("string"===typeof b){if(b in a)return a[b];if(e(b))return la(b);if("+"===b[0])return M(b)}else return b}function k(a){return a}function n(a,b){var e=ha.length;if(!a.names)return console.log(b),!0;ha[e]=a;a.names.forEach(function(a){qa[a.toLowerCase()]=e});return this}function m(a,b,e,c){e=a*a;b*=b;var h=(e-b)/e,k=0;c?(a*=1-h*(.16666666666666666+h*(.04722222222222222+.022156084656084655*h)),e=a*a,h=0):k=Math.sqrt(h);return{es:h,e:k,ep2:(e-b)/b}}function t(a,b,e,c,h){a||((e=f(sa,c))||(e=Aa),a=e.a,b=e.b,e=e.rf);e&&!b&&(b=(1-1/e)*a);if(0===e||Math.abs(a-b)<v)h=!0,b=a;return{a:a,b:b,rf:e,sphere:h}}function p(a,b,e,c,h,k){var y={};y.datum_type=void 0===a||"none"===a?5:4;if(b){y.datum_params=b.map(parseFloat);if(0!==y.datum_params[0]||0!==y.datum_params[1]||0!==y.datum_params[2])y.datum_type=1;3<y.datum_params.length&&(0!==y.datum_params[3]||0!==y.datum_params[4]||0!==y.datum_params[5]||0!==y.datum_params[6])&&(y.datum_type=2,y.datum_params[3]*=4.84813681109536E-6,y.datum_params[4]*=4.84813681109536E-6,y.datum_params[5]*=4.84813681109536E-6,y.datum_params[6]=y.datum_params[6]/1E6+1)}y.a=e;y.b=c;y.es=h;y.ep2=k;return y}function r(a,b){if(!(this instanceof r))return new r(a);b=b||function(a){if(a)throw a;};var e=h(a);if("object"!==typeof e)b(a);else{var c=r.projections.get(e.projName);if(c){if(e.datumCode&&"none"!==e.datumCode){var k=f(P,e.datumCode);k&&(e.datum_params=k.towgs84?k.towgs84.split(","):null,e.ellps=k.ellipse,e.datumName=k.datumName?k.datumName:e.datumCode)}e.k0=e.k0||1;e.axis=e.axis||"enu";e.ellps=e.ellps||"wgs84";var k=t(e.a,e.b,e.rf,e.ellps,e.sphere),y=m(k.a,k.b,k.rf,e.R_A),d=e.datum||p(e.datumCode,e.datum_params,k.a,k.b,y.es,y.ep2);ta(this,e);ta(this,c);this.a=k.a;this.b=k.b;this.rf=k.rf;this.sphere=k.sphere;this.es=y.es;this.e=y.e;this.ep2=y.ep2;this.datum=d;this.init();b(null,this)}else b(a)}}function q(a){return 1===a||2===a}function x(a,b,e){var c;Array.isArray(e)&&(e=ra(e));a.datum&&b.datum&&((1===a.datum.datum_type||2===a.datum.datum_type)&&"WGS84"!==b.datumCode||(1===b.datum.datum_type||2===b.datum.datum_type)&&"WGS84"!==a.datumCode)&&(c=new r("WGS84"),e=x(a,c,e),a=c);"enu"!==a.axis&&(e=na(a,!1,e));"longlat"===a.projName?e={x:.017453292519943295*e.x,y:.017453292519943295*e.y}:(a.to_meter&&(e={x:e.x*a.to_meter,y:e.y*a.to_meter}),e=a.inverse(e));a.from_greenwich&&(e.x+=a.from_greenwich);c=a.datum;a=b.datum;if(!((c.datum_type!==a.datum_type?0:c.a!==a.a||5E-11<Math.abs(c.es-a.es)?0:1===c.datum_type?c.datum_params[0]===a.datum_params[0]&&c.datum_params[1]===a.datum_params[1]&&c.datum_params[2]===a.datum_params[2]:2===c.datum_type?c.datum_params[0]===a.datum_params[0]&&c.datum_params[1]===a.datum_params[1]&&c.datum_params[2]===a.datum_params[2]&&c.datum_params[3]===a.datum_params[3]&&c.datum_params[4]===a.datum_params[4]&&c.datum_params[5]===a.datum_params[5]&&c.datum_params[6]===a.datum_params[6]:1)||5===c.datum_type||5===a.datum_type||c.es===a.es&&c.a===a.a&&!q(c.datum_type)&&!q(a.datum_type))){b:{var h=c.es,k=e.x,d=e.y;e=e.z?e.z:0;var y,f;if(d<-z&&d>-1.001*z)d=-z;else if(d>z&&d<1.001*z)d=z;else if(d<-z||d>z){e=null;break b}k>Math.PI&&(k-=2*Math.PI);y=Math.sin(d);f=Math.cos(d);d=c.a/Math.sqrt(1-h*y*y);e={x:(d+e)*f*Math.cos(k),y:(d+e)*f*Math.sin(k),z:(d*(1-h)+e)*y}}q(c.datum_type)&&(h=c.datum_type,c=c.datum_params,1===h?e={x:e.x+c[0],y:e.y+c[1],z:e.z+c[2]}:2===h?(h=c[3],k=c[4],y=c[5],d=c[6],e={x:d*(e.x-y*e.y+k*e.z)+c[0],y:d*(y*e.x+e.y-h*e.z)+c[1],z:d*(-k*e.x+h*e.y+e.z)+c[2]}):e=void 0);if(q(a.datum_type))if(h=a.datum_type,c=a.datum_params,1===h)e={x:e.x-c[0],y:e.y-c[1],z:e.z-c[2]};else if(2===h){h=c[3];k=c[4];y=c[5];var l=c[6],d=(e.x-c[0])/l;f=(e.y-c[1])/l;e=(e.z-c[2])/l;e={x:d+y*f-k*e,y:-y*d+f+h*e,z:k*d-h*f+e}}else e=void 0;b:{c=a.es;a=a.a;var n,g,S,Pa;y=e.x;f=e.y;var k=e.z?e.z:0,m,h=Math.sqrt(y*y+f*f),d=Math.sqrt(y*y+f*f+k*k);if(1E-12>h/a){if(y=0,1E-12>d/a){e={x:e.x,y:e.y,z:e.z};break b}}else y=Math.atan2(f,y);e=k/d;d=h/d;n=1/Math.sqrt(1-c*(2-c)*d*d);f=d*(1-c)*n;l=e*n;Pa=0;do Pa++,g=a/Math.sqrt(1-c*l*l),m=h*f+k*l-g*(1-c*l*l),g=c*g/(g+m),n=1/Math.sqrt(1-g*(2-g)*d*d),g=d*(1-g)*n,n*=e,S=n*f-g*l,f=g,l=n;while(1E-24<S*S&&30>Pa);e={x:y,y:Math.atan(n/Math.abs(g)),z:m}}}b.from_greenwich&&(e={x:e.x-b.from_greenwich,y:e.y});"longlat"===b.projName?e={x:57.29577951308232*e.x,y:57.29577951308232*e.y}:(e=b.forward(e),b.to_meter&&(e={x:e.x/b.to_meter,y:e.y/b.to_meter}));return"enu"!==b.axis?na(b,!0,e):e}function A(a,b,e){return Array.isArray(e)?(a=x(a,b,e),3===e.length?[a.x,a.y,a.z]:[a.x,a.y]):x(a,b,e)}function F(a){return a instanceof r?a:a.oProj?a.oProj:r(a)}function D(a,b,e){a=F(a);var c=!1;if("undefined"===typeof b)b=a,a=Ba,c=!0;else if("undefined"!==typeof b.x||Array.isArray(b))e=b,b=a,a=Ba,c=!0;b=F(b);if(e)return A(a,b,e);e={forward:function(e){return A(a,b,e)},inverse:function(e){return A(b,a,e)}};c&&(e.oProj=b);return e}function E(a,b){var e,c,h,k=a[1],d=a[0],f;e=Math.PI/180*k;h=Math.PI/180*d;var y,l;l=Math.floor((d+180)/6)+1;180===d&&(l=60);56<=k&&64>k&&3<=d&&12>d&&(l=32);72<=k&&84>k&&(0<=d&&9>d?l=31:9<=d&&21>d?l=33:21<=d&&33>d?l=35:33<=d&&42>d&&(l=37));y=Math.PI/180*(6*(l-1)-180+3);d=6378137/Math.sqrt(1-.00669438*Math.sin(e)*Math.sin(e));f=Math.tan(e)*Math.tan(e);c=.006739496752268451*Math.cos(e)*Math.cos(e);h=Math.cos(e)*(h-y);e=.9996*(6378137*(.9983242984503243*e-.002514607064228144*Math.sin(2*e)+2.639046602129982E-6*Math.sin(4*e)-3.4180461016968582E-9*Math.sin(6*e))+d*Math.tan(e)*(h*h/2+(5-f+9*c+4*c*c)*h*h*h*h/24+(61-58*f+f*f+600*c-2.2240339282485886)*h*h*h*h*h*h/720));0>k&&(e+=1E7);e=Math.round(e);c=Math.round(.9996*d*(h+(1-f+c)*h*h*h/6+(5-18*f+f*f+72*c-.39089081163157013)*h*h*h*h*h/120)+5E5);h=l;f="Z";84>=k&&72<=k?f="X":72>k&&64<=k?f="W":64>k&&56<=k?f="V":56>k&&48<=k?f="U":48>k&&40<=k?f="T":40>k&&32<=k?f="S":32>k&&24<=k?f="R":24>k&&16<=k?f="Q":16>k&&8<=k?f="P":8>k&&0<=k?f="N":0>k&&-8<=k?f="M":-8>k&&-16<=k?f="L":-16>k&&-24<=k?f="K":-24>k&&-32<=k?f="J":-32>k&&-40<=k?f="H":-40>k&&-48<=k?f="G":-48>k&&-56<=k?f="F":-56>k&&-64<=k?f="E":-64>k&&-72<=k?f="D":-72>k&&-80<=k&&(f="C");k=b||5;l="00000"+c;d="00000"+e;f=h+f;y=u(h);c=Math.floor(c/1E5);h=Math.floor(e/1E5)%20;--y;e="AJSAJS".charCodeAt(y);y="AFAFAF".charCodeAt(y);c=e+c-1;h=y+h;var n=!1;90<c&&(c=c-90+65-1,n=!0);(73===c||73>e&&73<c||(73<c||73>e)&&n)&&c++;if(79===c||79>e&&79<c||(79<c||79>e)&&n)c++,73===c&&c++;90<c&&(c=c-90+65-1);86<h?(h=h-86+65-1,n=!0):n=!1;(73===h||73>y&&73<h||(73<h||73>y)&&n)&&h++;if(79===h||79>y&&79<h||(79<h||79>y)&&n)h++,73===h&&h++;86<h&&(h=h-86+65-1);e=String.fromCharCode(c)+String.fromCharCode(h);return f+e+l.substr(l.length-5,k)+d.substr(d.length-5,k)}function H(a){a=U(I(a.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat]:[(a.left+a.right)/2,(a.top+a.bottom)/2]}function U(a){var b=a.easting,e=a.zoneNumber;if(0>e||60<e)return null;var c=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),h,k,d,f;k=a.northing;"N">a.zoneLetter&&(k-=1E7);k=k/.9996/6367449.145945056;f=k+(3*c/2-27*c*c*c/32)*Math.sin(2*k)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*k)+151*c*c*c/96*Math.sin(6*k);h=6378137/Math.sqrt(1-.00669438*Math.sin(f)*Math.sin(f));c=Math.tan(f)*Math.tan(f);k=.006739496752268451*Math.cos(f)*Math.cos(f);d=6335439.32722994/Math.pow(1-.00669438*Math.sin(f)*Math.sin(f),1.5);b=(b-5E5)/(.9996*h);h=f-h*Math.tan(f)/d*(b*b/2-(5+3*c+10*k-4*k*k-.06065547077041606)*b*b*b*b/24+(61+90*c+298*k+45*c*c-1.6983531815716497-3*k*k)*b*b*b*b*b*b/720);h=h/Math.PI*180;b=(b-(1+2*c+k)*b*b*b/6+(5-2*k+28*c-3*k*k+.05391597401814761+24*c*c)*b*b*b*b*b/120)/Math.cos(f);b=6*(e-1)-180+3+b/Math.PI*180;a.accuracy?(a=U({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,right:a.lon,bottom:h,left:b}):a={lat:h,lon:b};return a}function u(a){a%=6;0===a&&(a=6);return a}function I(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b=a.length,e,c="",h,k=0;!/[A-Z]/.test(h=a.charAt(k));){if(2<=k)throw"MGRSPoint bad conversion from: "+a;c+=h;k++}c=parseInt(c,10);if(0===k||k+3>b)throw"MGRSPoint bad conversion from: "+a;h=a.charAt(k++);if("A">=h||"B"===h||"Y"===h||"Z"<=h||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;e=a.substring(k,k+=2);var d=u(c),f;f=e.charAt(0);for(var y="AJSAJS".charCodeAt(d-1),l=1E5,n=!1;y!==f.charCodeAt(0);){y++;73===y&&y++;79===y&&y++;if(90<y){if(n)throw"Bad character: "+f;y=65;n=!0}l+=1E5}f=l;e=e.charAt(1);if("V"<e)throw"MGRSPoint given invalid Northing "+e;d="AFAFAF".charCodeAt(d-1);y=0;for(l=!1;d!==e.charCodeAt(0);){d++;73===d&&d++;79===d&&d++;if(86<d){if(l)throw"Bad character: "+e;d=65;l=!0}y+=1E5}for(d=y;d<N(h);)d+=2E6;b-=k;if(0!==b%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var b=b/2,y=e=0,g;0<b&&(g=1E5/Math.pow(10,b),e=a.substring(k,k+b),e=parseFloat(e)*g,a=a.substring(k+b),y=parseFloat(a)*g);return{easting:e+f,northing:y+d,zoneLetter:h,zoneNumber:c,accuracy:g}}function N(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}function G(a,b,e){if(!(this instanceof G))return new G(a,b,e);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"===typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"===typeof a&&"undefined"===typeof b?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0):(this.x=a,this.y=b,this.z=e||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var z=Math.PI/2,v="undefined"===typeof Number.EPSILON?1E-10:Number.EPSILON,O=Math.PI/4,V=2*Math.PI,ba={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Y={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},T=/[\s_\-\/\(\)]/g,M=function(a){var b={};a=a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,b){var e=b.split("\x3d");e.push(!0);a[e[0].toLowerCase()]=e[1];return a},{});var e,c,h,k={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=.017453292519943295*a},lat_1:function(a){b.lat1=.017453292519943295*a},lat_2:function(a){b.lat2=.017453292519943295*a},lat_ts:function(a){b.lat_ts=.017453292519943295*a},lon_0:function(a){b.long0=.017453292519943295*a},lon_1:function(a){b.long1=.017453292519943295*a},lon_2:function(a){b.long2=.017453292519943295*a},alpha:function(a){b.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){b.longc=.017453292519943295*a},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},units:function(a){b.units=a;if(a=f(Y,a))b.to_meter=a.to_meter},from_greenwich:function(a){b.from_greenwich=.017453292519943295*a},pm:function(a){var e=f(ba,a);b.from_greenwich=.017453292519943295*(e?e:parseFloat(a))},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(b.axis=a)}};for(e in a)c=a[e],e in k?(h=k[e],"function"===typeof h?h(c):b[h]=c):b[e]=c;"string"===typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase());return b},C=/\s/,Z=/[A-Za-z]/,aa=/[A-Za-z84]/,Q=/[,\]]/,ua=/[\d\.E\-\+]/;g.prototype.readCharicter=function(){var a=this.text[this.place++];if(4!==this.state)for(;C.test(a);){if(this.place>=this.text.length)return;a=this.text[this.place++]}switch(this.state){case 1:return this.neutral(a);case 2:return this.keyword(a);case 4:return this.quoted(a);case 5:return this.afterquote(a);case 3:return this.number(a)}};g.prototype.afterquote=function(a){if('"'===a)this.word+='"',this.state=4;else if(Q.test(a))this.word=this.word.trim(),this.afterItem(a);else throw Error("havn't handled \""+a+'" in afterquote yet, index '+this.place);};g.prototype.afterItem=function(a){","===a?(null!==this.word&&this.currentObject.push(this.word),this.word=null,this.state=1):"]"===a&&(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=-1))};g.prototype.number=function(a){if(ua.test(a))this.word+=a;else if(Q.test(a))this.word=parseFloat(this.word),this.afterItem(a);else throw Error("havn't handled \""+a+'" in number yet, index '+this.place);};g.prototype.quoted=function(a){'"'===a?this.state=5:this.word+=a};g.prototype.keyword=function(a){if(aa.test(a))this.word+=a;else if("["===a)a=[],a.push(this.word),this.level++,null===this.root?this.root=a:this.currentObject.push(a),this.stack.push(this.currentObject),this.currentObject=a,this.state=1;else if(Q.test(a))this.afterItem(a);else throw Error("havn't handled \""+a+'" in keyword yet, index '+this.place);};g.prototype.neutral=function(a){if(Z.test(a))this.word=a,this.state=2;else if('"'===a)this.word="",this.state=4;else if(ua.test(a))this.word=a,this.state=3;else if(Q.test(a))this.afterItem(a);else throw Error("havn't handled \""+a+'" in neutral yet, index '+this.place);};g.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw Error('unable to parse string "'+this.text+'". State is '+this.state);};var la=function(a){a=(new g(a)).output();var b=a.shift(),e=a.shift();a.unshift(["name",e]);a.unshift(["type",b]);b={};c(a,b);l(b);return b};(function(a){a("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");a("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");a("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");a.WGS84=a["EPSG:4326"];a["EPSG:3785"]=a["EPSG:3857"];a.GOOGLE=a["EPSG:3857"];a["EPSG:900913"]=a["EPSG:3857"];a["EPSG:102113"]=a["EPSG:3857"]})(a);var da="PROJECTEDCRS PROJCRS GEOGCS GEOCCS PROJCS LOCAL_CS GEODCRS GEODETICCRS GEODETICDATUM ENGCRS ENGINEERINGCRS".split(" "),ta=function(a,b){a=a||{};var e,c;if(!b)return a;for(c in b)e=b[c],void 0!==e&&(a[c]=e);return a},W=function(a,b,e){a*=b;return e/Math.sqrt(1-a*a)},w=function(a){return 3.14159265359>=Math.abs(a)?a:a-(0>a?-1:1)*V},R=function(a,b,e){e*=a;e=Math.pow((1-e)/(1+e),.5*a);return Math.tan(.5*(z-b))/e},ia=function(a,b){for(var e=.5*a,c,h=z-2*Math.atan(b),k=0;15>=k;k++)if(c=a*Math.sin(h),c=z-2*Math.atan(b*Math.pow((1-c)/(1+c),e))-h,h+=c,1E-10>=Math.abs(c))return h;return-9999},Ca=[{init:function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):W(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(a){var b=a.x,e=a.y;if(90<57.29577951308232*e&&-90>57.29577951308232*e&&180<57.29577951308232*b&&-180>57.29577951308232*b||Math.abs(Math.abs(e)-z)<=v)return null;this.sphere?(b=this.x0+this.a*this.k0*w(b-this.long0),e=this.y0+this.a*this.k0*Math.log(Math.tan(O+.5*e))):(e=R(this.e,e,Math.sin(e)),b=this.x0+this.a*this.k0*w(b-this.long0),e=this.y0-this.a*this.k0*Math.log(e));a.x=b;a.y=e;return a},inverse:function(a){var b=a.x-this.x0,e=a.y-this.y0;if(this.sphere)e=z-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else if(e=ia(this.e,Math.exp(-e/(this.a*this.k0))),-9999===e)return null;b=w(this.long0+b/(this.a*this.k0));a.x=b;a.y=e;return a},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:k,inverse:k,names:["longlat","identity"]}],qa={},ha=[],Da={start:function(){Ca.forEach(n)},add:n,get:function(a){if(!a)return!1;a=a.toLowerCase();if("undefined"!==typeof qa[a]&&ha[qa[a]])return ha[qa[a]]}},sa={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Aa=sa.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};sa.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"};var P={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};r.projections=Da;r.projections.start();var na=function(a,b,e){var c=e.x,h=e.y,k=e.z||0,d,f,l,n={};for(l=0;3>l;l++)if(!b||2!==l||void 0!==e.z)switch(0===l?(d=c,f="x"):1===l?(d=h,f="y"):(d=k,f="z"),a.axis[l]){case "e":n[f]=d;break;case "w":n[f]=-d;break;case "n":n[f]=d;break;case "s":n[f]=-d;break;case "u":void 0!==e[f]&&(n.z=d);break;case "d":void 0!==e[f]&&(n.z=-d);break;default:return null}return n},ra=function(a){var b={x:a[0],y:a[1]};2<a.length&&(b.z=a[2]);3<a.length&&(b.m=a[3]);return b},Ba=r("WGS84"),Ea={forward:E,inverse:function(a){a=U(I(a.toUpperCase()));return a.lat&&a.lon?[a.lon,a.lat,a.lon,a.lat]:[a.left,a.bottom,a.right,a.top]},toPoint:H};G.fromMGRS=function(a){return new G(H(a))};G.prototype.toMGRS=function(a){return E([this.x,this.y],a)};var va=function(a){var b=[];b[0]=1-a*(.25+a*(.046875+a*(.01953125+.01068115234375*a)));b[1]=a*(.75-a*(.046875+a*(.01953125+.01068115234375*a)));var e=a*a;b[2]=e*(.46875-a*(.013020833333333334+.007120768229166667*a));e*=a;b[3]=e*(.3645833333333333-.005696614583333333*a);b[4]=e*a*.3076171875;return b},ea=function(a,b,e,c){e*=b;b*=b;return c[0]*a-e*(c[1]+b*(c[2]+b*(c[3]+b*c[4])))},ma=function(a,b,e){for(var c=1/(1-b),h=a,k=20;k;--k){var d=Math.sin(h),f=1-b*d*d,f=(ea(h,d,Math.cos(h),e)-a)*f*Math.sqrt(f)*c,h=h-f;if(Math.abs(f)<v)break}return h},X={init:function(){this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.es&&(this.en=va(this.es),this.ml0=ea(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(a){var b=a.y,e=w(a.x-this.long0),c,h=Math.sin(b),k=Math.cos(b);if(this.es){var d=k*e,f=Math.pow(d,2),l=this.ep2*Math.pow(k,2),n=Math.pow(l,2),g=Math.pow(Math.abs(k)>v?Math.tan(b):0,2),y=Math.pow(g,2);c=1-this.es*Math.pow(h,2);d/=Math.sqrt(c);b=ea(b,h,k,this.en);c=this.a*this.k0*d*(1+f/6*(1-g+l+f/20*(5-18*g+y+14*l-58*g*l+f/42*(61+179*y-y*g-479*g))))+this.x0;e=this.a*this.k0*(b-this.ml0+h*e*d/2*(1+f/12*(5-g+9*l+4*n+f/30*(61+y-58*g+270*l-330*g*l+f/56*(1385+543*y-y*g-3111*g)))))+this.y0}else{h=k*Math.sin(e);if(Math.abs(Math.abs(h)-1)<v)return 93;c=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0;e=k*Math.cos(e)/Math.sqrt(1-Math.pow(h,2));h=Math.abs(e);if(1<=h){if(h-1>v)return 93;e=0}else e=Math.acos(e);0>b&&(e=-e);e=this.a*this.k0*(e-this.lat0)+this.y0}a.x=c;a.y=e;return a},inverse:function(a){var b,e,c=1/this.a*(a.x-this.x0),h=1/this.a*(a.y-this.y0);if(this.es)if(b=this.ml0+h/this.k0,e=ma(b,this.es,this.en),Math.abs(e)<z){var h=Math.cos(e),k=Math.abs(h)>v?Math.tan(e):0,d=this.ep2*Math.pow(h,2),f=Math.pow(d,2),l=Math.pow(k,2),n=Math.pow(l,2);b=1-this.es*Math.pow(Math.sin(e),2);var c=c*Math.sqrt(b)/this.k0,g=Math.pow(c,2);b=e-b*k*g/(1-this.es)*.5*(1-g/12*(5+3*l-9*d*l+d-4*f-g/30*(61+90*l-252*d*l+45*n+46*d-g/56*(1385+3633*l+4095*n+1574*n*l))));e=w(this.long0+c*(1-g/6*(1+2*l+d-g/20*(5+28*l+24*n+8*d*l+6*d-g/42*(61+662*l+1320*n+720*n*l))))/h)}else b=z*(0>h?-1:1),e=0;else b=Math.exp(c/this.k0),e=.5*(b-1/b),d=Math.cos(this.lat0+h/this.k0),b=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(e,2))),b=Math.asin(b),0>h&&(b=-b),e=0===e&&0===d?0:w(Math.atan2(e,d)+this.long0);a.x=e;a.y=b;return a},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},S=function(a){a=Math.exp(a);return(a-1/a)/2},fa=function(a,b){a=Math.abs(a);b=Math.abs(b);var e=Math.max(a,b);return e*Math.sqrt(1+Math.pow(Math.min(a,b)/(e?e:1),2))},Fa=function(a,b){for(var e=2*Math.cos(2*b),c=a.length-1,h=a[c],k=0,d;0<=--c;)d=-k+e*h+a[c],k=h,h=d;return b+d*Math.sin(2*b)},J=function(a,b,e){var c=Math.sin(b);b=Math.cos(b);var h=S(e);e=Math.exp(e);e=(e+1/e)/2;for(var k=2*b*e,d=-2*c*h,f=a.length-1,l=a[f],n=0,g=0,y=0,m,B;0<=--f;)m=g,B=n,g=l,n=y,l=-m+k*g-d*n+a[f],y=-B+d*g+k*n;k=c*e;d=b*h;return[k*l-d*y,k*y+d*l]},K={init:function(){if(void 0===this.es||0>=this.es)throw Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0;this.y0=void 0!==this.y0?this.y0:0;this.long0=void 0!==this.long0?this.long0:0;this.lat0=void 0!==this.lat0?this.lat0:0;this.cgb=[];this.cbg=[];this.utg=[];this.gtu=[];var a=this.es/(1+Math.sqrt(1-this.es)),a=a/(2-a),b;this.cgb[0]=a*(2+a*(-2/3+a*(-2+a*(116/45+a*(26/45+-2854/675*a)))));this.cbg[0]=a*(-2+a*(2/3+a*(4/3+a*(-82/45+a*(32/45+4642/4725*a)))));b=a*a;this.cgb[1]=b*(7/3+a*(-1.6+a*(-227/45+a*(2704/315+2323/945*a))));this.cbg[1]=b*(5/3+a*(-16/15+a*(-13/9+a*(904/315+-1522/945*a))));b*=a;this.cgb[2]=b*(56/15+a*(-136/35+a*(-1262/105+73814/2835*a)));this.cbg[2]=b*(-26/15+a*(34/21+a*(1.6+-12686/2835*a)));b*=a;this.cgb[3]=b*(4279/630+a*(-332/35+-399572/14175*a));this.cbg[3]=b*(1237/630+a*(-2.4+-24832/14175*a));b*=a;this.cgb[4]=b*(4174/315+-144838/6237*a);this.cbg[4]=b*(-734/315+109598/31185*a);b*=a;this.cgb[5]=601676/22275*b;this.cbg[5]=444337/155925*b;b=Math.pow(a,2);this.Qn=this.k0/(1+a)*(1+b*(.25+b*(.015625+b/256)));this.utg[0]=a*(-.5+a*(2/3+a*(-37/96+a*(1/360+a*(81/512+-96199/604800*a)))));this.gtu[0]=a*(.5+a*(-2/3+a*(.3125+a*(41/180+a*(-127/288+7891/37800*a)))));this.utg[1]=b*(-1/48+a*(-1/15+a*(437/1440+a*(-46/105+.2890188388723545*a))));this.gtu[1]=b*(13/48+a*(-.6+a*(557/1440+a*(281/630+-1.0248393063822752*a))));b*=a;this.utg[2]=b*(-17/480+a*(37/840+a*(209/4480+-5569/90720*a)));this.gtu[2]=b*(61/240+a*(-103/140+a*(15061/26880+167603/181440*a)));b*=a;this.utg[3]=b*(-4397/161280+a*(11/504+830251/7257600*a));this.gtu[3]=b*(49561/161280+a*(-179/168+.9096203979276896*a));b*=a;this.utg[4]=b*(-4583/161280+108847/3991680*a);this.gtu[4]=b*(34729/80640+-1.713007555715889*a);b*=a;this.utg[5]=-.03233083094085698*b;this.gtu[5]=.6650675310896665*b;a=Fa(this.cbg,this.lat0);b=-this.Qn;for(var e=this.gtu,c=2*a,h=2*Math.cos(c),k=e.length-1,d=e[k],f=0,l;0<=--k;)l=-f+h*d+e[k],f=d,d=l;this.Zb=b*(a+Math.sin(c)*l)},forward:function(a){var b=w(a.x-this.long0),e=a.y,e=Fa(this.cbg,e),c=Math.sin(e),h=Math.cos(e),k=Math.sin(b),b=Math.cos(b),e=Math.atan2(c,b*h),b=Math.atan2(k*h,fa(c,h*b)),b=Math.tan(b),c=Math.abs(b),c=c*(1+c/(fa(1,c)+1)),h=1+c,k=h-1,c=0===k?c:c*Math.log(h)/k,b=0>b?-c:c,c=J(this.gtu,2*e,2*b),e=e+c[0],b=b+c[1];2.623395162778>=Math.abs(b)?(b=this.a*this.Qn*b+this.x0,e=this.a*(this.Qn*e+this.Zb)+this.y0):e=b=Infinity;a.x=b;a.y=e;return a},inverse:function(a){var b=1/this.a*(a.x-this.x0),e=1/this.a*(a.y-this.y0),e=(e-this.Zb)/this.Qn,b=b/this.Qn;if(2.623395162778>=Math.abs(b))var c=J(this.utg,2*e,2*b),e=e+c[0],b=b+c[1],b=Math.atan(S(b)),c=Math.cos(e),h=Math.sin(b),b=Math.cos(b),e=Math.atan2(Math.sin(e)*b,fa(h,b*c)),b=Math.atan2(h,b*c),b=w(b+this.long0),e=Fa(this.cgb,e);else e=b=Infinity;a.x=b;a.y=e;return a},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},oa={init:function(){var a;a=this.zone;void 0===a&&(a=Math.floor(30*(w(this.long0)+Math.PI)/Math.PI)+1,0>a?a=0:60<a&&(a=60));if(void 0===a)throw Error("unknown utm zone");this.lat0=0;this.long0=.017453292519943295*(6*Math.abs(a)-183);this.x0=5E5;this.y0=this.utmSouth?1E7:0;this.k0=.9996;K.init.apply(this);this.forward=K.forward;this.inverse=K.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},wa=function(a,b){return Math.pow((1-a)/(1+a),b)},Ga=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0),b=b*b;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*b*b/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+O)/(Math.pow(Math.tan(.5*this.lat0+O),this.C)*wa(this.e*a,this.ratexp))},ja=function(a){var b=a.x,e=a.y;a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+O),this.C)*wa(this.e*Math.sin(e),this.ratexp))-z;a.x=this.C*b;return a},B=function(a){for(var b=a.x/this.C,e=a.y,c=Math.pow(Math.tan(.5*e+O)/this.K,1/this.C),h=20;0<h;--h){e=2*Math.atan(c*wa(this.e*Math.sin(a.y),-.5*this.e))-z;if(1E-14>Math.abs(e-a.y))break;a.y=e}if(!h)return null;a.x=b;a.y=e;return a},ka={init:function(){Ga.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(a){var b,e,c,h;a.x=w(a.x-this.long0);ja.apply(this,[a]);b=Math.sin(a.y);e=Math.cos(a.y);c=Math.cos(a.x);h=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*e*c);a.x=h*e*Math.sin(a.x);a.y=h*(this.cosc0*b-this.sinc0*e*c);a.x=this.a*a.x+this.x0;a.y=this.a*a.y+this.y0;return a},inverse:function(a){var b,e,c,h;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(h=Math.sqrt(a.x*a.x+a.y*a.y))?(c=2*Math.atan2(h,this.R2),b=Math.sin(c),e=Math.cos(c),c=Math.asin(e*this.sinc0+a.y*b*this.cosc0/h),b=Math.atan2(a.x*b,h*this.cosc0*e-a.y*this.sinc0*b)):(c=this.phic0,b=0);a.x=b;a.y=c;B.apply(this,[a]);a.x=w(a.x+this.long0);return a},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},xa={init:function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=v&&(this.k0=.5*(1+(0>this.lat0?-1:1)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=v&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=v&&(this.k0=.5*this.cons*W(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/R(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=W(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-z,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(a){var b=a.x,e=a.y,c=Math.sin(e),h=Math.cos(e),k,d=w(b-this.long0);if(Math.abs(Math.abs(b-this.long0)-Math.PI)<=v&&Math.abs(e+this.lat0)<=v)return a.x=NaN,a.y=NaN,a;if(this.sphere)b=2*this.k0/(1+this.sinlat0*c+this.coslat0*h*Math.cos(d)),a.x=this.a*b*h*Math.sin(d)+this.x0,a.y=this.a*b*(this.coslat0*c-this.sinlat0*h*Math.cos(d))+this.y0;else{k=2*Math.atan(this.ssfn_(e,c,this.e))-z;h=Math.cos(k);k=Math.sin(k);if(Math.abs(this.coslat0)<=v)return c=R(this.e,e*this.con,this.con*c),c=2*this.a*this.k0*c/this.cons,a.x=this.x0+c*Math.sin(b-this.long0),a.y=this.y0-this.con*c*Math.cos(b-this.long0),a;Math.abs(this.sinlat0)<v?(b=2*this.a*this.k0/(1+h*Math.cos(d)),a.y=b*k):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*k+this.cosX0*h*Math.cos(d))),a.y=b*(this.cosX0*k-this.sinX0*h*Math.cos(d))+this.y0);a.x=b*h*Math.sin(d)+this.x0}return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,e,c,h=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){c=2*Math.atan(h/(.5*this.a*this.k0));b=this.long0;e=this.lat0;if(h<=v)return a.x=b,a.y=e,a;e=Math.asin(Math.cos(c)*this.sinlat0+a.y*Math.sin(c)*this.coslat0/h);b=Math.abs(this.coslat0)<v?0<this.lat0?w(this.long0+Math.atan2(a.x,-1*a.y)):w(this.long0+Math.atan2(a.x,a.y)):w(this.long0+Math.atan2(a.x*Math.sin(c),h*this.coslat0*Math.cos(c)-a.y*this.sinlat0*Math.sin(c)));a.x=b;a.y=e;return a}if(Math.abs(this.coslat0)<=v){if(h<=v)return e=this.lat0,b=this.long0,a.x=b,a.y=e,a;a.x*=this.con;a.y*=this.con;b=h*this.cons/(2*this.a*this.k0);e=this.con*ia(this.e,b);b=this.con*w(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else e=2*Math.atan(h*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,h<=v?c=this.X0:(c=Math.asin(Math.cos(e)*this.sinX0+a.y*Math.sin(e)*this.cosX0/h),b=w(this.long0+Math.atan2(a.x*Math.sin(e),h*this.cosX0*Math.cos(e)-a.y*this.sinX0*Math.sin(e)))),e=-1*ia(this.e,Math.tan(.5*(z+c)));a.x=b;a.y=e;return a},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(a,b,e){b*=e;return Math.tan(.5*(z+a))*Math.pow((1-b)/(1+b),.5*e)}},ga={init:function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),e=this.a,c=1/this.rf,c=2*c-Math.pow(c,2),h=this.e=Math.sqrt(c);this.R=this.k0*e*Math.sqrt(1-c)/(1-c*Math.pow(b,2));this.alpha=Math.sqrt(1+c/(1-c)*Math.pow(Math.cos(a),4));this.b0=Math.asin(b/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+a/2))+this.alpha*h/2*Math.log((1+h*b)/(1-h*b))},forward:function(a){var b=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-a.y/2))+this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))))+this.K))-Math.PI/4),e=this.alpha*(a.x-this.lambda0),c=Math.atan(Math.sin(e)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(e))),b=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(e));a.y=this.R/2*Math.log((1+Math.sin(b))/(1-Math.sin(b)))+this.y0;a.x=this.R*c+this.x0;return a},inverse:function(a){for(var b=(a.x-this.x0)/this.R,e=2*(Math.atan(Math.exp((a.y-this.y0)/this.R))-Math.PI/4),c=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(b)),b=this.lambda0+Math.atan(Math.sin(b)/(Math.cos(this.b0)*Math.cos(b)-Math.sin(this.b0)*Math.tan(e)))/this.alpha,h=c,k=-1E3,d=0;1E-7<Math.abs(h-k);){if(20<++d)return;e=1/this.alpha*(Math.log(Math.tan(Math.PI/4+c/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2));k=h;h=2*Math.atan(Math.exp(e))-Math.PI/2}a.x=b;a.y=h;return a},names:["somerc"]},pa={init:function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),e=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-e*e);a=R(this.e,this.lat0,a);b=this.bl/b*Math.sqrt((1-this.es)/(1-e*e));1>b*b&&(b=1);var c;if(isNaN(this.longc)){e=R(this.e,this.lat1,Math.sin(this.lat1));c=R(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(b+Math.sqrt(b*b-1))*Math.pow(a,this.bl):(b-Math.sqrt(b*b-1))*Math.pow(a,this.bl);var e=Math.pow(e,this.bl),h=Math.pow(c,this.bl);c=this.el/e;a=.5*(c-1/c);c=(this.el*this.el-h*e)/(this.el*this.el+h*e);e=(h-e)/(h+e);h=w(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(c*Math.tan(.5*this.bl*h)/e)/this.bl;this.long0=w(this.long0);e=w(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*e)/a);this.alpha=Math.asin(b*Math.sin(this.gamma0))}else c=0<=this.lat0?b+Math.sqrt(b*b-1):b-Math.sqrt(b*b-1),this.el=c*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/b),this.long0=this.longc-Math.asin(.5*(c-1/c)*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(b*b-1),Math.cos(this.alpha))},forward:function(a){var b=a.y,e=w(a.x-this.long0);if(Math.abs(Math.abs(b)-z)<=v)e=0<b?-1:1,b=this.al/this.bl*Math.log(Math.tan(O+e*this.gamma0*.5)),e=-1*e*z*this.al/this.bl;else var b=R(this.e,b,Math.sin(b)),b=this.el/Math.pow(b,this.bl),c=.5*(b-1/b),h=Math.sin(this.bl*e),b=(c*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/(.5*(b+1/b)),b=Math.abs(Math.abs(b)-1)<=v?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-b)/(1+b))/this.bl,e=Math.abs(Math.cos(this.bl*e))<=v?this.al*this.bl*e:this.al*Math.atan2(c*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*e))/this.bl;this.no_rot?(a.x=this.x0+e,a.y=this.y0+b):(e-=this.uc,a.x=this.x0+b*Math.cos(this.alpha)+e*Math.sin(this.alpha),a.y=this.y0+e*Math.cos(this.alpha)-b*Math.sin(this.alpha));return a},inverse:function(a){var b,e;this.no_rot?(e=a.y-this.y0,b=a.x-this.x0):(e=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var c=Math.exp(-1*this.bl*e/this.al);e=.5*(c-1/c);var h=Math.sin(this.bl*b/this.al),c=(h*Math.cos(this.gamma0)+e*Math.sin(this.gamma0))/(.5*(c+1/c)),k=Math.pow(this.el/Math.sqrt((1+c)/(1-c)),1/this.bl);Math.abs(c-1)<v?(a.x=this.long0,a.y=z):Math.abs(c+1)<v?(a.x=this.long0,a.y=-1*z):(a.y=ia(this.e,k),a.x=w(this.long0-Math.atan2(e*Math.cos(this.gamma0)-h*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl));return a},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},Qa={init:function(){this.lat2||(this.lat2=this.lat1);this.k0||(this.k0=1);this.x0=this.x0||0;this.y0=this.y0||0;if(!(Math.abs(this.lat1+this.lat2)<v)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),b=W(this.e,a,Math.cos(this.lat1)),e=R(this.e,this.lat1,a),c=Math.sin(this.lat2),h=W(this.e,c,Math.cos(this.lat2)),c=R(this.e,this.lat2,c),k=R(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>v?Math.log(b/h)/Math.log(e/c):a;isNaN(this.ns)&&(this.ns=a);this.f0=b/(this.ns*Math.pow(e,this.ns));this.rh=this.a*this.f0*Math.pow(k,this.ns);this.title||(this.title="Lambert Conformal Conic")}},forward:function(a){var b=a.x,e=a.y;Math.abs(2*Math.abs(e)-Math.PI)<=v&&(e=(0>e?-1:1)*(z-2*v));var c=Math.abs(Math.abs(e)-z);if(c>v)e=R(this.e,e,Math.sin(e)),e=this.a*this.f0*Math.pow(e,this.ns);else{c=e*this.ns;if(0>=c)return null;e=0}b=this.ns*w(b-this.long0);a.x=this.k0*e*Math.sin(b)+this.x0;a.y=this.k0*(this.rh-e*Math.cos(b))+this.y0;return a},inverse:function(a){var b,e,c,h=(a.x-this.x0)/this.k0,k=this.rh-(a.y-this.y0)/this.k0;0<this.ns?(b=Math.sqrt(h*h+k*k),e=1):(b=-Math.sqrt(h*h+k*k),e=-1);c=0;0!==b&&(c=Math.atan2(e*h,e*k));if(0!==b||0<this.ns){if(e=1/this.ns,b=Math.pow(b/(this.a*this.f0),e),b=ia(this.e,b),-9999===b)return null}else b=-z;c=w(c/this.ns+this.long0);a.x=c;a.y=b;return a},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Ra={init:function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq},forward:function(a){var b,e,c;b=a.y;c=w(a.x-this.long0);b=2*(Math.atan(this.k*Math.pow(Math.tan(b/2+this.s45),this.alfa)/Math.pow((1+this.e*Math.sin(b))/(1-this.e*Math.sin(b)),this.alfa*this.e/2))-this.s45);e=-c*this.alfa;c=Math.asin(Math.cos(this.ad)*Math.sin(b)+Math.sin(this.ad)*Math.cos(b)*Math.cos(e));b=this.n*Math.asin(Math.cos(b)*Math.sin(e)/Math.cos(c));c=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(c/2+this.s45),this.n);a.y=c*Math.cos(b)/1;a.x=c*Math.sin(b)/1;this.czech||(a.y*=-1,a.x*=-1);return a},inverse:function(a){var b,e,c;b=a.x;a.x=a.y;a.y=b;this.czech||(a.y*=-1,a.x*=-1);b=Math.sqrt(a.x*a.x+a.y*a.y);c=Math.atan2(a.y,a.x)/Math.sin(this.s0);e=2*(Math.atan(Math.pow(this.ro0/b,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);b=Math.asin(Math.cos(this.ad)*Math.sin(e)-Math.sin(this.ad)*Math.cos(e)*Math.cos(c));a.x=this.long0-Math.asin(Math.cos(e)*Math.sin(c)/Math.cos(b))/this.alfa;c=b;var h=e=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.e/2))-this.s45),1E-10>Math.abs(c-a.y)&&(e=1),c=a.y,h+=1;while(0===e&&15>h);return 15<=h?null:a},names:["Krovak","krovak"]},ca=function(a,b,e,c,h){return a*h-b*Math.sin(2*h)+e*Math.sin(4*h)-c*Math.sin(6*h)},Ja=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))},Ka=function(a){return.375*a*(1+.25*a*(1+.46875*a))},La=function(a){return.05859375*a*a*(1+.75*a)},Ma=function(a){return 35/3072*a*a*a},Ha=function(a,b,e){b*=e;return a/Math.sqrt(1-b*b)},Ia=function(a){return Math.abs(a)<z?a:a-(0>a?-1:1)*Math.PI},Oa=function(a,b,e,c,h){var k,d;k=a/b;for(var f=0;15>f;f++)if(d=(a-(b*k-e*Math.sin(2*k)+c*Math.sin(4*k)-h*Math.sin(6*k)))/(b-2*e*Math.cos(2*k)+4*c*Math.cos(4*k)-6*h*Math.cos(6*k)),k+=d,1E-10>=Math.abs(d))return k;return NaN},Sa={init:function(){this.sphere||(this.e0=Ja(this.es),this.e1=Ka(this.es),this.e2=La(this.es),this.e3=Ma(this.es),this.ml0=this.a*ca(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(a){var b,e,c=a.x,h=a.y,c=w(c-this.long0);if(this.sphere)b=this.a*Math.asin(Math.cos(h)*Math.sin(c)),e=this.a*(Math.atan2(Math.tan(h),Math.cos(c))-this.lat0);else{e=Math.sin(h);var k=Math.cos(h),d=Ha(this.a,this.e,e),f=Math.tan(h)*Math.tan(h);b=c*Math.cos(h);var c=b*b,l=this.es*k*k/(1-this.es),h=this.a*ca(this.e0,this.e1,this.e2,this.e3,h);b=d*b*(1-c*f*(1/6-(8-f+8*l)*c/120));e=h-this.ml0+d*e/k*c*(.5+(5-f+6*l)*c/24)}a.x=b+this.x0;a.y=e+this.y0;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,e=a.y/this.a,c;if(this.sphere)c=e+this.lat0,e=Math.asin(Math.sin(c)*Math.cos(b)),c=Math.atan2(Math.tan(b),Math.cos(c));else{c=Oa(this.ml0/this.a+e,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(c)-z)<=v)return a.x=this.long0,a.y=z,0>e&&(a.y*=-1),a;var e=Ha(this.a,this.e,Math.sin(c)),h=Math.pow(Math.tan(c),2),b=b*this.a/e,k=b*b,e=c-e*Math.tan(c)/(e*e*e/this.a/this.a*(1-this.es))*b*b*(.5-(1+3*h)*b*b/24);c=b*(1-k*(h/3+(1+3*h)*h*k/15))/Math.cos(c)}a.x=w(c+this.long0);a.y=Ia(e);return a},names:["Cassini","Cassini_Soldner","cass"]},ya=function(a,b){var e;return 1E-7<a?(e=a*b,(1-a*a)*(b/(1-e*e)-.5/a*Math.log((1-e)/(1+e)))):2*b},Ta={init:function(){var a=Math.abs(this.lat0);this.mode=Math.abs(a-z)<v?0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(a)<v?this.EQUIT:this.OBLIQ;if(0<this.es){this.qp=ya(this.e,1);this.mmf=.5/(1-this.es);var a=this.es,b,e=[];e[0]=.3333333333333333*a;b=a*a;e[0]+=.17222222222222222*b;e[1]=.06388888888888888*b;b*=a;e[0]+=.10257936507936508*b;e[1]+=.0664021164021164*b;e[2]=.016415012942191543*b;this.apa=e;switch(this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),a=Math.sin(this.lat0),this.sinb1=ya(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(a){var b,e,c,h,k,d,f,l;h=a.x;var n=a.y;h=w(h-this.long0);if(this.sphere)if(k=Math.sin(n),d=Math.cos(n),c=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){e=this.mode===this.EQUIT?1+d*c:1+this.sinph0*k+this.cosph0*d*c;if(e<=v)return null;e=Math.sqrt(2/e);b=e*d*Math.sin(h);e*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*d*c}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(c=-c);if(Math.abs(n+this.phi0)<v)return null;e=O-.5*n;e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e));b=e*Math.sin(h);e*=c}}else{l=f=d=0;c=Math.cos(h);h=Math.sin(h);k=Math.sin(n);k=ya(this.e,k);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)d=k/this.qp,f=Math.sqrt(1-d*d);switch(this.mode){case this.OBLIQ:l=1+this.sinb1*d+this.cosb1*f*c;break;case this.EQUIT:l=1+f*c;break;case this.N_POLE:l=z+n;k=this.qp-k;break;case this.S_POLE:l=n-z,k=this.qp+k}if(Math.abs(l)<v)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l);e=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*d-this.sinb1*f*c):(l=Math.sqrt(2/(1+f*c)))*d*this.ymf;b=this.xmf*l*f*h;break;case this.N_POLE:case this.S_POLE:0<=k?(b=(l=Math.sqrt(k))*h,e=c*(this.mode===this.S_POLE?l:-l)):b=e=0}}a.x=this.a*b+this.x0;a.y=this.a*e+this.y0;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=a.x/this.a,e=a.y/this.a,c,h,k,d;if(this.sphere){d=h=0;k=Math.sqrt(b*b+e*e);c=.5*k;if(1<c)return null;c=2*Math.asin(c);if(this.mode===this.OBLIQ||this.mode===this.EQUIT)d=Math.sin(c),h=Math.cos(c);switch(this.mode){case this.EQUIT:c=Math.abs(k)<=v?0:Math.asin(e*d/k);b*=d;e=h*k;break;case this.OBLIQ:c=Math.abs(k)<=v?this.phi0:Math.asin(h*this.sinph0+e*d*this.cosph0/k);b*=d*this.cosph0;e=(h-Math.sin(c)*this.sinph0)*k;break;case this.N_POLE:e=-e;c=z-c;break;case this.S_POLE:c-=z}b=0!==e||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(b,e):0}else{c=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){b/=this.dd;e*=this.dd;d=Math.sqrt(b*b+e*e);if(d<v)return a.x=0,a.y=this.phi0,a;k=2*Math.asin(.5*d/this.rq);h=Math.cos(k);b*=k=Math.sin(k);this.mode===this.OBLIQ?(c=h*this.sinb1+e*k*this.cosb1/d,e=d*this.cosb1*h-e*this.sinb1*k):(c=e*k/d,e=d*h)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){this.mode===this.N_POLE&&(e=-e);c=b*b+e*e;if(!c)return a.x=0,a.y=this.phi0,a;c=1-c/this.qp;this.mode===this.S_POLE&&(c=-c)}b=Math.atan2(b,e);e=Math.asin(c);c=this.apa;h=e+e;c=e+c[0]*Math.sin(h)+c[1]*Math.sin(h+h)+c[2]*Math.sin(h+h+h)}a.x=w(this.long0+b);a.y=c;return a},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},za=function(a){1<Math.abs(a)&&(a=1<a?1:-1);return Math.asin(a)},Ua={init:function(){Math.abs(this.lat1+this.lat2)<v||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=W(this.e3,this.sin_po,this.cos_po),this.qs1=ya(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=W(this.e3,this.sin_po,this.cos_po),this.qs2=ya(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ya(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>v?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(a){var b=a.x,e=a.y;this.sin_phi=Math.sin(e);this.cos_phi=Math.cos(e);var e=ya(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*e)/this.ns0,b=this.ns0*w(b-this.long0),c=this.rh-e*Math.cos(b)+this.y0;a.x=e*Math.sin(b)+this.x0;a.y=c;return a},inverse:function(a){var b,e,c;a.x-=this.x0;a.y=this.rh-a.y+this.y0;0<=this.ns0?(b=Math.sqrt(a.x*a.x+a.y*a.y),e=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),e=-1);c=0;0!==b&&(c=Math.atan2(e*a.x,e*a.y));e=b*this.ns0/this.a;this.sphere?b=Math.asin((this.c-e*e)/(2*this.ns0)):(b=(this.c-e*e)/this.ns0,b=this.phi1z(this.e3,b));c=w(c/this.ns0+this.long0);a.x=c;a.y=b;return a},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(a,b){var e,c,h,k,d=za(.5*b);if(a<v)return d;for(var f=a*a,l=1;25>=l;l++)if(e=Math.sin(d),c=Math.cos(d),h=a*e,k=1-h*h,e=.5*k*k/c*(b/(1-f)-e/k+.5/a*Math.log((1-h)/(1+h))),d+=e,1E-7>=Math.abs(e))return d;return null}},Va={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1},forward:function(a){var b,e,c,h,k;e=a.y;c=w(a.x-this.long0);b=Math.sin(e);e=Math.cos(e);h=Math.cos(c);k=this.sin_p14*b+this.cos_p14*e*h;0<k||Math.abs(k)<=v?(c=this.x0+1*this.a*e*Math.sin(c)/k,b=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*e*h)/k):(c=this.x0+this.infinity_dist*e*Math.sin(c),b=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*e*h));a.x=c;a.y=b;return a},inverse:function(a){var b,e,c,h;a.x=(a.x-this.x0)/this.a;a.y=(a.y-this.y0)/this.a;a.x/=this.k0;a.y/=this.k0;(b=Math.sqrt(a.x*a.x+a.y*a.y))?(h=Math.atan2(b,this.rc),e=Math.sin(h),c=Math.cos(h),h=za(c*this.sin_p14+a.y*e*this.cos_p14/b),b=Math.atan2(a.x*e,b*this.cos_p14*c-a.y*this.sin_p14*e),b=w(this.long0+b)):(h=this.phic0,b=0);a.x=b;a.y=h;return a},names:["gnom"]},Wa={init:function(){this.sphere||(this.k0=W(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(a){var b=a.y,e;e=w(a.x-this.long0);this.sphere?(e=this.x0+this.a*e*Math.cos(this.lat_ts),b=this.y0+this.a*Math.sin(b)/Math.cos(this.lat_ts)):(b=ya(this.e,Math.sin(b)),e=this.x0+this.a*this.k0*e,b=this.y0+this.a*b*.5/this.k0);a.x=e;a.y=b;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,e;if(this.sphere)b=w(this.long0+a.x/this.a/Math.cos(this.lat_ts)),e=Math.asin(a.y/this.a*Math.cos(this.lat_ts));else{a:if(b=this.e,e=2*a.y*this.k0/this.a,1E-6>Math.abs(Math.abs(e)-(1-(1-b*b)/(2*b)*Math.log((1-b)/(1+b)))))e=0>e?-1*z:z;else{for(var c=Math.asin(.5*e),h,k,d,f=0;30>f;f++)if(h=Math.sin(c),k=Math.cos(c),d=b*h,h=Math.pow(1-d*d,2)/(2*k)*(e/(1-b*b)-h/(1-d*d)+.5/b*Math.log((1-d)/(1+d))),c+=h,1E-10>=Math.abs(h)){e=c;break a}e=NaN}b=w(this.long0+a.x/(this.a*this.k0))}a.x=b;a.y=e;return a},names:["cea"]},Na={init:function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)},forward:function(a){var b=a.y,e=w(a.x-this.long0),b=Ia(b-this.lat0);a.x=this.x0+this.a*e*this.rc;a.y=this.y0+this.a*b;return a},inverse:function(a){var b=a.y;a.x=w(this.long0+(a.x-this.x0)/(this.a*this.rc));a.y=Ia(this.lat0+(b-this.y0)/this.a);return a},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Xa={init:function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=Ja(this.es);this.e1=Ka(this.es);this.e2=La(this.es);this.e3=Ma(this.es);this.ml0=this.a*ca(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(a){var b=a.y,e,c;e=w(a.x-this.long0);c=e*Math.sin(b);if(this.sphere)Math.abs(b)<=v?(e*=this.a,b=-1*this.a*this.lat0):(e=this.a*Math.sin(c)/Math.tan(b),b=this.a*(Ia(b-this.lat0)+(1-Math.cos(c))/Math.tan(b)));else if(Math.abs(b)<=v)e*=this.a,b=-1*this.ml0;else{var h=Ha(this.a,this.e,Math.sin(b))/Math.tan(b);e=h*Math.sin(c);b=this.a*ca(this.e0,this.e1,this.e2,this.e3,b)-this.ml0+h*(1-Math.cos(c))}a.x=e+this.x0;a.y=b+this.y0;return a},inverse:function(a){var b,e,c,h,k,d,f;b=a.x-this.x0;c=a.y-this.y0;if(this.sphere)if(Math.abs(c+this.a*this.lat0)<=v)b=w(b/this.a+this.long0),e=0;else{h=this.lat0+c/this.a;k=b*b/this.a/this.a+h*h;d=h;for(c=20;c;--c)if(f=Math.tan(d),f=-1*(h*(d*f+1)-d-.5*(d*d+k)*f)/((d-h)/f-1),d+=f,Math.abs(f)<=v){e=d;break}b=w(this.long0+Math.asin(b*Math.tan(d)/this.a)/Math.sin(e))}else if(Math.abs(c+this.ml0)<=v)e=0,b=w(this.long0+b/this.a);else{h=(this.ml0+c)/this.a;k=b*b/this.a/this.a+h*h;d=h;var l,n;for(c=20;c;--c)if(f=this.e*Math.sin(d),f=Math.sqrt(1-f*f)*Math.tan(d),l=this.a*ca(this.e0,this.e1,this.e2,this.e3,d),n=this.e0-2*this.e1*Math.cos(2*d)+4*this.e2*Math.cos(4*d)-6*this.e3*Math.cos(6*d),l/=this.a,f=(h*(f*l+1)-l-.5*f*(l*l+k))/(this.es*Math.sin(2*d)*(l*l+k-2*h*l)/(4*f)+(h-l)*(f*n-2/Math.sin(2*d))-n),d-=f,Math.abs(f)<=v){e=d;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e);b=w(this.long0+Math.asin(b*f/this.a)/Math.sin(e))}a.x=b;a.y=e;return a},names:["Polyconic","poly"]},Ya={init:function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013},forward:function(a){var b,e=a.x-this.long0,c=(a.y-this.lat0)/4.84813681109536E-6*1E-5,h=1,k=0;for(b=1;10>=b;b++)h*=c,k+=this.A[b]*h;var c=k,h=1,d=0,f=0,l=0;for(b=1;6>=b;b++)k=h*c-d*e,d=d*c+h*e,h=k,f=f+this.B_re[b]*h-this.B_im[b]*d,l=l+this.B_im[b]*h+this.B_re[b]*d;a.x=l*this.a+this.x0;a.y=f*this.a+this.y0;return a},inverse:function(a){var b,e=(a.y-this.y0)/this.a,c=(a.x-this.x0)/this.a,h=1,k=0,d,f=0,l=0;for(b=1;6>=b;b++)d=h*e-k*c,k=k*e+h*c,h=d,f=f+this.C_re[b]*h-this.C_im[b]*k,l=l+this.C_im[b]*h+this.C_re[b]*k;for(h=0;h<this.iterations;h++){var n=f,g=l,S;d=e;k=c;for(b=2;6>=b;b++)S=n*f-g*l,g=g*f+n*l,n=S,d+=(b-1)*(this.B_re[b]*n-this.B_im[b]*g),k+=(b-1)*(this.B_im[b]*n+this.B_re[b]*g);var n=1,g=0,m=this.B_re[1],B=this.B_im[1];for(b=2;6>=b;b++)S=n*f-g*l,g=g*f+n*l,n=S,m+=b*(this.B_re[b]*n-this.B_im[b]*g),B+=b*(this.B_im[b]*n+this.B_re[b]*g);l=m*m+B*B;f=(d*m+k*B)/l;l=(k*m-d*B)/l}e=f;c=1;f=0;for(b=1;9>=b;b++)c*=e,f+=this.D[b]*c;b=this.lat0+.484813681109536*f;a.x=this.long0+l;a.y=b;return a},names:["New_Zealand_Map_Grid","nzmg"]},Za={init:function(){},forward:function(a){var b=a.y,e=w(a.x-this.long0),b=this.y0+this.a*Math.log(Math.tan(Math.PI/4+b/2.5))*1.25;a.x=this.x0+this.a*e;a.y=b;return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b=w(this.long0+a.x/this.a),e=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);a.x=b;a.y=e;return a},names:["Miller_Cylindrical","mill"]},$a={init:function(){this.sphere?(this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=va(this.es)},forward:function(a){var b,e;b=a.x;e=a.y;b=w(b-this.long0);if(this.sphere){if(this.m)for(var c=this.n*Math.sin(e),h=20;h;--h){var k=(this.m*e+Math.sin(e)-c)/(this.m+Math.cos(e));e-=k;if(Math.abs(k)<v)break}else e=1!==this.n?Math.asin(this.n*Math.sin(e)):e;b=this.a*this.C_x*b*(this.m+Math.cos(e));e*=this.a*this.C_y}else c=Math.sin(e),h=Math.cos(e),e=this.a*ea(e,c,h,this.en),b=this.a*b*h/Math.sqrt(1-this.es*c*c);a.x=b;a.y=e;return a},inverse:function(a){var b,e,c;a.x-=this.x0;e=a.x/this.a;a.y-=this.y0;b=a.y/this.a;this.sphere?(b/=this.C_y,e/=this.C_x*(this.m+Math.cos(b)),this.m?b=za((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=za(Math.sin(b)/this.n)),e=w(e+this.long0),b=Ia(b)):(b=ma(a.y/this.a,this.es,this.en),c=Math.abs(b),c<z?(c=Math.sin(b),e=this.long0+a.x*Math.sqrt(1-this.es*c*c)/(this.a*Math.cos(b)),e=w(e)):c-v<z&&(e=this.long0));a.x=e;a.y=b;return a},names:["Sinusoidal","sinu"]},ab={init:function(){},forward:function(a){for(var b=a.y,e=w(a.x-this.long0),c=b,h=Math.PI*Math.sin(b),k=0;;k++){var d=-(c+Math.sin(c)-h)/(1+Math.cos(c)),c=c+d;if(Math.abs(d)<v)break}c/=2;Math.PI/2-Math.abs(b)<v&&(e=0);b=1.4142135623731*this.a*Math.sin(c)+this.y0;a.x=.900316316158*this.a*e*Math.cos(c)+this.x0;a.y=b;return a},inverse:function(a){var b;a.x-=this.x0;a.y-=this.y0;b=a.y/(1.4142135623731*this.a);.999999999999<Math.abs(b)&&(b=.999999999999);b=Math.asin(b);var e=w(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));e<-Math.PI&&(e=-Math.PI);e>Math.PI&&(e=Math.PI);b=(2*b+Math.sin(2*b))/Math.PI;1<Math.abs(b)&&(b=1);b=Math.asin(b);a.x=e;a.y=b;return a},names:["Mollweide","moll"]},bb={init:function(){Math.abs(this.lat1+this.lat2)<v||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ja(this.es),this.e1=Ka(this.es),this.e2=La(this.es),this.e3=Ma(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=W(this.e,this.sinphi,this.cosphi),this.ml1=ca(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<v?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=W(this.e,this.sinphi,this.cosphi),this.ml2=ca(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ca(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(a){var b=a.x,e=a.y;this.sphere||(e=ca(this.e0,this.e1,this.e2,this.e3,e));var e=this.a*(this.g-e),b=this.ns*w(b-this.long0),c=this.y0+this.rh-e*Math.cos(b);a.x=this.x0+e*Math.sin(b);a.y=c;return a},inverse:function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,e,c;0<=this.ns?(e=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(e=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);c=0;0!==e&&(c=Math.atan2(b*a.x,b*a.y));this.sphere?(c=w(this.long0+c/this.ns),e=Ia(this.g-e/this.a)):(e=Oa(this.g-e/this.a,this.e0,this.e1,this.e2,this.e3),c=w(this.long0+c/this.ns));a.x=c;a.y=e;return a},names:["Equidistant_Conic","eqdc"]},cb={init:function(){this.R=this.a},forward:function(a){var b=a.y,e=w(a.x-this.long0),c=za(2*Math.abs(b/Math.PI)),h=.5*Math.abs(Math.PI/e-e/Math.PI),k=h*h,d=Math.sin(c),c=Math.cos(c),c=c/(d+c-1),d=c*(2/d-1),f=d*d,l=Math.PI*this.R*(h*(c-f)+Math.sqrt(k*(c-f)*(c-f)-(f+k)*(c*c-f)))/(f+k);0>e&&(l=-l);e=this.x0+l;c=k+c;l=Math.PI*this.R*(d*c-h*Math.sqrt((f+k)*(k+1)-c*c))/(f+k);b=0<=b?this.y0+l:this.y0-l;a.x=e;a.y=b;return a},inverse:function(a){var b,e,c,h,k,d,f,l;a.x-=this.x0;a.y-=this.y0;k=Math.PI*this.R;b=a.x/k;c=a.y/k;h=b*b+c*c;k=-Math.abs(c)*(1+h);e=k-2*c*c+b*b;d=-2*k+1+2*c*c+h*h;f=(k-e*e/3/d)/d;l=2*Math.sqrt(-f/3);k=3*(c*c/d+(2*e*e*e/d/d/d-9*k*e/d/d)/27)/f/l;1<Math.abs(k)&&(k=0<=k?1:-1);k=Math.acos(k)/3;e=0<=a.y?(-l*Math.cos(k+Math.PI/3)-e/3/d)*Math.PI:-(-l*Math.cos(k+Math.PI/3)-e/3/d)*Math.PI;b=Math.abs(b)<v?this.long0:w(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(b*b-c*c)+h*h))/2/b);a.x=b;a.y=e;return a},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},db={init:function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)},forward:function(a){var b=a.y,e=Math.sin(a.y),c=Math.cos(a.y),h=w(a.x-this.long0),k,d,f,l,n;this.sphere?Math.abs(this.sin_p12-1)<=v?(a.x=this.x0+this.a*(z-b)*Math.sin(h),a.y=this.y0-this.a*(z-b)*Math.cos(h)):Math.abs(this.sin_p12+1)<=v?(a.x=this.x0+this.a*(z+b)*Math.sin(h),a.y=this.y0+this.a*(z+b)*Math.cos(h)):(b=this.sin_p12*e+this.cos_p12*c*Math.cos(h),b=Math.acos(b),b/=Math.sin(b),a.x=this.x0+this.a*b*c*Math.sin(h),a.y=this.y0+this.a*b*(this.cos_p12*e-this.sin_p12*c*Math.cos(h))):(k=Ja(this.es),d=Ka(this.es),f=La(this.es),l=Ma(this.es),Math.abs(this.sin_p12-1)<=v?(c=this.a*ca(k,d,f,l,z),b=this.a*ca(k,d,f,l,b),a.x=this.x0+(c-b)*Math.sin(h),a.y=this.y0-(c-b)*Math.cos(h)):Math.abs(this.sin_p12+1)<=v?(c=this.a*ca(k,d,f,l,z),b=this.a*ca(k,d,f,l,b),a.x=this.x0+(c+b)*Math.sin(h),a.y=this.y0+(c+b)*Math.cos(h)):(k=e/c,b=Ha(this.a,this.e,this.sin_p12),e=Ha(this.a,this.e,e),e=Math.atan((1-this.es)*k+this.es*b*this.sin_p12/(e*c)),c=Math.atan2(Math.sin(h),this.cos_p12*Math.tan(e)-this.sin_p12*Math.cos(h)),k=0===c?Math.asin(this.cos_p12*Math.sin(e)-this.sin_p12*Math.cos(e)):Math.abs(Math.abs(c)-Math.PI)<=v?-Math.asin(this.cos_p12*Math.sin(e)-this.sin_p12*Math.cos(e)):Math.asin(Math.sin(h)*Math.cos(e)/Math.sin(c)),h=this.e*this.sin_p12/Math.sqrt(1-this.es),d=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es),e=h*d,d*=d,f=k*k,l=f*k,n=l*k,b=b*k*(1-f*d*(1-d)/6+l/8*e*(1-2*d)+n/120*(d*(4-7*d)-3*h*h*(1-7*d))-n*k/48*e),a.x=this.x0+b*Math.sin(c),a.y=this.y0+b*Math.cos(c)));return a},inverse:function(a){a.x-=this.x0;a.y-=this.y0;var b,e,c,h,k,d;if(this.sphere){b=Math.sqrt(a.x*a.x+a.y*a.y);if(b>2*z*this.a)return;e=b/this.a;c=Math.sin(e);h=Math.cos(e);e=this.long0;Math.abs(b)<=v?k=this.lat0:(k=za(h*this.sin_p12+a.y*c*this.cos_p12/b),e=Math.abs(this.lat0)-z,e=Math.abs(e)<=v?0<=this.lat0?w(this.long0+Math.atan2(a.x,-a.y)):w(this.long0-Math.atan2(-a.x,a.y)):w(this.long0+Math.atan2(a.x*c,b*this.cos_p12*h-a.y*this.sin_p12*c)))}else c=Ja(this.es),e=Ka(this.es),h=La(this.es),k=Ma(this.es),Math.abs(this.sin_p12-1)<=v?(d=this.a*ca(c,e,h,k,z),b=Math.sqrt(a.x*a.x+a.y*a.y),k=Oa((d-b)/this.a,c,e,h,k),e=w(this.long0+Math.atan2(a.x,-1*a.y))):Math.abs(this.sin_p12+1)<=v?(d=this.a*ca(c,e,h,k,z),b=Math.sqrt(a.x*a.x+a.y*a.y),k=Oa((b-d)/this.a,c,e,h,k),e=w(this.long0+Math.atan2(a.x,a.y))):(b=Math.sqrt(a.x*a.x+a.y*a.y),c=Math.atan2(a.x,a.y),k=Ha(this.a,this.e,this.sin_p12),e=Math.cos(c),h=this.e*this.cos_p12*e,h=-h*h/(1-this.es),d=3*this.es*(1-h)*this.sin_p12*this.cos_p12*e/(1-this.es),k=b/k,b=k-h*(1+h)*Math.pow(k,3)/6-d*(1+3*h)*Math.pow(k,4)/24,h=1-h*b*b/2-k*b*b*b/6,k=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*Math.sin(b)*e),e=w(this.long0+Math.asin(Math.sin(c)*Math.sin(b)/Math.cos(k))),k=Math.atan((1-this.es*h*this.sin_p12/Math.sin(k))*Math.tan(k)/(1-this.es)));a.x=e;a.y=k;return a},names:["Azimuthal_Equidistant","aeqd"]},eb={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)},forward:function(a){var b,e,c,h,k,d,f;e=a.y;c=w(a.x-this.long0);b=Math.sin(e);e=Math.cos(e);h=Math.cos(c);k=this.sin_p14*b+this.cos_p14*e*h;if(0<k||Math.abs(k)<=v)d=1*this.a*e*Math.sin(c),f=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*e*h);a.x=d;a.y=f;return a},inverse:function(a){var b,e,c,h,k;a.x-=this.x0;a.y-=this.y0;b=Math.sqrt(a.x*a.x+a.y*a.y);e=za(b/this.a);c=Math.sin(e);e=Math.cos(e);h=this.long0;if(Math.abs(b)<=v)return k=this.lat0,a.x=h,a.y=k,a;k=za(e*this.sin_p14+a.y*c*this.cos_p14/b);if(Math.abs(Math.abs(this.lat0)-z)<=v)return h=0<=this.lat0?w(this.long0+Math.atan2(a.x,-a.y)):w(this.long0-Math.atan2(-a.x,a.y)),a.x=h,a.y=k,a;h=w(this.long0+Math.atan2(a.x*c,b*this.cos_p14*e-a.y*this.sin_p14*c));a.x=h;a.y=k;return a},names:["ortho"]};D.defaultDatum="WGS84";D.Proj=r;D.WGS84=new D.Proj("WGS84");D.Point=G;D.toPoint=ra;D.defs=a;D.transform=x;D.mgrs=Ea;D.version="2.4.3";(function(a){a.Proj.projections.add(X);a.Proj.projections.add(K);a.Proj.projections.add(oa);a.Proj.projections.add(ka);a.Proj.projections.add(xa);a.Proj.projections.add(ga);a.Proj.projections.add(pa);a.Proj.projections.add(Qa);a.Proj.projections.add(Ra);a.Proj.projections.add(Sa);a.Proj.projections.add(Ta);a.Proj.projections.add(Ua);a.Proj.projections.add(Va);a.Proj.projections.add(Wa);a.Proj.projections.add(Na);a.Proj.projections.add(Xa);a.Proj.projections.add(Ya);a.Proj.projections.add(Za);a.Proj.projections.add($a);a.Proj.projections.add(ab);a.Proj.projections.add(bb);a.Proj.projections.add(cb);a.Proj.projections.add(db);a.Proj.projections.add(eb)})(D);return D});(function(f,g,d){function c(){var a=f.L;b.noConflict=function(){f.L=a;return this};f.L=b}var b={version:"1.0.3+ed36a04"};"object"===typeof module&&"object"===typeof module.exports?module.exports=b:"function"===typeof define&&define.amd&&define(b);"undefined"!==typeof f&&c();b.Util={extend:function(a){var b,c,k,d;c=1;for(k=arguments.length;c<k;c++)for(b in d=arguments[c],d)a[b]=d[b];return a},create:Object.create||function(){function a(){}return function(b){a.prototype=b;return new a}}(),bind:function(a,b){var e=Array.prototype.slice;if(a.bind)return a.bind.apply(a,e.call(arguments,1));var c=e.call(arguments,2);return function(){return a.apply(b,c.length?c.concat(e.call(arguments)):arguments)}},stamp:function(a){a._leaflet_id=a._leaflet_id||++b.Util.lastId;return a._leaflet_id},lastId:0,throttle:function(a,b,c){var e,h,d,f;f=function(){e=!1;h&&(d.apply(c,h),h=!1)};return d=function(){e?h=arguments:(a.apply(c,arguments),setTimeout(f,b),e=!0)}},wrapNum:function(a,b,c){var e=b[1];b=b[0];var h=e-b;return a===e&&c?a:((a-b)%h+h)%h+b},falseFn:function(){return!1},formatNum:function(a,b){var e=Math.pow(10,b||5);return Math.round(a*e)/e},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return b.Util.trim(a).split(/\s+/)},setOptions:function(a,e){a.hasOwnProperty("options")||(a.options=a.options?b.Util.create(a.options):{});for(var c in e)a.options[c]=e[c];return a.options},getParamString:function(a,b,c){var e=[],h;for(h in a)e.push(encodeURIComponent(c?h.toUpperCase():h)+"\x3d"+encodeURIComponent(a[h]));return(b&&-1!==b.indexOf("?")?"\x26":"?")+e.join("\x26")},template:function(a,e){return a.replace(b.Util.templateRe,function(a,b){var c=e[b];if(c===d)throw Error("No value provided for variable "+a);"function"===typeof c&&(c=c(e));return c})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,b){for(var e=0;e<a.length;e++)if(a[e]===b)return e;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"};(function(){function a(a){return f["webkit"+a]||f["moz"+a]||f["ms"+a]}function e(a){var b=+new Date,e=Math.max(0,16-(b-c));c=b+e;return f.setTimeout(a,e)}var c=0,k=f.requestAnimationFrame||a("RequestAnimationFrame")||e,d=f.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){f.clearTimeout(a)};b.Util.requestAnimFrame=function(a,c,h){if(h&&k===e)a.call(c);else return k.call(f,b.bind(a,c))};b.Util.cancelAnimFrame=function(a){a&&d.call(f,a)}})();b.extend=b.Util.extend;b.bind=b.Util.bind;b.stamp=b.Util.stamp;b.setOptions=b.Util.setOptions;b.Class=function(){};b.Class.extend=function(a){var e=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},c=e.__super__=this.prototype,k=b.Util.create(c);k.constructor=e;e.prototype=k;for(var d in this)this.hasOwnProperty(d)&&"prototype"!==d&&(e[d]=this[d]);a.statics&&(b.extend(e,a.statics),delete a.statics);a.includes&&(b.Util.extend.apply(null,[k].concat(a.includes)),delete a.includes);k.options&&(a.options=b.Util.extend(b.Util.create(k.options),a.options));b.extend(k,a);k._initHooks=[];k.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,b=k._initHooks.length;a<b;a++)k._initHooks[a].call(this)}};return e};b.Class.include=function(a){b.extend(this.prototype,a);return this};b.Class.mergeOptions=function(a){b.extend(this.prototype.options,a);return this};b.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"===typeof a?a:function(){this[a].apply(this,b)});return this};b.Evented=b.Class.extend({on:function(a,e,c){if("object"===typeof a)for(var h in a)this._on(h,a[h],e);else{a=b.Util.splitWords(a);h=0;for(var d=a.length;h<d;h++)this._on(a[h],e,c)}return this},off:function(a,e,c){if(a)if("object"===typeof a)for(var h in a)this._off(h,a[h],e);else{a=b.Util.splitWords(a);h=0;for(var d=a.length;h<d;h++)this._off(a[h],e,c)}else delete this._events;return this},_on:function(a,b,c){this._events=this._events||{};var e=this._events[a];e||(e=[],this._events[a]=e);c===this&&(c=d);a={fn:b,ctx:c};for(var h=0,f=e.length;h<f;h++)if(e[h].fn===b&&e[h].ctx===c)return;e.push(a)},_off:function(a,e,c){var h,f,l;if(this._events&&(h=this._events[a]))if(e){if(c===this&&(c=d),h)for(f=0,l=h.length;f<l;f++){var g=h[f];if(g.ctx===c&&g.fn===e){g.fn=b.Util.falseFn;this._firingCount&&(this._events[a]=h=h.slice());h.splice(f,1);break}}}else{f=0;for(l=h.length;f<l;f++)h[f].fn=b.Util.falseFn;delete this._events[a]}},fire:function(a,e,c){if(!this.listens(a,c))return this;e=b.Util.extend({},e,{type:a,target:this});if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var h=0,d=a.length;h<d;h++){var f=a[h];f.fn.call(f.ctx||this,e)}this._firingCount--}c&&this._propagateEvent(e);return this},listens:function(a,b){var e=this._events&&this._events[a];if(e&&e.length)return!0;if(b)for(var c in this._eventParents)if(this._eventParents[c].listens(a,b))return!0;return!1},once:function(a,e,c){if("object"===typeof a){for(var h in a)this.once(h,a[h],e);return this}var d=b.bind(function(){this.off(a,e,c).off(a,d,c)},this);return this.on(a,e,c).on(a,d,c)},addEventParent:function(a){this._eventParents=this._eventParents||{};this._eventParents[b.stamp(a)]=a;return this},removeEventParent:function(a){this._eventParents&&delete this._eventParents[b.stamp(a)];return this},_propagateEvent:function(a){for(var e in this._eventParents)this._eventParents[e].fire(a.type,b.extend({layer:a.target},a),!0)}});var l=b.Evented.prototype;l.addEventListener=l.on;l.removeEventListener=l.clearAllEventListeners=l.off;l.addOneTimeEventListener=l.once;l.fireEvent=l.fire;l.hasEventListeners=l.listens;b.Mixin={Events:l};(function(){var a=navigator.userAgent.toLowerCase(),e=g.documentElement,c="ActiveXObject"in f,k=-1!==a.indexOf("webkit"),d=-1!==a.indexOf("phantom"),l=-1!==a.search("android [23]"),t=-1!==a.indexOf("chrome"),p=-1!==a.indexOf("gecko")&&!k&&!f.opera&&!c,r=0===navigator.platform.indexOf("Win"),q="undefined"!==typeof orientation||-1!==a.indexOf("mobile"),x=!f.PointerEvent&&f.MSPointerEvent,A=f.PointerEvent||x,F=c&&"transition"in e.style,D="WebKitCSSMatrix"in f&&"m11"in new f.WebKitCSSMatrix&&!l,E="MozPerspective"in e.style,e="OTransition"in e.style,H=!f.L_NO_TOUCH&&(A||"ontouchstart"in f||f.DocumentTouch&&g instanceof f.DocumentTouch);b.Browser={ie:c,ielt9:c&&!g.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in g),webkit:k,gecko:p,android:-1!==a.indexOf("android"),android23:l,chrome:t,safari:!t&&-1!==a.indexOf("safari"),win:r,ie3d:F,webkit3d:D,gecko3d:E,opera12:e,any3d:!f.L_DISABLE_3D&&(F||D||E)&&!e&&!d,mobile:q,mobileWebkit:q&&k,mobileWebkit3d:q&&D,mobileOpera:q&&f.opera,mobileGecko:q&&p,touch:!!H,msPointer:!!x,pointer:!!A,retina:1<(f.devicePixelRatio||f.screen.deviceXDPI/f.screen.logicalXDPI)}})();b.Point=function(a,b,c){this.x=c?Math.round(a):a;this.y=c?Math.round(b):b};b.Point.prototype={clone:function(){return new b.Point(this.x,this.y)},add:function(a){return this.clone()._add(b.point(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(b.point(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=a;this.y*=a;return this},scaleBy:function(a){return new b.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new b.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},distanceTo:function(a){a=b.point(a);var e=a.x-this.x;a=a.y-this.y;return Math.sqrt(e*e+a*a)},equals:function(a){a=b.point(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=b.point(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+b.Util.formatNum(this.x)+", "+b.Util.formatNum(this.y)+")"}};b.point=function(a,e,c){return a instanceof b.Point?a:b.Util.isArray(a)?new b.Point(a[0],a[1]):a===d||null===a?a:"object"===typeof a&&"x"in a&&"y"in a?new b.Point(a.x,a.y):new b.Point(a,e,c)};b.Bounds=function(a,b){if(a)for(var e=b?[a,b]:a,c=0,d=e.length;c<d;c++)this.extend(e[c])};b.Bounds.prototype={extend:function(a){a=b.point(a);this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone());return this},getCenter:function(a){return new b.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new b.Point(this.min.x,this.max.y)},getTopRight:function(){return new b.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var e;a="number"===typeof a[0]||a instanceof b.Point?b.point(a):b.bounds(a);a instanceof b.Bounds?(e=a.min,a=a.max):e=a;return e.x>=this.min.x&&a.x<=this.max.x&&e.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){a=b.bounds(a);var e=this.min,c=this.max,k=a.min;a=a.max;var d=a.y>=e.y&&k.y<=c.y;return a.x>=e.x&&k.x<=c.x&&d},overlaps:function(a){a=b.bounds(a);var e=this.min,c=this.max,k=a.min;a=a.max;var d=a.y>e.y&&k.y<c.y;return a.x>e.x&&k.x<c.x&&d},isValid:function(){return!(!this.min||!this.max)}};b.bounds=function(a,e){return!a||a instanceof b.Bounds?a:new b.Bounds(a,e)};b.Transformation=function(a,b,c,k){this._a=a;this._b=b;this._c=c;this._d=k};b.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){b=b||1;a.x=b*(this._a*a.x+this._b);a.y=b*(this._c*a.y+this._d);return a},untransform:function(a,e){e=e||1;return new b.Point((a.x/e-this._b)/this._a,(a.y/e-this._d)/this._c)}};b.DomUtil={get:function(a){return"string"===typeof a?g.getElementById(a):a},getStyle:function(a,b){var e=a.style[b]||a.currentStyle&&a.currentStyle[b];e&&"auto"!==e||!g.defaultView||(e=(e=g.defaultView.getComputedStyle(a,null))?e[b]:null);return"auto"===e?null:e},create:function(a,b,c){a=g.createElement(a);a.className=b||"";c&&c.appendChild(a);return a},remove:function(a){var b=a.parentNode;b&&b.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var b=a.parentNode;b.insertBefore(a,b.firstChild)},hasClass:function(a,e){if(a.classList!==d)return a.classList.contains(e);var c=b.DomUtil.getClass(a);return 0<c.length&&(new RegExp("(^|\\s)"+e+"(\\s|$)")).test(c)},addClass:function(a,e){if(a.classList!==d)for(var c=b.Util.splitWords(e),k=0,f=c.length;k<f;k++)a.classList.add(c[k]);else b.DomUtil.hasClass(a,e)||(c=b.DomUtil.getClass(a),b.DomUtil.setClass(a,(c?c+" ":"")+e))},removeClass:function(a,e){a.classList!==d?a.classList.remove(e):b.DomUtil.setClass(a,b.Util.trim((" "+b.DomUtil.getClass(a)+" ").replace(" "+e+" "," ")))},setClass:function(a,b){a.className.baseVal===d?a.className=b:a.className.baseVal=b},getClass:function(a){return a.className.baseVal===d?a.className:a.className.baseVal},setOpacity:function(a,e){"opacity"in a.style?a.style.opacity=e:"filter"in a.style&&b.DomUtil._setOpacityIE(a,e)},_setOpacityIE:function(a,b){var e=!1;try{e=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(k){if(1===b)return}b=Math.round(100*b);e?(e.Enabled=100!==b,e.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+b+")"},testProp:function(a){for(var b=g.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1},setTransform:function(a,e,c){e=e||new b.Point(0,0);a.style[b.DomUtil.TRANSFORM]=(b.Browser.ie3d?"translate("+e.x+"px,"+e.y+"px)":"translate3d("+e.x+"px,"+e.y+"px,0)")+(c?" scale("+c+")":"")},setPosition:function(a,e){a._leaflet_pos=e;b.Browser.any3d?b.DomUtil.setTransform(a,e):(a.style.left=e.x+"px",a.style.top=e.y+"px")},getPosition:function(a){return a._leaflet_pos||new b.Point(0,0)}};(function(){b.DomUtil.TRANSFORM=b.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var a=b.DomUtil.TRANSITION=b.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);b.DomUtil.TRANSITION_END="webkitTransition"===a||"OTransition"===a?a+"End":"transitionend";if("onselectstart"in g)b.DomUtil.disableTextSelection=function(){b.DomEvent.on(f,"selectstart",b.DomEvent.preventDefault)},b.DomUtil.enableTextSelection=function(){b.DomEvent.off(f,"selectstart",b.DomEvent.preventDefault)};else{var e=b.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);b.DomUtil.disableTextSelection=function(){if(e){var a=g.documentElement.style;this._userSelect=a[e];a[e]="none"}};b.DomUtil.enableTextSelection=function(){e&&(g.documentElement.style[e]=this._userSelect,delete this._userSelect)}}b.DomUtil.disableImageDrag=function(){b.DomEvent.on(f,"dragstart",b.DomEvent.preventDefault)};b.DomUtil.enableImageDrag=function(){b.DomEvent.off(f,"dragstart",b.DomEvent.preventDefault)};b.DomUtil.preventOutline=function(a){for(;-1===a.tabIndex;)a=a.parentNode;a&&a.style&&(b.DomUtil.restoreOutline(),this._outlineElement=a,this._outlineStyle=a.style.outline,a.style.outline="none",b.DomEvent.on(f,"keydown",b.DomUtil.restoreOutline,this))};b.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,b.DomEvent.off(f,"keydown",b.DomUtil.restoreOutline,this))}})();b.LatLng=function(a,b,c){if(isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=+a;this.lng=+b;c!==d&&(this.alt=+c)};b.LatLng.prototype={equals:function(a,e){if(!a)return!1;a=b.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(e===d?1E-9:e)},toString:function(a){return"LatLng("+b.Util.formatNum(this.lat,a)+", "+b.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return b.CRS.Earth.distance(this,b.latLng(a))},wrap:function(){return b.CRS.Earth.wrapLatLng(this)},toBounds:function(a){a=180*a/40075017;var e=a/Math.cos(Math.PI/180*this.lat);return b.latLngBounds([this.lat-a,this.lng-e],[this.lat+a,this.lng+e])},clone:function(){return new b.LatLng(this.lat,this.lng,this.alt)}};b.latLng=function(a,e,c){return a instanceof b.LatLng?a:b.Util.isArray(a)&&"object"!==typeof a[0]?3===a.length?new b.LatLng(a[0],a[1],a[2]):2===a.length?new b.LatLng(a[0],a[1]):null:a===d||null===a?a:"object"===typeof a&&"lat"in a?new b.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):e===d?null:new b.LatLng(a,e,c)};b.LatLngBounds=function(a,b){if(a)for(var e=b?[a,b]:a,c=0,d=e.length;c<d;c++)this.extend(e[c])};b.LatLngBounds.prototype={extend:function(a){var e=this._southWest,c=this._northEast,k;if(a instanceof b.LatLng)k=a;else if(a instanceof b.LatLngBounds){if(k=a._southWest,a=a._northEast,!k||!a)return this}else return a?this.extend(b.latLng(a)||b.latLngBounds(a)):this;e||c?(e.lat=Math.min(k.lat,e.lat),e.lng=Math.min(k.lng,e.lng),c.lat=Math.max(a.lat,c.lat),c.lng=Math.max(a.lng,c.lng)):(this._southWest=new b.LatLng(k.lat,k.lng),this._northEast=new b.LatLng(a.lat,a.lng));return this},pad:function(a){var e=this._southWest,c=this._northEast,k=Math.abs(e.lat-c.lat)*a;a*=Math.abs(e.lng-c.lng);return new b.LatLngBounds(new b.LatLng(e.lat-k,e.lng-a),new b.LatLng(c.lat+k,c.lng+a))},getCenter:function(){return new b.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new b.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new b.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"===typeof a[0]||a instanceof b.LatLng||"lat"in a?b.latLng(a):b.latLngBounds(a);var e=this._southWest,c=this._northEast,k;a instanceof b.LatLngBounds?(k=a.getSouthWest(),a=a.getNorthEast()):k=a;return k.lat>=e.lat&&a.lat<=c.lat&&k.lng>=e.lng&&a.lng<=c.lng},intersects:function(a){a=b.latLngBounds(a);var e=this._southWest,c=this._northEast,k=a.getSouthWest();a=a.getNorthEast();var d=a.lng>=e.lng&&k.lng<=c.lng;return a.lat>=e.lat&&k.lat<=c.lat&&d},overlaps:function(a){a=b.latLngBounds(a);var e=this._southWest,c=this._northEast,k=a.getSouthWest();a=a.getNorthEast();var d=a.lng>e.lng&&k.lng<c.lng;return a.lat>e.lat&&k.lat<c.lat&&d},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){if(!a)return!1;a=b.latLngBounds(a);return this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}};b.latLngBounds=function(a,e){return a instanceof b.LatLngBounds?a:new b.LatLngBounds(a,e)};b.Projection={};b.Projection.LonLat={project:function(a){return new b.Point(a.lng,a.lat)},unproject:function(a){return new b.LatLng(a.y,a.x)},bounds:b.bounds([-180,-90],[180,90])};b.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var e=Math.PI/180,c=this.MAX_LATITUDE,c=Math.sin(Math.max(Math.min(c,a.lat),-c)*e);return new b.Point(this.R*a.lng*e,this.R*Math.log((1+c)/(1-c))/2)},unproject:function(a){var e=180/Math.PI;return new b.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*e,a.x*e/this.R)},bounds:function(){var a=6378137*Math.PI;return b.bounds([-a,-a],[a,a])}()};b.CRS={latLngToPoint:function(a,b){var e=this.projection.project(a),c=this.scale(b);return this.transformation._transform(e,c)},pointToLatLng:function(a,b){var e=this.scale(b),e=this.transformation.untransform(a,e);return this.projection.unproject(e)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var e=this.projection.bounds,c=this.scale(a);a=this.transformation.transform(e.min,c);e=this.transformation.transform(e.max,c);return b.bounds(a,e)},infinite:!1,wrapLatLng:function(a){var e=this.wrapLng?b.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,c=this.wrapLat?b.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat;return b.latLng(c,e,a.alt)},wrapLatLngBounds:function(a){var e=a.getCenter(),c=this.wrapLatLng(e),k=e.lat-c.lat,e=e.lng-c.lng;if(0===k&&0===e)return a;c=a.getSouthWest();a=a.getNorthEast();c=b.latLng({lat:c.lat-k,lng:c.lng-e});k=b.latLng({lat:a.lat-k,lng:a.lng-e});return new b.LatLngBounds(c,k)}};b.CRS.Simple=b.extend({},b.CRS,{projection:b.Projection.LonLat,transformation:new b.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var e=b.lng-a.lng,c=b.lat-a.lat;return Math.sqrt(e*e+c*c)},infinite:!0});b.CRS.Earth=b.extend({},b.CRS,{wrapLng:[-180,180],R:6371E3,distance:function(a,b){var e=Math.PI/180,c=a.lat*e,d=b.lat*e;return this.R*Math.acos(Math.min(Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((b.lng-a.lng)*e),1))}});b.CRS.EPSG3857=b.extend({},b.CRS.Earth,{code:"EPSG:3857",projection:b.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*b.Projection.SphericalMercator.R);return new b.Transformation(a,.5,-a,.5)}()});b.CRS.EPSG900913=b.extend({},b.CRS.EPSG3857,{code:"EPSG:900913"});b.CRS.EPSG4326=b.extend({},b.CRS.Earth,{code:"EPSG:4326",projection:b.Projection.LonLat,transformation:new b.Transformation(1/180,1,-1/180,.5)});b.Map=b.Evented.extend({options:{crs:b.CRS.EPSG3857,center:d,zoom:d,minZoom:d,maxZoom:d,layers:[],maxBounds:d,renderer:d,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,e){e=b.setOptions(this,e);this._initContainer(a);this._initLayout();this._onResize=b.bind(this._onResize,this);this._initEvents();e.maxBounds&&this.setMaxBounds(e.maxBounds);e.zoom!==d&&(this._zoom=this._limitZoom(e.zoom));e.center&&e.zoom!==d&&this.setView(b.latLng(e.center),e.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();if(this._zoomAnimated=b.DomUtil.TRANSITION&&b.Browser.any3d&&!b.Browser.mobileOpera&&this.options.zoomAnimation)this._createAnimProxy(),b.DomEvent.on(this._proxy,b.DomUtil.TRANSITION_END,this._catchTransitionEnd,this);this._addLayers(this.options.layers)},setView:function(a,e,c){e=e===d?this._zoom:this._limitZoom(e);a=this._limitCenter(b.latLng(a),e,this.options.maxBounds);c=c||{};this._stop();if(this._loaded&&!c.reset&&!0!==c&&(c.animate!==d&&(c.zoom=b.extend({animate:c.animate},c.zoom),c.pan=b.extend({animate:c.animate,duration:c.duration},c.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,e,c.zoom):this._tryAnimatedPan(a,c.pan)))return clearTimeout(this._sizeTimer),this;this._resetView(a,e);return this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)},zoomIn:function(a,e){a=a||(b.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom+a,e)},zoomOut:function(a,e){a=a||(b.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom-a,e)},setZoomAround:function(a,e,c){var h=this.getZoomScale(e),d=this.getSize().divideBy(2);a=(a instanceof b.Point?a:this.latLngToContainerPoint(a)).subtract(d).multiplyBy(1-1/h);d=this.containerPointToLatLng(d.add(a));return this.setView(d,e,{zoom:c})},_getBoundsCenterZoom:function(a,e){e=e||{};a=a.getBounds?a.getBounds():b.latLngBounds(a);var c=b.point(e.paddingTopLeft||e.padding||[0,0]),k=b.point(e.paddingBottomRight||e.padding||[0,0]),d=this.getBoundsZoom(a,!1,c.add(k)),d="number"===typeof e.maxZoom?Math.min(e.maxZoom,d):d,c=k.subtract(c).divideBy(2),k=this.project(a.getSouthWest(),d),f=this.project(a.getNorthEast(),d);return{center:this.unproject(k.add(f).divideBy(2).add(c),d),zoom:d}},fitBounds:function(a,e){a=b.latLngBounds(a);if(!a.isValid())throw Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(a,e);return this.setView(c.center,c.zoom,e)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a,e){a=b.point(a).round();e=e||{};if(!a.x&&!a.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;this._panAnim||(this._panAnim=new b.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this));e.noMoveStart||this.fire("movestart");if(!1!==e.animate){b.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,c,e.duration||.25,e.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,e,c){function h(a){a=(D*D-F*F+2.0164*(a?-1:1)*2.0164*E*E)/(4.0328*(a?D:F)*E);a=Math.sqrt(a*a+1)-a;return 1E-9>a?-18:Math.log(a)}function f(a){return(Math.exp(a)+Math.exp(-a))/2}function l(a){return F*(f(H)/f(H+1.42*a))}function g(a){var b=f(H);a=H+1.42*a;a=(Math.exp(a)-Math.exp(-a))/2/f(a);return F*(b*a-(Math.exp(H)-Math.exp(-H))/2)/2.0164}function p(){var c=(Date.now()-U)/I,h=(1-Math.pow(1-c,1.5))*u;1>=c?(this._flyToFrame=b.Util.requestAnimFrame(p,this),this._move(this.unproject(r.add(q.subtract(r).multiplyBy(g(h)/E)),A),this.getScaleZoom(F/l(h),A),{flyTo:!0})):this._move(a,e)._moveEnd(!0)}c=c||{};if(!1===c.animate||!b.Browser.any3d)return this.setView(a,e,c);this._stop();var r=this.project(this.getCenter()),q=this.project(a),x=this.getSize(),A=this._zoom;a=b.latLng(a);e=e===d?A:e;var F=Math.max(x.x,x.y),D=F*this.getZoomScale(A,e),E=q.distanceTo(r)||1,H=h(0),U=Date.now(),u=(h(1)-H)/1.42,I=c.duration?1E3*c.duration:800*u;this._moveStart(!0);p.call(this);return this},flyToBounds:function(a,b){var e=this._getBoundsCenterZoom(a,b);return this.flyTo(e.center,e.zoom,b)},setMaxBounds:function(a){a=b.latLngBounds(a);if(a.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);this.options.maxBounds=a;this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(a){this.options.minZoom=a;return this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){this.options.maxZoom=a;return this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,e){this._enforcingBounds=!0;var c=this.getCenter(),k=this._limitCenter(c,this._zoom,b.latLngBounds(a));c.equals(k)||this.panTo(k,e);this._enforcingBounds=!1;return this},invalidateSize:function(a){if(!this._loaded)return this;a=b.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var e=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var c=this.getSize(),k=e.divideBy(2).round(),d=c.divideBy(2).round(),k=k.subtract(d);if(!k.x&&!k.y)return this;a.animate&&a.pan?this.panBy(k):(a.pan&&this._rawPanBy(k),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(b.bind(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:e,newSize:c})},stop:function(){this.setZoom(this._limitZoom(this._zoom));this.options.zoomSnap||this.fire("viewreset");return this._stop()},locate:function(a){a=this._locateOptions=b.extend({timeout:1E4,watch:!1},a);if(!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=b.bind(this._handleGeolocationResponse,this),c=b.bind(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,c,a):navigator.geolocation.getCurrentPosition(e,c,a);return this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId);this._locateOptions&&(this._locateOptions.setView=!1);return this},_handleGeolocationError:function(a){var b=a.code;a=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var e=new b.LatLng(a.coords.latitude,a.coords.longitude),c=e.toBounds(a.coords.accuracy),k=this._locateOptions;if(k.setView){var d=this.getBoundsZoom(c);this.setView(e,k.maxZoom?Math.min(d,k.maxZoom):d)}var e={latlng:e,bounds:c,timestamp:a.timestamp},f;for(f in a.coords)"number"===typeof a.coords[f]&&(e[f]=a.coords[f]);this.fire("locationfound",e)},addHandler:function(a,b){if(!b)return this;var e=this[a]=new b(this);this._handlers.push(e);this.options[a]&&e.enable();return this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._containerId=this._container._leaflet_id=d}b.DomUtil.remove(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,e){var c="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),c=b.DomUtil.create("div",c,e||this._mapPane);a&&(this._panes[a]=c);return c},getCenter:function(){this._checkIfLoaded();return this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),e=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new b.LatLngBounds(e,a)},getMinZoom:function(){return this.options.minZoom===d?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===d?this._layersMaxZoom===d?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,e,c){a=b.latLngBounds(a);c=b.point(c||[0,0]);var h=this.getZoom()||0,d=this.getMinZoom(),f=this.getMaxZoom(),l=a.getNorthWest();a=a.getSouthEast();c=this.getSize().subtract(c);l=b.bounds(this.project(a,h),this.project(l,h)).getSize();a=b.Browser.any3d?this.options.zoomSnap:1;h=this.getScaleZoom(Math.min(c.x/l.x,c.y/l.y),h);a&&(h=a/100*Math.round(h/(a/100)),h=e?Math.ceil(h/a)*a:Math.floor(h/a)*a);return Math.max(d,Math.min(f,h))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new b.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(a,e){var c=this._getTopLeftPoint(a,e);return new b.Bounds(c,c.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===d?this.getZoom():a)},getPane:function(a){return"string"===typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var e=this.options.crs;b=b===d?this._zoom:b;return e.scale(a)/e.scale(b)},getScaleZoom:function(a,b){var e=this.options.crs;b=b===d?this._zoom:b;e=e.zoom(a*e.scale(b));return isNaN(e)?Infinity:e},project:function(a,e){e=e===d?this._zoom:e;return this.options.crs.latLngToPoint(b.latLng(a),e)},unproject:function(a,e){e=e===d?this._zoom:e;return this.options.crs.pointToLatLng(b.point(a),e)},layerPointToLatLng:function(a){a=b.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(b.latLng(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(b.latLng(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(b.latLngBounds(a))},distance:function(a,e){return this.options.crs.distance(b.latLng(a),b.latLng(e))},containerPointToLayerPoint:function(a){return b.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return b.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(b.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(b.latLng(a)))},mouseEventToContainerPoint:function(a){return b.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=b.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet_id)throw Error("Map container is already initialized.");b.DomEvent.addListener(a,"scroll",this._onScroll,this);this._containerId=b.Util.stamp(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&b.Browser.any3d;b.DomUtil.addClass(a,"leaflet-container"+(b.Browser.touch?" leaflet-touch":"")+(b.Browser.retina?" leaflet-retina":"")+(b.Browser.ielt9?" leaflet-oldie":"")+(b.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=b.DomUtil.getStyle(a,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);b.DomUtil.setPosition(this._mapPane,new b.Point(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(b.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),b.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,e){b.DomUtil.setPosition(this._mapPane,new b.Point(0,0));var c=!this._loaded;this._loaded=!0;e=this._limitZoom(e);this.fire("viewprereset");var k=this._zoom!==e;this._moveStart(k)._move(a,e)._moveEnd(k);this.fire("viewreset");c&&this.fire("load")},_moveStart:function(a){a&&this.fire("zoomstart");return this.fire("movestart")},_move:function(a,b,c){b===d&&(b=this._zoom);var e=this._zoom!==b;this._zoom=b;this._lastCenter=a;this._pixelOrigin=this._getNewPixelOrigin(a);(e||c&&c.pinch)&&this.fire("zoom",c);return this.fire("move",c)},_moveEnd:function(a){a&&this.fire("zoomend");return this.fire("moveend")},_stop:function(){b.Util.cancelAnimFrame(this._flyToFrame);this._panAnim&&this._panAnim.stop();return this},_rawPanBy:function(a){b.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){if(b.DomEvent){this._targets={};this._targets[b.stamp(this._container)]=this;a=a?"off":"on";b.DomEvent[a](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);if(this.options.trackResize)b.DomEvent[a](f,"resize",this._onResize,this);if(b.Browser.any3d&&this.options.transform3DLimit)this[a]("moveend",this._onMoveEnd)}},_onResize:function(){b.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=b.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,e){for(var c=[],k,d="mouseout"===e||"mouseover"===e,f=a.target||a.srcElement,l=!1;f;){if((k=this._targets[b.stamp(f)])&&("click"===e||"preclick"===e)&&!a._simulated&&this._draggableMoved(k)){l=!0;break}if(k&&k.listens(e,!0)){if(d&&!b.DomEvent._isExternalTarget(f,a))break;c.push(k);if(d)break}if(f===this._container)break;f=f.parentNode}c.length||l||d||!b.DomEvent._isExternalTarget(f,a)||(c=[this]);return c},_handleDOMEvent:function(a){if(this._loaded&&!b.DomEvent._skipped(a)){var c="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===c&&b.DomUtil.preventOutline(a.target||a.srcElement);this._fireDOMEvent(a,c)}},_fireDOMEvent:function(a,c,h){if("click"===a.type){var e=b.Util.extend({},a);e.type="preclick";this._fireDOMEvent(e,e.type,h)}if(!a._stopped&&(h=(h||[]).concat(this._findEventTargets(a,c)),h.length)){var d=h[0];"contextmenu"===c&&d.listens(c,!0)&&b.DomEvent.preventDefault(a);e={originalEvent:a};if("keypress"!==a.type){var f=d instanceof b.Marker;e.containerPoint=f?this.latLngToContainerPoint(d.getLatLng()):this.mouseEventToContainerPoint(a);e.layerPoint=this.containerPointToLayerPoint(e.containerPoint);e.latlng=f?d.getLatLng():this.layerPointToLatLng(e.layerPoint)}for(a=0;a<h.length&&!(h[a].fire(c,e,!0),e.originalEvent._stopped||h[a].options.nonBubblingEvents&&-1!==b.Util.indexOf(h[a].options.nonBubblingEvents,c));a++);}},_draggableMoved:function(a){a=a.dragging&&a.dragging.enabled()?a:this;return a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){if(this._loaded)a.call(b||this,{target:this});else this.on("load",a,b);return this},_getMapPanePos:function(){return b.DomUtil.getPosition(this._mapPane)||new b.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,b){return(a&&b!==d?this._getNewPixelOrigin(a,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){c=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(c)},_latLngBoundsToNewLayerBounds:function(a,c,h){h=this._getNewPixelOrigin(h,c);return b.bounds([this.project(a.getSouthWest(),c)._subtract(h),this.project(a.getNorthWest(),c)._subtract(h),this.project(a.getSouthEast(),c)._subtract(h),this.project(a.getNorthEast(),c)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,c,h){if(!h)return a;var e=this.project(a,c),d=this.getSize().divideBy(2),d=new b.Bounds(e.subtract(d),e.add(d));h=this._getBoundsOffset(d,h,c);return h.round().equals([0,0])?a:this.unproject(e.add(h),c)},_limitOffset:function(a,c){if(!c)return a;var e=this.getPixelBounds(),e=new b.Bounds(e.min.add(a),e.max.add(a));return a.add(this._getBoundsOffset(e,c))},_getBoundsOffset:function(a,c,h){h=b.bounds(this.project(c.getNorthEast(),h),this.project(c.getSouthWest(),h));c=h.min.subtract(a.min);h=h.max.subtract(a.max);a=this._rebound(c.x,-h.x);c=this._rebound(c.y,-h.y);return new b.Point(a,c)},_rebound:function(a,b){return 0<a+b?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var c=this.getMinZoom(),h=this.getMaxZoom(),k=b.Browser.any3d?this.options.zoomSnap:1;k&&(a=Math.round(a/k)*k);return Math.max(c,Math.min(h,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){b.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();if(!0!==(b&&b.animate)&&!this.getSize().contains(c))return!1;this.panBy(c,b);return!0},_createAnimProxy:function(){var a=this._proxy=b.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a);this.on("zoomanim",function(c){var e=b.DomUtil.TRANSFORM,k=a.style[e];b.DomUtil.setTransform(a,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1));k===a.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var c=this.getCenter(),h=this.getZoom();b.DomUtil.setTransform(a,this.project(c,h),this.getZoomScale(h,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,c,h){if(this._animatingZoom)return!0;h=h||{};if(!this._zoomAnimated||!1===h.animate||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var e=this.getZoomScale(c),e=this._getCenterOffset(a)._divideBy(1-1/e);if(!0!==h.animate&&!this.getSize().contains(e))return!1;b.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,c,!0)},this);return!0},_animateZoom:function(a,c,h,k){h&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=c,b.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));this.fire("zoomanim",{center:a,zoom:c,noUpdate:k});setTimeout(b.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(b.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),b.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}});b.map=function(a,c){return new b.Map(a,c)};b.Layer=b.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(a){a.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){a&&a.removeLayer(this);return this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){this._map._targets[b.stamp(a)]=this;return this},removeInteractiveTarget:function(a){delete this._map._targets[b.stamp(a)];return this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){this._map=b;this._zoomAnimated=b._zoomAnimated;if(this.getEvents){var c=this.getEvents();b.on(c,this);this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b);this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution());this.fire("add");b.fire("layeradd",{layer:this})}}});b.Map.include({addLayer:function(a){var c=b.stamp(a);if(this._layers[c])return this;this._layers[c]=a;a._mapToAdd=this;a.beforeAdd&&a.beforeAdd(this);this.whenReady(a._layerAdd,a);return this},removeLayer:function(a){var c=b.stamp(a);if(!this._layers[c])return this;if(this._loaded)a.onRemove(this);a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution());delete this._layers[c];this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove"));a._map=a._mapToAdd=null;return this},hasLayer:function(a){return!!a&&b.stamp(a)in this._layers},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},_addLayers:function(a){a=a?b.Util.isArray(a)?a:[a]:[];for(var c=0,h=a.length;c<h;c++)this.addLayer(a[c])},_addZoomLimit:function(a){if(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))this._zoomBoundLayers[b.stamp(a)]=a,this._updateZoomLevels()},_removeZoomLimit:function(a){a=b.stamp(a);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=Infinity,b=-Infinity,c=this._getZoomSpan(),k;for(k in this._zoomBoundLayers)var f=this._zoomBoundLayers[k].options,a=f.minZoom===d?a:Math.min(a,f.minZoom),b=f.maxZoom===d?b:Math.max(b,f.maxZoom);this._layersMaxZoom=-Infinity===b?d:b;this._layersMinZoom=Infinity===a?d:a;c!==this._getZoomSpan()&&this.fire("zoomlevelschange");this.options.maxZoom===d&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);this.options.minZoom===d&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});b.DomEvent={on:function(a,c,h,k){if("object"===typeof c)for(var e in c)this._on(a,e,c[e],h);else{c=b.Util.splitWords(c);e=0;for(var d=c.length;e<d;e++)this._on(a,c[e],h,k)}return this},off:function(a,c,h,k){if("object"===typeof c)for(var e in c)this._off(a,e,c[e],h);else{c=b.Util.splitWords(c);e=0;for(var d=c.length;e<d;e++)this._off(a,c[e],h,k)}return this},_on:function(a,c,h,k){var e=c+b.stamp(h)+(k?"_"+b.stamp(k):"");if(a._leaflet_events&&a._leaflet_events[e])return this;var d=function(b){return h.call(k||a,b||f.event)},l=d;b.Browser.pointer&&0===c.indexOf("touch")?this.addPointerListener(a,c,d,e):!b.Browser.touch||"dblclick"!==c||!this.addDoubleTapListener||b.Browser.pointer&&b.Browser.chrome?"addEventListener"in a?"mousewheel"===c?a.addEventListener("onwheel"in a?"wheel":"mousewheel",d,!1):"mouseenter"===c||"mouseleave"===c?(d=function(c){c=c||f.event;b.DomEvent._isExternalTarget(a,c)&&l(c)},a.addEventListener("mouseenter"===c?"mouseover":"mouseout",d,!1)):("click"===c&&b.Browser.android&&(d=function(a){return b.DomEvent._filterClick(a,l)}),a.addEventListener(c,d,!1)):"attachEvent"in a&&a.attachEvent("on"+c,d):this.addDoubleTapListener(a,d,e);a._leaflet_events=a._leaflet_events||{};a._leaflet_events[e]=d;return this},_off:function(a,c,h,k){h=c+b.stamp(h)+(k?"_"+b.stamp(k):"");k=a._leaflet_events&&a._leaflet_events[h];if(!k)return this;b.Browser.pointer&&0===c.indexOf("touch")?this.removePointerListener(a,c,h):b.Browser.touch&&"dblclick"===c&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,h):"removeEventListener"in a?"mousewheel"===c?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",k,!1):a.removeEventListener("mouseenter"===c?"mouseover":"mouseleave"===c?"mouseout":c,k,!1):"detachEvent"in a&&a.detachEvent("on"+c,k);a._leaflet_events[h]=null;return this},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0;b.DomEvent._skipped(a);return this},disableScrollPropagation:function(a){return b.DomEvent.on(a,"mousewheel",b.DomEvent.stopPropagation)},disableClickPropagation:function(a){var c=b.DomEvent.stopPropagation;b.DomEvent.on(a,b.Draggable.START.join(" "),c);return b.DomEvent.on(a,{click:b.DomEvent._fakeStop,dblclick:c})},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this},stop:function(a){return b.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,c){if(!c)return new b.Point(a.clientX,a.clientY);var e=c.getBoundingClientRect();return new b.Point(a.clientX-e.left-c.clientLeft,a.clientY-e.top-c.clientTop)},_wheelPxFactor:b.Browser.win&&b.Browser.chrome?2:b.Browser.gecko?f.devicePixelRatio:1,getWheelDelta:function(a){return b.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/b.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){b.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];this._skipEvents[a.type]=!1;return b},_isExternalTarget:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(k){return!1}return c!==a},_filterClick:function(a,c){var e=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,k=b.DomEvent._lastClick&&e-b.DomEvent._lastClick;k&&100<k&&500>k||a.target._simulatedClick&&!a._simulated?b.DomEvent.stop(a):(b.DomEvent._lastClick=e,c(a))}};b.DomEvent.addListener=b.DomEvent.on;b.DomEvent.removeListener=b.DomEvent.off;b.PosAnimation=b.Evented.extend({run:function(a,c,h,k){this.stop();this._el=a;this._inProgress=!0;this._duration=h||.25;this._easeOutPower=1/Math.max(k||.5,.2);this._startPos=b.DomUtil.getPosition(a);this._offset=c.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=b.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(a){var b=+new Date-this._startTime,c=1E3*this._duration;b<c?this._runFrame(this._easeOut(b/c),a):(this._runFrame(1),this._complete())},_runFrame:function(a,c){var e=this._startPos.add(this._offset.multiplyBy(a));c&&e._round();b.DomUtil.setPosition(this._el,e);this.fire("step")},_complete:function(){b.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});b.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:b.bounds([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(a){var c=Math.PI/180,h=this.R,k=a.lat*c,d=this.R_MINOR/h,d=Math.sqrt(1-d*d),f=d*Math.sin(k),k=-h*Math.log(Math.max(Math.tan(Math.PI/4-k/2)/Math.pow((1-f)/(1+f),d/2),1E-10));return new b.Point(a.lng*c*h,k)},unproject:function(a){for(var c=180/Math.PI,h=this.R,k=this.R_MINOR/h,k=Math.sqrt(1-k*k),d=Math.exp(-a.y/h),f=Math.PI/2-2*Math.atan(d),l=0,g=.1;15>l&&1E-7<Math.abs(g);l++)g=k*Math.sin(f),g=Math.pow((1-g)/(1+g),k/2),g=Math.PI/2-2*Math.atan(d*g)-f,f+=g;return new b.LatLng(f*c,a.x*c/h)}};b.CRS.EPSG3395=b.extend({},b.CRS.Earth,{code:"EPSG:3395",projection:b.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*b.Projection.Mercator.R);return new b.Transformation(a,.5,-a,.5)}()});b.GridLayer=b.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:b.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:d,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){b.setOptions(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();b.DomUtil.remove(this._container);a._removeZoomLimit(this);this._tileZoom=this._container=null},bringToFront:function(){this._map&&(b.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max));return this},bringToBack:function(){this._map&&(b.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min));return this},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},isLoading:function(){return this._loading},redraw:function(){this._map&&(this._removeAllTiles(),this._update());return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};this.options.updateWhenIdle||(this._onMove||(this._onMove=b.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove);this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},createTile:function(){return g.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof b.Point?a:new b.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==d&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var b=this.getPane().children,c=-a(-Infinity,Infinity),k=0,d=b.length,f;k<d;k++)f=b[k].style.zIndex,b[k]!==this._container&&f&&(c=a(c,+f));isFinite(c)&&(this.options.zIndex=c+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!b.Browser.ielt9){b.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,c=!1,h=!1,k;for(k in this._tiles){var d=this._tiles[k];if(d.current&&d.loaded){var f=Math.min(1,(a-d.loaded)/200);b.DomUtil.setOpacity(d.el,f);1>f?c=!0:(d.active&&(h=!0),d.active=!0)}}h&&!this._noPrune&&this._pruneTiles();c&&(b.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=b.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=b.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,c=this.options.maxZoom;if(a===d)return d;for(var h in this._levels)this._levels[h].el.children.length||h===a?this._levels[h].el.style.zIndex=c-Math.abs(a-h):(b.DomUtil.remove(this._levels[h].el),this._removeTilesAtZoom(h),delete this._levels[h]);h=this._levels[a];var k=this._map;h||(h=this._levels[a]={},h.el=b.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=c,h.origin=k.project(k.unproject(k.getPixelOrigin()),a).round(),h.zoom=a,this._setZoomTransform(h,k.getCenter(),k.getZoom()),b.Util.falseFn(h.el.offsetWidth));return this._level=h},_pruneTiles:function(){if(this._map){var a,b;b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)b=this._tiles[a],b.retain=b.current;for(a in this._tiles)b=this._tiles[a],b.current&&!b.active&&(b=b.coords,this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2));for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)b.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles();this._tileZoom=null},_retainParent:function(a,c,h,k){a=Math.floor(a/2);c=Math.floor(c/2);--h;var e=new b.Point(+a,+c);e.z=+h;e=this._tileCoordsToKey(e);if((e=this._tiles[e])&&e.active)return e.retain=!0;e&&e.loaded&&(e.retain=!0);return h>k?this._retainParent(a,c,h,k):!1},_retainChildren:function(a,c,h,k){for(var e=2*a;e<2*a+2;e++)for(var d=2*c;d<2*c+2;d++){var f=new b.Point(e,d);f.z=h+1;f=this._tileCoordsToKey(f);(f=this._tiles[f])&&f.active?f.retain=!0:(f&&f.loaded&&(f.retain=!0),h+1<k&&this._retainChildren(e,d,h+1,k))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,b,c,k){var e=Math.round(b);if(this.options.maxZoom!==d&&e>this.options.maxZoom||this.options.minZoom!==d&&e<this.options.minZoom)e=d;var h=this.options.updateWhenZooming&&e!==this._tileZoom;if(!k||h)this._tileZoom=e,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),e!==d&&this._update(a),c||this._pruneTiles(),this._noPrune=!!c;this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,c,h){var e=this._map.getZoomScale(h,a.zoom);c=a.origin.multiplyBy(e).subtract(this._map._getNewPixelOrigin(c,h)).round();b.Browser.any3d?b.DomUtil.setTransform(a.el,c,e):b.DomUtil.setPosition(a.el,c)},_resetGrid:function(){var a=this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),k=this._tileZoom,d=this._map.getPixelWorldBounds(this._tileZoom);d&&(this._globalTileRange=this._pxBoundsToTileRange(d));this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],k).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],k).x/c.y)];this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],k).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],k).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var c=this._map,h=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),h=c.getZoomScale(h,this._tileZoom);a=c.project(a,this._tileZoom).floor();c=c.getSize().divideBy(2*h);return new b.Bounds(a.subtract(c),a.add(c))},_update:function(a){var c=this._map;if(c){var h=c.getZoom();a===d&&(a=c.getCenter());if(this._tileZoom!==d){var c=this._getTiledPixelBounds(a),k=this._pxBoundsToTileRange(c),f=k.getCenter(),c=[],l=this.options.keepBuffer,l=new b.Bounds(k.getBottomLeft().subtract([l,-l]),k.getTopRight().add([l,-l])),t;for(t in this._tiles){var p=this._tiles[t].coords;p.z===this._tileZoom&&l.contains(b.point(p.x,p.y))||(this._tiles[t].current=!1)}if(1<Math.abs(h-this._tileZoom))this._setView(a,h);else{for(h=k.min.y;h<=k.max.y;h++)for(a=k.min.x;a<=k.max.x;a++)t=new b.Point(a,h),t.z=this._tileZoom,this._isValidTile(t)&&((l=this._tiles[this._tileCoordsToKey(t)])?l.current=!0:c.push(t));c.sort(function(a,b){return a.distanceTo(f)-b.distanceTo(f)});if(0!==c.length){this._loading||(this._loading=!0,this.fire("loading"));k=g.createDocumentFragment();for(a=0;a<c.length;a++)this._addTile(c[a],k);this._level.el.appendChild(k)}}}}},_isValidTile:function(a){var c=this._map.options.crs;if(!c.infinite){var h=this._globalTileRange;if(!c.wrapLng&&(a.x<h.min.x||a.x>h.max.x)||!c.wrapLat&&(a.y<h.min.y||a.y>h.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return b.latLngBounds(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var c=this._map,h=this.getTileSize(),k=a.scaleBy(h),h=k.add(h),k=c.unproject(k,a.z);a=c.unproject(h,a.z);a=new b.LatLngBounds(k,a);this.options.noWrap||c.wrapLatLngBounds(a);return a},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=a.split(":");var c=new b.Point(+a[0],+a[1]);c.z=+a[2];return c},_removeTile:function(a){var c=this._tiles[a];c&&(b.DomUtil.remove(c.el),delete this._tiles[a],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){b.DomUtil.addClass(a,"leaflet-tile");var c=this.getTileSize();a.style.width=c.x+"px";a.style.height=c.y+"px";a.onselectstart=b.Util.falseFn;a.onmousemove=b.Util.falseFn;b.Browser.ielt9&&1>this.options.opacity&&b.DomUtil.setOpacity(a,this.options.opacity);b.Browser.android&&!b.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,c){var e=this._getTilePos(a),k=this._tileCoordsToKey(a),d=this.createTile(this._wrapCoords(a),b.bind(this._tileReady,this,a));this._initTile(d);2>this.createTile.length&&b.Util.requestAnimFrame(b.bind(this._tileReady,this,a,null,d));b.DomUtil.setPosition(d,e);this._tiles[k]={el:d,coords:a,current:!0};c.appendChild(d);this.fire("tileloadstart",{tile:d,coords:a})},_tileReady:function(a,c,h){this._map&&(c&&this.fire("tileerror",{error:c,tile:h,coords:a}),h=this._tileCoordsToKey(a),h=this._tiles[h])&&(h.loaded=+new Date,this._map._fadeAnimated?(b.DomUtil.setOpacity(h.el,0),b.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=b.Util.requestAnimFrame(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),c||(b.DomUtil.addClass(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),b.Browser.ielt9||!this._map._fadeAnimated?b.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(b.bind(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var c=new b.Point(this._wrapX?b.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?b.Util.wrapNum(a.y,this._wrapY):a.y);c.z=a.z;return c},_pxBoundsToTileRange:function(a){var c=this.getTileSize();return new b.Bounds(a.min.unscaleBy(c).floor(),a.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});b.gridLayer=function(a){return new b.GridLayer(a)};b.TileLayer=b.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,c){this._url=a;c=b.setOptions(this,c);c.detectRetina&&b.Browser.retina&&0<c.maxZoom&&(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom++):(c.zoomOffset++,c.maxZoom--),c.minZoom=Math.max(0,c.minZoom));"string"===typeof c.subdomains&&(c.subdomains=c.subdomains.split(""));if(!b.Browser.android)this.on("tileunload",this._onTileRemove)},setUrl:function(a,b){this._url=a;b||this.redraw();return this},createTile:function(a,c){var e=g.createElement("img");b.DomEvent.on(e,"load",b.bind(this._tileOnLoad,this,c,e));b.DomEvent.on(e,"error",b.bind(this._tileOnError,this,c,e));this.options.crossOrigin&&(e.crossOrigin="");e.alt="";e.setAttribute("role","presentation");e.src=this.getTileUrl(a);return e},getTileUrl:function(a){var c={r:b.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(c.y=a),c["-y"]=a);return b.Util.template(this._url,b.extend(c,this.options))},_tileOnLoad:function(a,c){b.Browser.ielt9?setTimeout(b.bind(a,this,null,c),0):a(null,c)},_tileOnError:function(a,b,c){var e=this.options.errorTileUrl;e&&b.src!==e&&(b.src=e);a(c,b)},getTileSize:function(){var a=this._map,c=b.GridLayer.prototype.getTileSize.call(this),h=this._tileZoom+this.options.zoomOffset,k=this.options.minNativeZoom,d=this.options.maxNativeZoom;return null!==k&&h<k?c.divideBy(a.getZoomScale(k,h)).round():null!==d&&h>d?c.divideBy(a.getZoomScale(d,h)).round():c},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomOffset,k=this.options.minNativeZoom,d=this.options.maxNativeZoom;this.options.zoomReverse&&(a=b-a);a+=c;return null!==k&&a<k?k:null!==d&&a>d?d:a},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,c;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(c=this._tiles[a].el,c.onload=b.Util.falseFn,c.onerror=b.Util.falseFn,c.complete||(c.src=b.Util.emptyImageUrl,b.DomUtil.remove(c)))}});b.tileLayer=function(a,c){return new b.TileLayer(a,c)};b.TileLayer.WMS=b.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var e=b.extend({},this.defaultWmsParams),k;for(k in c)k in this.options||(e[k]=c[k]);c=b.setOptions(this,c);e.width=e.height=c.tileSize*(c.detectRetina&&b.Browser.retina?2:1);this.wmsParams=e},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;b.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var c=this._tileCoordsToBounds(a),h=this._crs.project(c.getNorthWest()),c=this._crs.project(c.getSouthEast()),h=(1.3<=this._wmsVersion&&this._crs===b.CRS.EPSG4326?[c.y,h.x,h.y,c.x]:[h.x,c.y,c.x,h.y]).join(",");a=b.TileLayer.prototype.getTileUrl.call(this,a);return a+b.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+h},setParams:function(a,c){b.extend(this.wmsParams,a);c||this.redraw();return this}});b.tileLayer.wms=function(a,c){return new b.TileLayer.WMS(a,c)};b.ImageOverlay=b.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(a,c,h){this._url=a;this._bounds=b.latLngBounds(c);b.setOptions(this,h)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(b.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){b.DomUtil.remove(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){this.options.opacity=a;this._image&&this._updateOpacity();return this},setStyle:function(a){a.opacity&&this.setOpacity(a.opacity);return this},bringToFront:function(){this._map&&b.DomUtil.toFront(this._image);return this},bringToBack:function(){this._map&&b.DomUtil.toBack(this._image);return this},setUrl:function(a){this._url=a;this._image&&(this._image.src=a);return this},setBounds:function(a){this._bounds=a;this._map&&this._reset();return this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=b.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=b.Util.falseFn;a.onmousemove=b.Util.falseFn;a.onload=b.bind(this.fire,this,"load");this.options.crossOrigin&&(a.crossOrigin="");a.src=this._url;a.alt=this.options.alt},_animateZoom:function(a){var c=this._map.getZoomScale(a.zoom);a=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;b.DomUtil.setTransform(this._image,a,c)},_reset:function(){var a=this._image,c=new b.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=c.getSize();b.DomUtil.setPosition(a,c.min);a.style.width=h.x+"px";a.style.height=h.y+"px"},_updateOpacity:function(){b.DomUtil.setOpacity(this._image,this.options.opacity)}});b.imageOverlay=function(a,c,h){return new b.ImageOverlay(a,c,h)};b.Icon=b.Class.extend({initialize:function(a){b.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}c=this._createImg(c,b&&"IMG"===b.tagName?b:null);this._setIconStyles(c,a);return c},_setIconStyles:function(a,c){var e=this.options,k=e[c+"Size"];"number"===typeof k&&(k=[k,k]);var k=b.point(k),d=b.point("shadow"===c&&e.shadowAnchor||e.iconAnchor||k&&k.divideBy(2,!0));a.className="leaflet-marker-"+c+" "+(e.className||"");d&&(a.style.marginLeft=-d.x+"px",a.style.marginTop=-d.y+"px");k&&(a.style.width=k.x+"px",a.style.height=k.y+"px")},_createImg:function(a,b){b=b||g.createElement("img");b.src=a;return b},_getIconUrl:function(a){return b.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});b.icon=function(a){return new b.Icon(a)};b.Icon.Default=b.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){b.Icon.Default.imagePath||(b.Icon.Default.imagePath=this._detectIconPath());return(this.options.imagePath||b.Icon.Default.imagePath)+b.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=b.DomUtil.create("div","leaflet-default-icon-path",g.body),c=b.DomUtil.getStyle(a,"background-image")||b.DomUtil.getStyle(a,"backgroundImage");g.body.removeChild(a);return 0===c.indexOf("url")?c.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}});b.Marker=b.Layer.extend({options:{icon:new b.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,c){b.setOptions(this,c);this._latlng=b.latLng(a)},onAdd:function(a){if(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var c=this._latlng;this._latlng=b.latLng(a);this.update();return this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;return this.update()},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup,this._popup.options);return this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=a.icon.createIcon(this._icon),k=!1;h!==this._icon&&(this._icon&&this._removeIcon(),k=!0,a.title&&(h.title=a.title),a.alt&&(h.alt=a.alt));b.DomUtil.addClass(h,c);a.keyboard&&(h.tabIndex="0");this._icon=h;if(a.riseOnHover)this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var h=a.icon.createShadow(this._shadow),d=!1;h!==this._shadow&&(this._removeShadow(),d=!0);h&&(b.DomUtil.addClass(h,c),h.alt="");this._shadow=h;1>a.opacity&&this._updateOpacity();k&&this.getPane().appendChild(this._icon);this._initInteraction();h&&d&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});b.DomUtil.remove(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&b.DomUtil.remove(this._shadow);this._shadow=null},_setPos:function(a){b.DomUtil.setPosition(this._icon,a);this._shadow&&b.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(b.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),b.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable());this.dragging=new b.Handler.MarkerDrag(this);a&&this.dragging.enable()}},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){var a=this.options.opacity;b.DomUtil.setOpacity(this._icon,a);this._shadow&&b.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}});b.marker=function(a,c){return new b.Marker(a,c)};b.DivIcon=b.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){a=a&&"DIV"===a.tagName?a:g.createElement("div");var c=this.options;a.innerHTML=!1!==c.html?c.html:"";c.bgPos&&(c=b.point(c.bgPos),a.style.backgroundPosition=-c.x+"px "+-c.y+"px");this._setIconStyles(a,"icon");return a},createShadow:function(){return null}});b.divIcon=function(a){return new b.DivIcon(a)};b.DivOverlay=b.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,c){b.setOptions(this,a);this._source=c},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&b.DomUtil.setOpacity(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&b.DomUtil.setOpacity(this._container,1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?(b.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(b.bind(b.DomUtil.remove,b.DomUtil,this._container),200)):b.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=b.latLng(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){this._map&&b.DomUtil.toFront(this._container);return this},bringToBack:function(){this._map&&b.DomUtil.toBack(this._container);return this},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),c=b.point(this.options.offset),h=this._getAnchor();this._zoomAnimated?b.DomUtil.setPosition(this._container,a.add(h)):c=c.add(a).add(h);a=this._containerBottom=-c.y;c=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=a+"px";this._container.style.left=c+"px"}},_getAnchor:function(){return[0,0]}});b.Popup=b.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){a.openPopup(this);return this},onAdd:function(a){b.DivOverlay.prototype.onAdd.call(this,a);a.fire("popupopen",{popup:this});if(this._source&&(this._source.fire("popupopen",{popup:this},!0),!(this._source instanceof b.Path)))this._source.on("preclick",b.DomEvent.stopPropagation)},onRemove:function(a){b.DivOverlay.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof b.Path||this._source.off("preclick",b.DomEvent.stopPropagation))},getEvents:function(){var a=b.DivOverlay.prototype.getEvents.call(this);if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)a.preclick=this._close;this.options.keepInView&&(a.moveend=this._adjustPan);return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=b.DomUtil.create("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var c=this._closeButton=b.DomUtil.create("a","leaflet-popup-close-button",a);c.href="#close";c.innerHTML="\x26#215;";b.DomEvent.on(c,"click",this._onCloseButtonClick,this)}c=this._wrapper=b.DomUtil.create("div","leaflet-popup-content-wrapper",a);this._contentNode=b.DomUtil.create("div","leaflet-popup-content",c);b.DomEvent.disableClickPropagation(c).disableScrollPropagation(this._contentNode).on(c,"contextmenu",b.DomEvent.stopPropagation);this._tipContainer=b.DomUtil.create("div","leaflet-popup-tip-container",a);this._tip=b.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,c=a.style;c.width="";c.whiteSpace="nowrap";var h=a.offsetWidth,h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth);c.width=h+1+"px";c.whiteSpace="";c.height="";var h=a.offsetHeight,k=this.options.maxHeight;k&&h>k?(c.height=k+"px",b.DomUtil.addClass(a,"leaflet-popup-scrolled")):b.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);var c=this._getAnchor();b.DomUtil.setPosition(this._container,a.add(c))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,c=parseInt(b.DomUtil.getStyle(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+c,h=this._containerWidth,k=new b.Point(this._containerLeft,-c-this._containerBottom);k._add(b.DomUtil.getPosition(this._container));var k=a.layerPointToContainerPoint(k),d=b.point(this.options.autoPanPadding),f=b.point(this.options.autoPanPaddingTopLeft||d),d=b.point(this.options.autoPanPaddingBottomRight||d),l=a.getSize(),g=0,r=0;k.x+h+d.x>l.x&&(g=k.x+h-l.x+d.x);0>k.x-g-f.x&&(g=k.x-f.x);k.y+c+d.y>l.y&&(r=k.y+c-l.y+d.y);0>k.y-r-f.y&&(r=k.y-f.y);(g||r)&&a.fire("autopanstart").panBy([g,r])}},_onCloseButtonClick:function(a){this._close();b.DomEvent.stop(a)},_getAnchor:function(){return b.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});b.popup=function(a,c){return new b.Popup(a,c)};b.Map.mergeOptions({closePopupOnClick:!0});b.Map.include({openPopup:function(a,c,h){a instanceof b.Popup||(a=(new b.Popup(h)).setContent(a));c&&a.setLatLng(c);if(this.hasLayer(a))return this;this._popup&&this._popup.options.autoClose&&this.closePopup();this._popup=a;return this.addLayer(a)},closePopup:function(a){a&&a!==this._popup||(a=this._popup,this._popup=null);a&&this.removeLayer(a);return this}});b.Layer.include({bindPopup:function(a,c){if(a instanceof b.Popup)b.setOptions(a,c),this._popup=a,a._source=this;else{if(!this._popup||c)this._popup=new b.Popup(c,this);this._popup.setContent(a)}this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0);return this},unbindPopup:function(){this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null);return this},openPopup:function(a,c){a instanceof b.Layer||(c=a,a=this);if(a instanceof b.FeatureGroup)for(var e in this._layers){a=this._layers[e];break}c||(c=a.getCenter?a.getCenter():a.getLatLng());this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,c));return this},closePopup:function(){this._popup&&this._popup._close();return this},togglePopup:function(a){this._popup&&(this._popup._map?this.closePopup():this.openPopup(a));return this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){this._popup&&this._popup.setContent(a);return this},getPopup:function(){return this._popup},_openPopup:function(a){var c=a.layer||a.target;this._popup&&this._map&&(b.DomEvent.stop(a),c instanceof b.Path?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===c?this.closePopup():this.openPopup(c,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});b.Tooltip=b.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){b.DivOverlay.prototype.onAdd.call(this,a);this.setOpacity(this.options.opacity);a.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){b.DivOverlay.prototype.onRemove.call(this,a);a.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=b.DivOverlay.prototype.getEvents.call(this);b.Browser.touch&&!this.options.permanent&&(a.preclick=this._close);return a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=b.DomUtil.create("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var c=this._map,h=this._container,k=c.latLngToContainerPoint(c.getCenter()),c=c.layerPointToContainerPoint(a),d=this.options.direction,f=h.offsetWidth,l=h.offsetHeight,g=b.point(this.options.offset),r=this._getAnchor();"top"===d?a=a.add(b.point(-f/2+g.x,-l+g.y+r.y,!0)):"bottom"===d?a=a.subtract(b.point(f/2-g.x,-g.y,!0)):"center"===d?a=a.subtract(b.point(f/2+g.x,l/2-r.y+g.y,!0)):"right"===d||"auto"===d&&c.x<k.x?(d="right",a=a.add(b.point(g.x+r.x,r.y-l/2+g.y,!0))):(d="left",a=a.subtract(b.point(f+r.x-g.x,l/2-r.y-g.y,!0)));b.DomUtil.removeClass(h,"leaflet-tooltip-right");b.DomUtil.removeClass(h,"leaflet-tooltip-left");b.DomUtil.removeClass(h,"leaflet-tooltip-top");b.DomUtil.removeClass(h,"leaflet-tooltip-bottom");b.DomUtil.addClass(h,"leaflet-tooltip-"+d);b.DomUtil.setPosition(h,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a;this._container&&b.DomUtil.setOpacity(this._container,a)},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(a)},_getAnchor:function(){return b.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});b.tooltip=function(a,c){return new b.Tooltip(a,c)};b.Map.include({openTooltip:function(a,c,h){a instanceof b.Tooltip||(a=(new b.Tooltip(h)).setContent(a));c&&a.setLatLng(c);return this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){a&&this.removeLayer(a);return this}});b.Layer.include({bindTooltip:function(a,c){if(a instanceof b.Tooltip)b.setOptions(a,c),this._tooltip=a,a._source=this;else{if(!this._tooltip||c)this._tooltip=b.tooltip(c,this);this._tooltip.setContent(a)}this._initTooltipInteractions();this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip();return this},unbindTooltip:function(){this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null);return this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),b.Browser.touch&&(c.click=this._openTooltip));this[a?"off":"on"](c);this._tooltipHandlersAdded=!a}},openTooltip:function(a,c){a instanceof b.Layer||(c=a,a=this);if(a instanceof b.FeatureGroup)for(var e in this._layers){a=this._layers[e];break}c||(c=a.getCenter?a.getCenter():a.getLatLng());this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,c),this._tooltip.options.interactive&&this._tooltip._container&&(b.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container)));return this},closeTooltip:function(){this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(b.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container)));return this},toggleTooltip:function(a){this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a));return this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){this._tooltip&&this._tooltip.setContent(a);return this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){this._tooltip&&this._map&&this.openTooltip(a.layer||a.target,this._tooltip.options.sticky?a.latlng:d)},_moveTooltip:function(a){var b=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(a=this._map.mouseEventToContainerPoint(a.originalEvent),a=this._map.containerPointToLayerPoint(a),b=this._map.layerPointToLatLng(a));this._tooltip.setLatLng(b)}});b.LayerGroup=b.Layer.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);this._layers[b]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var b=Array.prototype.slice.call(arguments,1),c,k;for(c in this._layers)k=this._layers[c],k[a]&&k[a].apply(k,b);return this},onAdd:function(a){for(var b in this._layers)a.addLayer(this._layers[b])},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b])},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return b.stamp(a)}});b.layerGroup=function(a){return new b.LayerGroup(a)};b.FeatureGroup=b.LayerGroup.extend({addLayer:function(a){if(this.hasLayer(a))return this;a.addEventParent(this);b.LayerGroup.prototype.addLayer.call(this,a);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=this._layers[a]);a.removeEventParent(this);b.LayerGroup.prototype.removeLayer.call(this,a);return this.fire("layerremove",{layer:a})},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new b.LatLngBounds,c;for(c in this._layers){var h=this._layers[c];a.extend(h.getBounds?h.getBounds():h.getLatLng())}return a}});b.featureGroup=function(a){return new b.FeatureGroup(a)};b.Renderer=b.Layer.extend({options:{padding:.1},initialize:function(a){b.setOptions(this,a);b.stamp(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&b.DomUtil.addClass(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){b.DomUtil.remove(this._container);this.off("update",this._updatePaths,this)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};this._zoomAnimated&&(a.zoomanim=this._onAnimZoom);return a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,c){var e=this._map.getZoomScale(c,this._zoom),k=b.DomUtil.getPosition(this._container),d=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,c),f=this._map.project(a,c).subtract(f),k=d.multiplyBy(-e).add(k).add(d).subtract(f);b.Browser.any3d?b.DomUtil.setTransform(this._container,k,e):b.DomUtil.setPosition(this._container,k)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,c=this._map.getSize(),h=this._map.containerPointToLayerPoint(c.multiplyBy(-a)).round();this._bounds=new b.Bounds(h,h.add(c.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}});b.Map.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;a||(a=this._renderer=this.options.preferCanvas&&b.canvas()||b.svg());this.hasLayer(a)||this.addLayer(a);return a},_getPaneRenderer:function(a){if("overlayPane"===a||a===d)return!1;var c=this._paneRenderers[a];c===d&&(c=b.SVG&&b.svg({pane:a})||b.Canvas&&b.canvas({pane:a}),this._paneRenderers[a]=c);return c}});b.Path=b.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){this._map&&this._renderer._updatePath(this);return this},setStyle:function(a){b.setOptions(this,a);this._renderer&&this._renderer._updateStyle(this);return this},bringToFront:function(){this._renderer&&this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer&&this._renderer._bringToBack(this);return this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(b.Browser.touch?10:0)}});b.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;a=this._reducePoints(a,c);return a=this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var c=a.length,e=new (typeof Uint8Array!==d+""?Uint8Array:Array)(c);e[0]=e[c-1]=1;this._simplifyDPStep(a,e,b,0,c-1);var f,l=[];for(f=0;f<c;f++)e[f]&&l.push(a[f]);return l},_simplifyDPStep:function(a,b,c,k,d){var e=0,h,f,l;for(f=k+1;f<=d-1;f++)l=this._sqClosestPointOnSegment(a[f],a[k],a[d],!0),l>e&&(h=f,e=l);e>c&&(b[h]=1,this._simplifyDPStep(a,b,c,k,h),this._simplifyDPStep(a,b,c,h,d))},_reducePoints:function(a,b){for(var c=[a[0]],e=1,d=0,f=a.length;e<f;e++)this._sqDist(a[e],a[d])>b&&(c.push(a[e]),d=e);d<f-1&&c.push(a[f-1]);return c},clipSegment:function(a,b,c,k,d){k=k?this._lastCode:this._getBitCode(a,c);var e=this._getBitCode(b,c),h,f,l;for(this._lastCode=e;;){if(!(k|e))return[a,b];if(k&e)return!1;h=k||e;f=this._getEdgeIntersection(a,b,h,c,d);l=this._getBitCode(f,c);h===k?(a=f,k=l):(b=f,e=l)}},_getEdgeIntersection:function(a,c,h,k,d){var e=c.x-a.x;c=c.y-a.y;var f=k.min;k=k.max;var l,g;h&8?(l=a.x+e*(k.y-a.y)/c,g=k.y):h&4?(l=a.x+e*(f.y-a.y)/c,g=f.y):h&2?(l=k.x,g=a.y+c*(k.x-a.x)/e):h&1&&(l=f.x,g=a.y+c*(f.x-a.x)/e);return new b.Point(l,g,d)},_getBitCode:function(a,b){var c=0;a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2);a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8);return c},_sqDist:function(a,b){var c=b.x-a.x,e=b.y-a.y;return c*c+e*e},_sqClosestPointOnSegment:function(a,c,h,k){var e=c.x;c=c.y;var d=h.x-e,f=h.y-c,l=d*d+f*f;0<l&&(l=((a.x-e)*d+(a.y-c)*f)/l,1<l?(e=h.x,c=h.y):0<l&&(e+=d*l,c+=f*l));d=a.x-e;f=a.y-c;return k?d*d+f*f:new b.Point(e,c)}};b.Polyline=b.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,c){b.setOptions(this,c);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._setLatLngs(a);return this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var c=Infinity,h=null,k=b.LineUtil._sqClosestPointOnSegment,d,f,l=0,g=this._parts.length;l<g;l++)for(var r=this._parts[l],q=1,x=r.length;q<x;q++){d=r[q-1];f=r[q];var A=k(a,d,f,!0);A<c&&(c=A,h=k(a,d,f))}h&&(h.distance=Math.sqrt(c));return h},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,b,c,k,d,f,l=this._rings[0],g=l.length;if(!g)return null;for(b=a=0;a<g-1;a++)b+=l[a].distanceTo(l[a+1])/2;if(0===b)return this._map.layerPointToLatLng(l[0]);for(k=a=0;a<g-1;a++)if(d=l[a],f=l[a+1],c=d.distanceTo(f),k+=c,k>b)return a=(k-b)/c,this._map.layerPointToLatLng([f.x-a*(f.x-d.x),f.y-a*(f.y-d.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,c){c=c||this._defaultShape();a=b.latLng(a);c.push(a);this._bounds.extend(a);return this.redraw()},_setLatLngs:function(a){this._bounds=new b.LatLngBounds;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return b.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var c=[],h=b.Polyline._flat(a),k=0,d=a.length;k<d;k++)h?(c[k]=b.latLng(a[k]),this._bounds.extend(c[k])):c[k]=this._convertLatLngs(a[k]);return c},_project:function(){var a=new b.Bounds;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var c=this._clickTolerance(),c=new b.Point(c,c);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(c),a.max._add(c),this._pxBounds=a)},_projectLatlngs:function(a,c,h){var e=a.length,d,f;if(a[0]instanceof b.LatLng){f=[];for(d=0;d<e;d++)f[d]=this._map.latLngToLayerPoint(a[d]),h.extend(f[d]);c.push(f)}else for(d=0;d<e;d++)this._projectLatlngs(a[d],c,h)},_clipPoints:function(){var a=this._renderer._bounds;this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var c=this._parts,h,k,d,f,l,g,r;d=h=0;for(f=this._rings.length;h<f;h++)for(r=this._rings[h],k=0,l=r.length;k<l-1;k++)if(g=b.LineUtil.clipSegment(r[k],r[k+1],a,k,!0))if(c[d]=c[d]||[],c[d].push(g[0]),g[1]!==r[k+1]||k===l-2)c[d].push(g[1]),d++}},_simplifyPoints:function(){for(var a=this._parts,c=this.options.smoothFactor,h=0,k=a.length;h<k;h++)a[h]=b.LineUtil.simplify(a[h],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}});b.polyline=function(a,c){return new b.Polyline(a,c)};b.Polyline._flat=function(a){return!b.Util.isArray(a[0])||"object"!==typeof a[0][0]&&"undefined"!==typeof a[0][0]};b.PolyUtil={};b.PolyUtil.clipPolygon=function(a,c,h){var e,d=[1,4,2,8],f,l,g,r,q,x,A=b.LineUtil;f=0;for(q=a.length;f<q;f++)a[f]._code=A._getBitCode(a[f],c);for(g=0;4>g;g++){x=d[g];e=[];f=0;q=a.length;for(l=q-1;f<q;l=f++)(r=a[f],l=a[l],r._code&x)?l._code&x||(l=A._getEdgeIntersection(l,r,x,c,h),l._code=A._getBitCode(l,c),e.push(l)):(l._code&x&&(l=A._getEdgeIntersection(l,r,x,c,h),l._code=A._getBitCode(l,c),e.push(l)),e.push(r));a=e}return a};b.Polygon=b.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,b,c,k,d,f,l,g=this._rings[0],r=g.length;if(!r)return null;a=d=f=l=0;for(b=r-1;a<r;b=a++)c=g[a],b=g[b],k=c.y*b.x-b.y*c.x,f+=(c.x+b.x)*k,l+=(c.y+b.y)*k,d+=3*k;return this._map.layerPointToLatLng(0===d?g[0]:[f/d,l/d])},_convertLatLngs:function(a){a=b.Polyline.prototype._convertLatLngs.call(this,a);var c=a.length;2<=c&&a[0]instanceof b.LatLng&&a[0].equals(a[c-1])&&a.pop();return a},_setLatLngs:function(a){b.Polyline.prototype._setLatLngs.call(this,a);b.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return b.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,c=this.options.weight,c=new b.Point(c,c),a=new b.Bounds(a.min.subtract(c),a.max.add(c));this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var c=0,h=this._rings.length,k;c<h;c++)k=b.PolyUtil.clipPolygon(this._rings[c],a,!0),k.length&&this._parts.push(k)},_updatePath:function(){this._renderer._updatePoly(this,!0)}});b.polygon=function(a,c){return new b.Polygon(a,c)};b.Rectangle=b.Polygon.extend({initialize:function(a,c){b.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){a=b.latLngBounds(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});b.rectangle=function(a,c){return new b.Rectangle(a,c)};b.CircleMarker=b.Path.extend({options:{fill:!0,radius:10},initialize:function(a,c){b.setOptions(this,c);this._latlng=b.latLng(a);this._radius=this.options.radius},setLatLng:function(a){this._latlng=b.latLng(a);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var c=a&&a.radius||this._radius;b.Path.prototype.setStyle.call(this,a);this.setRadius(c);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,c=this._radiusY||a,h=this._clickTolerance(),a=[a+h,c+h];this._pxBounds=new b.Bounds(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}});b.circleMarker=function(a,c){return new b.CircleMarker(a,c)};b.Circle=b.CircleMarker.extend({initialize:function(a,c,h){"number"===typeof c&&(c=b.extend({},h,{radius:c}));b.setOptions(this,c);this._latlng=b.latLng(a);if(isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){this._mRadius=a;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new b.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:b.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,c=this._latlng.lat,h=this._map,k=h.options.crs;if(k.distance===b.CRS.Earth.distance){var d=Math.PI/180,k=this._mRadius/b.CRS.Earth.R/d,f=h.project([c+k,a]),l=h.project([c-k,a]),l=f.add(l).divideBy(2),g=h.unproject(l).lat,d=Math.acos((Math.cos(k*d)-Math.sin(c*d)*Math.sin(g*d))/(Math.cos(c*d)*Math.cos(g*d)))/d;if(isNaN(d)||0===d)d=k/Math.cos(Math.PI/180*c);this._point=l.subtract(h.getPixelOrigin());this._radius=isNaN(d)?0:Math.max(Math.round(l.x-h.project([g,a-d]).x),1);this._radiusY=Math.max(Math.round(l.y-f.y),1)}else a=k.unproject(k.project(this._latlng).subtract([this._mRadius,0])),this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(a).x;this._updateBounds()}});b.circle=function(a,c,h){return new b.Circle(a,c,h)};b.SVG=b.Renderer.extend({getEvents:function(){var a=b.Renderer.prototype.getEvents.call(this);a.zoomstart=this._onZoomStart;return a},_initContainer:function(){this._container=b.SVG.create("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=b.SVG.create("g");this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){b.Renderer.prototype._update.call(this);var a=this._bounds,c=a.getSize(),h=this._container;this._svgSize&&this._svgSize.equals(c)||(this._svgSize=c,h.setAttribute("width",c.x),h.setAttribute("height",c.y));b.DomUtil.setPosition(h,a.min);h.setAttribute("viewBox",[a.min.x,a.min.y,c.x,c.y].join(" "));this.fire("update")}},_initPath:function(a){var c=a._path=b.SVG.create("path");a.options.className&&b.DomUtil.addClass(c,a.options.className);a.options.interactive&&b.DomUtil.addClass(c,"leaflet-interactive");this._updateStyle(a);this._layers[b.stamp(a)]=a},_addPath:function(a){this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){b.DomUtil.remove(a._path);a.removeInteractiveTarget(a._path);delete this._layers[b.stamp(a)]},_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var b=a._path;a=a.options;b&&(a.stroke?(b.setAttribute("stroke",a.color),b.setAttribute("stroke-opacity",a.opacity),b.setAttribute("stroke-width",a.weight),b.setAttribute("stroke-linecap",a.lineCap),b.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?b.setAttribute("stroke-dasharray",a.dashArray):b.removeAttribute("stroke-dasharray"),a.dashOffset?b.setAttribute("stroke-dashoffset",a.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),a.fill?(b.setAttribute("fill",a.fillColor||a.color),b.setAttribute("fill-opacity",a.fillOpacity),b.setAttribute("fill-rule",a.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(a,c){this._setPath(a,b.SVG.pointsToPath(a._parts,c))},_updateCircle:function(a){var b=a._point,c=a._radius,d="a"+c+","+(a._radiusY||c)+" 0 1,0 ",b=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+d+2*c+",0 "+d+2*-c+",0 ";this._setPath(a,b)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){b.DomUtil.toFront(a._path)},_bringToBack:function(a){b.DomUtil.toBack(a._path)}});b.extend(b.SVG,{create:function(a){return g.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,c){var e="",d,f,l,g,p,r;d=0;for(l=a.length;d<l;d++){p=a[d];f=0;for(g=p.length;f<g;f++)r=p[f],e+=(f?"L":"M")+r.x+" "+r.y;e+=c?b.Browser.svg?"z":"x":""}return e||"M0 0"}});b.Browser.svg=!(!g.createElementNS||!b.SVG.create("svg").createSVGRect);b.svg=function(a){return b.Browser.svg||b.Browser.vml?new b.SVG(a):null};b.Browser.vml=!b.Browser.svg&&function(){try{var a=g.createElement("div");a.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var b=a.firstChild;b.style.behavior="url(#default#VML)";return b&&"object"===typeof b.adj}catch(h){return!1}}();b.SVG.include(b.Browser.vml?{_initContainer:function(){this._container=b.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(b.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var c=a._container=b.SVG.create("shape");b.DomUtil.addClass(c,"leaflet-vml-shape "+(this.options.className||""));c.coordsize="1 1";a._path=b.SVG.create("path");c.appendChild(a._path);this._updateStyle(a);this._layers[b.stamp(a)]=a},_addPath:function(a){var b=a._container;this._container.appendChild(b);a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var c=a._container;b.DomUtil.remove(c);a.removeInteractiveTarget(c);delete this._layers[b.stamp(a)]},_updateStyle:function(a){var c=a._stroke,h=a._fill,d=a.options,f=a._container;f.stroked=!!d.stroke;f.filled=!!d.fill;d.stroke?(c||(c=a._stroke=b.SVG.create("stroke")),f.appendChild(c),c.weight=d.weight+"px",c.color=d.color,c.opacity=d.opacity,c.dashStyle=d.dashArray?b.Util.isArray(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):"",c.endcap=d.lineCap.replace("butt","flat"),c.joinstyle=d.lineJoin):c&&(f.removeChild(c),a._stroke=null);d.fill?(h||(h=a._fill=b.SVG.create("fill")),f.appendChild(h),h.color=d.fillColor||d.color,h.opacity=d.fillOpacity):h&&(f.removeChild(h),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),d=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+d+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){b.DomUtil.toFront(a._container)},_bringToBack:function(a){b.DomUtil.toBack(a._container)}}:{});b.Browser.vml&&(b.SVG.create=function(){try{return g.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return g.createElement("\x3clvml:"+a+' class\x3d"lvml"\x3e')}}catch(a){return function(a){return g.createElement("\x3c"+a+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}());b.Canvas=b.Renderer.extend({getEvents:function(){var a=b.Renderer.prototype.getEvents.call(this);a.viewprereset=this._onViewPreReset;return a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){b.Renderer.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=this._container=g.createElement("canvas");b.DomEvent.on(a,"mousemove",b.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this);this._ctx=a.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var b in this._layers)a=this._layers[b],a._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};b.Renderer.prototype._update.call(this);var a=this._bounds,c=this._container,h=a.getSize(),d=b.Browser.retina?2:1;b.DomUtil.setPosition(c,a.min);c.width=d*h.x;c.height=d*h.y;c.style.width=h.x+"px";c.style.height=h.y+"px";b.Browser.retina&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_reset:function(){b.Renderer.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a);this._layers[b.stamp(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var c=a._order,h=c.next,c=c.prev;h?h.prev=c:this._drawLast=c;c?c.next=h:this._drawFirst=h;delete a._order;delete this._layers[b.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var b=a.options.dashArray.split(","),c=[],d;for(d=0;d<b.length;d++)c.push(Number(b[d]));a.options._dashArray=c}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||b.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(a){var c=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new b.Bounds;this._redrawBounds.extend(a._pxBounds.min.subtract([c,c]));this._redrawBounds.extend(a._pxBounds.max.add([c,c]))},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,b=this._redrawBounds;this._ctx.save();b&&(a=b.getSize(),this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,a.x,a.y),this._ctx.clip());this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)a=c.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,e,d,f,l=a._parts,g=l.length,r=this._ctx;if(g){this._drawnLayers[a._leaflet_id]=a;r.beginPath();r.setLineDash&&r.setLineDash(a.options&&a.options._dashArray||[]);for(c=0;c<g;c++){e=0;for(d=l[c].length;e<d;e++)f=l[c][e],r[e?"lineTo":"moveTo"](f.x,f.y);b&&r.closePath()}this._fillStroke(r,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,d=a._radius,f=(a._radiusY||d)/d;this._drawnLayers[a._leaflet_id]=a;1!==f&&(c.save(),c.scale(1,f));c.beginPath();c.arc(b.x,b.y/f,d,0,2*Math.PI,!1);1!==f&&c.restore();this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd"));c.stroke&&0!==c.weight&&(a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,a.stroke())},_onClick:function(a){for(var c=this._map.mouseEventToLayerPoint(a),h,d,f=this._drawFirst;f;f=f.next)h=f.layer,h.options.interactive&&h._containsPoint(c)&&!this._map._draggableMoved(h)&&(d=h);d&&(b.DomEvent._fakeStop(a),this._fireEvent([d],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var c=this._hoveredLayer;c&&(b.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([c],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,c){for(var e,d,f=this._drawFirst;f;f=f.next)e=f.layer,e.options.interactive&&e._containsPoint(c)&&(d=e);d!==this._hoveredLayer&&(this._handleMouseOut(a),d&&(b.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseover"),this._hoveredLayer=d));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:function(a){var b=a._order,c=b.next,d=b.prev;c&&((c.prev=d)?d.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))},_bringToBack:function(a){var b=a._order,c=b.next,d=b.prev;d&&((d.next=c)?c.prev=d:d&&(this._drawLast=d),b.prev=null,b.next=this._drawFirst,this._drawFirst=this._drawFirst.prev=b,this._requestRedraw(a))}});b.Browser.canvas=!!g.createElement("canvas").getContext;b.canvas=function(a){return b.Browser.canvas?new b.Canvas(a):null};b.Polyline.prototype._containsPoint=function(a,c){var e,d,f,l,g,p,r=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;e=0;for(l=this._parts.length;e<l;e++)for(p=this._parts[e],d=0,g=p.length,f=g-1;d<g;f=d++)if((c||0!==d)&&b.LineUtil.pointToSegmentDistance(a,p[f],p[d])<=r)return!0;return!1};b.Polygon.prototype._containsPoint=function(a){var c=!1,d,k,f,l,g,p,r;if(!this._pxBounds.contains(a))return!1;l=0;for(p=this._parts.length;l<p;l++)for(d=this._parts[l],g=0,r=d.length,f=r-1;g<r;f=g++)k=d[g],f=d[f],k.y>a.y!==f.y>a.y&&a.x<(f.x-k.x)*(a.y-k.y)/(f.y-k.y)+k.x&&(c=!c);return c||b.Polyline.prototype._containsPoint.call(this,a,!0)};b.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()};b.GeoJSON=b.FeatureGroup.extend({initialize:function(a,c){b.setOptions(this,c);this._layers={};a&&this.addData(a)},addData:function(a){var c=b.Util.isArray(a)?a:a.features,d,k;if(c){a=0;for(d=c.length;a<d;a++)k=c[a],(k.geometries||k.geometry||k.features||k.coordinates)&&this.addData(k);return this}c=this.options;if(c.filter&&!c.filter(a))return this;d=b.GeoJSON.geometryToLayer(a,c);if(!d)return this;d.feature=b.GeoJSON.asFeature(a);d.defaultOptions=d.options;this.resetStyle(d);if(c.onEachFeature)c.onEachFeature(a,d);return this.addLayer(d)},resetStyle:function(a){a.options=b.Util.extend({},a.defaultOptions);this._setLayerStyle(a,this.options.style);return this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"===typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});b.extend(b.GeoJSON,{geometryToLayer:function(a,c){var e="Feature"===a.type?a.geometry:a,d=e?e.coordinates:null,f=[],l=c&&c.pointToLayer,g=c&&c.coordsToLatLng||this.coordsToLatLng,p,r;if(!d&&!e)return null;switch(e.type){case "Point":return e=g(d),l?l(a,e):new b.Marker(e);case "MultiPoint":p=0;for(r=d.length;p<r;p++)e=g(d[p]),f.push(l?l(a,e):new b.Marker(e));return new b.FeatureGroup(f);case "LineString":case "MultiLineString":return f=this.coordsToLatLngs(d,"LineString"===e.type?0:1,g),new b.Polyline(f,c);case "Polygon":case "MultiPolygon":return f=this.coordsToLatLngs(d,"Polygon"===e.type?1:2,g),new b.Polygon(f,c);case "GeometryCollection":p=0;for(r=e.geometries.length;p<r;p++)(d=this.geometryToLayer({geometry:e.geometries[p],type:"Feature",properties:a.properties},c))&&f.push(d);return new b.FeatureGroup(f);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new b.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){for(var e=[],d=0,h=a.length,f;d<h;d++)f=b?this.coordsToLatLngs(a[d],b-1,c):(c||this.coordsToLatLng)(a[d]),e.push(f);return e},latLngToCoords:function(a){return a.alt!==d?[a.lng,a.lat,a.alt]:[a.lng,a.lat]},latLngsToCoords:function(a,c,d){for(var e=[],h=0,f=a.length;h<f;h++)e.push(c?b.GeoJSON.latLngsToCoords(a[h],c-1,d):b.GeoJSON.latLngToCoords(a[h]));!c&&d&&e.push(e[0]);return e},getFeature:function(a,c){return a.feature?b.extend({},a.feature,{geometry:c}):b.GeoJSON.asFeature(c)},asFeature:function(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}});l={toGeoJSON:function(){return b.GeoJSON.getFeature(this,{type:"Point",coordinates:b.GeoJSON.latLngToCoords(this.getLatLng())})}};b.Marker.include(l);b.Circle.include(l);b.CircleMarker.include(l);b.Polyline.prototype.toGeoJSON=function(){var a=!b.Polyline._flat(this._latlngs),c=b.GeoJSON.latLngsToCoords(this._latlngs,a?1:0);return b.GeoJSON.getFeature(this,{type:(a?"Multi":"")+"LineString",coordinates:c})};b.Polygon.prototype.toGeoJSON=function(){var a=!b.Polyline._flat(this._latlngs),c=a&&!b.Polyline._flat(this._latlngs[0]),d=b.GeoJSON.latLngsToCoords(this._latlngs,c?2:a?1:0,!0);a||(d=[d]);return b.GeoJSON.getFeature(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})};b.LayerGroup.include({toMultiPoint:function(){var a=[];this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)});return b.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===a)return this.toMultiPoint();var c="GeometryCollection"===a,d=[];this.eachLayer(function(a){a.toGeoJSON&&(a=a.toGeoJSON(),d.push(c?a.geometry:b.GeoJSON.asFeature(a)))});return c?b.GeoJSON.getFeature(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}});b.geoJSON=function(a,c){return new b.GeoJSON(a,c)};b.geoJson=b.geoJSON;b.Draggable=b.Evented.extend({options:{clickTolerance:3},statics:{START:b.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b,c){this._element=a;this._dragStartTarget=b||a;this._preventOutline=c},enable:function(){this._enabled||(b.DomEvent.on(this._dragStartTarget,b.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(b.Draggable._dragging===this&&this.finishDrag(),b.DomEvent.off(this._dragStartTarget,b.Draggable.START.join(" "),this._onDown,this),this._moved=this._enabled=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!(b.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||b.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(b.Draggable._dragging=this,this._preventOutline&&b.DomUtil.preventOutline(this._element),b.DomUtil.disableImageDrag(),b.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var c=a.touches?a.touches[0]:a;this._startPoint=new b.Point(c.clientX,c.clientY);b.DomEvent.on(g,b.Draggable.MOVE[a.type],this._onMove,this).on(g,b.Draggable.END[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&1<a.touches.length)this._moved=!0;else{var c=a.touches&&1===a.touches.length?a.touches[0]:a,c=(new b.Point(c.clientX,c.clientY)).subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(b.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=b.DomUtil.getPosition(this._element).subtract(c),b.DomUtil.addClass(g.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,f.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),b.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,b.Util.cancelAnimFrame(this._animRequest),this._lastEvent=a,this._animRequest=b.Util.requestAnimFrame(this._updatePosition,this,!0))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);b.DomUtil.setPosition(this._element,this._newPos);this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){b.DomUtil.removeClass(g.body,"leaflet-dragging");this._lastTarget&&(b.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in b.Draggable.MOVE)b.DomEvent.off(g,b.Draggable.MOVE[a],this._onMove,this).off(g,b.Draggable.END[a],this._onUp,this);b.DomUtil.enableImageDrag();b.DomUtil.enableTextSelection();this._moved&&this._moving&&(b.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;b.Draggable._dragging=!1}});b.Handler=b.Class.extend({initialize:function(a){this._map=a},enable:function(){if(this._enabled)return this;this._enabled=!0;this.addHooks();return this},disable:function(){if(!this._enabled)return this;this._enabled=!1;this.removeHooks();return this},enabled:function(){return!!this._enabled}});b.Map.mergeOptions({dragging:!0,inertia:!b.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});b.Map.Drag=b.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new b.Draggable(a._mapPane,a._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}b.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){b.DomUtil.removeClass(this._map._container,"leaflet-grab");b.DomUtil.removeClass(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=b.latLngBounds(this._map.options.maxBounds);this._offsetLimit=b.bounds(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c);this._times.push(b);50<b-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x));a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y));a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x));a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y));this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,f=(d-b+c)%a+b-c,a=(d+b+c)%a-b-c,c=Math.abs(f+c)<Math.abs(a+c)?f:a;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=c},_onDragEnd:function(a){var c=this._map,d=c.options,f=!d.inertia||2>this._times.length;c.fire("dragend",a);if(f)c.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var l=d.easeLinearity,f=a.multiplyBy(l/((this._lastTime-this._times[0])/1E3)),g=f.distanceTo([0,0]);a=Math.min(d.inertiaMaxSpeed,g);var f=f.multiplyBy(a/g),t=a/(d.inertiaDeceleration*l),p=f.multiplyBy(-t/2).round();p.x||p.y?(p=c._limitOffset(p,c.options.maxBounds),b.Util.requestAnimFrame(function(){c.panBy(p,{duration:t,easeLinearity:l,noMoveStart:!0,animate:!0})})):c.fire("moveend")}}});b.Map.addInitHook("addHandler","dragging",b.Map.Drag);b.Map.mergeOptions({doubleClickZoom:!0});b.Map.DoubleClickZoom=b.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),d=b.options.zoomDelta,c=a.originalEvent.shiftKey?c-d:c+d;"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,c)}});b.Map.addInitHook("addHandler","doubleClickZoom",b.Map.DoubleClickZoom);b.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});b.Map.ScrollWheelZoom=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){b.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var c=b.DomEvent.getWheelDelta(a),d=this._map.options.wheelDebounceTime;this._delta+=c;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);c=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(b.bind(this._performZoom,this),c);b.DomEvent.stop(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var d=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,c=c?Math.ceil(d/c)*c:d,c=a._limitZoom(b+(0<this._delta?c:-c))-b;this._delta=0;this._startTime=null;c&&("center"===a.options.scrollWheelZoom?a.setZoom(b+c):a.setZoomAround(this._lastMousePos,b+c))}});b.Map.addInitHook("addHandler","scrollWheelZoom",b.Map.ScrollWheelZoom);b.extend(b.DomEvent,{_touchstart:b.Browser.msPointer?"MSPointerDown":b.Browser.pointer?"pointerdown":"touchstart",_touchend:b.Browser.msPointer?"MSPointerUp":b.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,c,d){function e(a){var c;if(b.Browser.pointer){if(!b.Browser.edge||"mouse"===a.pointerType)return;c=b.DomEvent._pointersCount}else c=a.touches.length;if(!(1<c)){c=Date.now();var e=c-(f||c);l=a.touches?a.touches[0]:a;g=0<e&&250>=e;f=c}}function h(a){if(g&&!l.cancelBubble){if(b.Browser.pointer){if(!b.Browser.edge||"mouse"===a.pointerType)return;a={};var e,d;for(d in l)e=l[d],a[d]=e&&e.bind?e.bind(l):e;l=a}l.type="dblclick";c(l);f=null}}var f,l,g=!1,r=this._touchstart,q=this._touchend;a["_leaflet_"+r+d]=e;a["_leaflet_"+q+d]=h;a["_leaflet_dblclick"+d]=c;a.addEventListener(r,e,!1);a.addEventListener(q,h,!1);a.addEventListener("dblclick",c,!1);return this},removeDoubleTapListener:function(a,c){var e=a["_leaflet_"+this._touchend+c],d=a["_leaflet_dblclick"+c];a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+c],!1);a.removeEventListener(this._touchend,e,!1);b.Browser.edge||a.removeEventListener("dblclick",d,!1);return this}});b.extend(b.DomEvent,{POINTER_DOWN:b.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:b.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:b.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:b.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,b,c,d){"touchstart"===b?this._addPointerStart(a,c,d):"touchmove"===b?this._addPointerMove(a,c,d):"touchend"===b&&this._addPointerEnd(a,c,d);return this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];"touchstart"===b?a.removeEventListener(this.POINTER_DOWN,c,!1):"touchmove"===b?a.removeEventListener(this.POINTER_MOVE,c,!1):"touchend"===b&&(a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1));return this},_addPointerStart:function(a,c,d){var e=b.bind(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE)if(0>this.TAG_WHITE_LIST.indexOf(a.target.tagName))b.DomEvent.preventDefault(a);else return;this._handlePointer(a,c)},this);a["_leaflet_touchstart"+d]=e;a.addEventListener(this.POINTER_DOWN,e,!1);this._pointerDocListener||(a=b.bind(this._globalPointerUp,this),g.documentElement.addEventListener(this.POINTER_DOWN,b.bind(this._globalPointerDown,this),!0),g.documentElement.addEventListener(this.POINTER_MOVE,b.bind(this._globalPointerMove,this),!0),g.documentElement.addEventListener(this.POINTER_UP,a,!0),g.documentElement.addEventListener(this.POINTER_CANCEL,a,!0),this._pointerDocListener=!0)},_globalPointerDown:function(a){this._pointers[a.pointerId]=a;this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId];this._pointersCount--},_handlePointer:function(a,b){a.touches=[];for(var c in this._pointers)a.touches.push(this._pointers[c]);a.changedTouches=[a];b(a)},_addPointerMove:function(a,c,d){var e=b.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,c)},this);a["_leaflet_touchmove"+d]=e;a.addEventListener(this.POINTER_MOVE,e,!1)},_addPointerEnd:function(a,c,d){var e=b.bind(function(a){this._handlePointer(a,c)},this);a["_leaflet_touchend"+d]=e;a.addEventListener(this.POINTER_UP,e,!1);a.addEventListener(this.POINTER_CANCEL,e,!1)}});b.Map.mergeOptions({touchZoom:b.Browser.touch&&!b.Browser.android23,bounceAtZoomLimits:!0});b.Map.TouchZoom=b.Handler.extend({addHooks:function(){b.DomUtil.addClass(this._map._container,"leaflet-touch-zoom");b.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){b.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom");b.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===a.touches.length&&!c._animatingZoom&&!this._zooming){var d=c.mouseEventToContainerPoint(a.touches[0]),f=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2);this._startLatLng=c.containerPointToLatLng(this._centerPoint);"center"!==c.options.touchZoom&&(this._pinchStartLatLng=c.containerPointToLatLng(d.add(f)._divideBy(2)));this._startDist=d.distanceTo(f);this._startZoom=c.getZoom();this._moved=!1;this._zooming=!0;c._stop();b.DomEvent.on(g,"touchmove",this._onTouchMove,this).on(g,"touchend",this._onTouchEnd,this);b.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var c=this._map,d=c.mouseEventToContainerPoint(a.touches[0]),f=c.mouseEventToContainerPoint(a.touches[1]),l=d.distanceTo(f)/this._startDist;this._zoom=c.getScaleZoom(l,this._startZoom);!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&1>l||this._zoom>c.getMaxZoom()&&1<l)&&(this._zoom=c._limitZoom(this._zoom));if("center"===c.options.touchZoom){if(this._center=this._startLatLng,1===l)return}else{d=d._add(f)._divideBy(2)._subtract(this._centerPoint);if(1===l&&0===d.x&&0===d.y)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(d),this._zoom)}this._moved||(c._moveStart(!0),this._moved=!0);b.Util.cancelAnimFrame(this._animRequest);c=b.bind(c._move,c,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=b.Util.requestAnimFrame(c,this,!0);b.DomEvent.preventDefault(a)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,b.Util.cancelAnimFrame(this._animRequest),b.DomEvent.off(g,"touchmove",this._onTouchMove).off(g,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});b.Map.addInitHook("addHandler","touchZoom",b.Map.TouchZoom);b.Map.mergeOptions({tap:!0,tapTolerance:15});b.Map.Tap=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){b.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(b.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var c=a.touches[0];a=c.target;this._startPos=this._newPos=new b.Point(c.clientX,c.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&b.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(b.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1E3);this._simulateEvent("mousedown",c);b.DomEvent.on(g,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){clearTimeout(this._holdTimeout);b.DomEvent.off(g,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var c=a.target;c&&c.tagName&&"a"===c.tagName.toLowerCase()&&b.DomUtil.removeClass(c,"leaflet-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new b.Point(a.clientX,a.clientY);this._simulateEvent("mousemove",a)},_simulateEvent:function(a,b){var c=g.createEvent("MouseEvents");c._simulated=!0;b.target._simulatedClick=!0;c.initMouseEvent(a,!0,!0,f,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(c)}});b.Browser.touch&&!b.Browser.pointer&&b.Map.addInitHook("addHandler","tap",b.Map.Tap);b.Map.mergeOptions({boxZoom:!0});b.Map.BoxZoom=b.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane},addHooks:function(){b.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){b.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._resetState();b.DomUtil.disableTextSelection();b.DomUtil.disableImageDrag();this._startPoint=this._map.mouseEventToContainerPoint(a);b.DomEvent.on(g,{contextmenu:b.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=b.DomUtil.create("div","leaflet-zoom-box",this._container),b.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);a=new b.Bounds(this._point,this._startPoint);var c=a.getSize();b.DomUtil.setPosition(this._box,a.min);this._box.style.width=c.x+"px";this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(b.DomUtil.remove(this._box),b.DomUtil.removeClass(this._container,"leaflet-crosshair"));b.DomUtil.enableTextSelection();b.DomUtil.enableImageDrag();b.DomEvent.off(g,{contextmenu:b.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(1===a.which||1===a.button)this._finish(),this._moved&&(setTimeout(b.bind(this._resetState,this),0),a=new b.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});b.Map.addInitHook("addHandler","boxZoom",b.Map.BoxZoom);b.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80});b.Map.Keyboard=b.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");b.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();b.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=g.body,b=g.documentElement,c=a.scrollTop||b.scrollTop,a=a.scrollLeft||b.scrollLeft;this._map._container.focus();f.scrollTo(a,c)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var b=this._panKeys={},c=this.keyCodes,d,f;d=0;for(f=c.left.length;d<f;d++)b[c.left[d]]=[-1*a,0];d=0;for(f=c.right.length;d<f;d++)b[c.right[d]]=[a,0];d=0;for(f=c.down.length;d<f;d++)b[c.down[d]]=[0,a];d=0;for(f=c.up.length;d<f;d++)b[c.up[d]]=[0,-1*a]},_setZoomDelta:function(a){var b=this._zoomKeys={},c=this.keyCodes,d,f;d=0;for(f=c.zoomIn.length;d<f;d++)b[c.zoomIn[d]]=a;d=0;for(f=c.zoomOut.length;d<f;d++)b[c.zoomOut[d]]=-a},_addHooks:function(){b.DomEvent.on(g,"keydown",this._onKeyDown,this)},_removeHooks:function(){b.DomEvent.off(g,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var c=a.keyCode,d=this._map;if(c in this._panKeys){if(d._panAnim&&d._panAnim._inProgress)return;c=this._panKeys[c];a.shiftKey&&(c=b.point(c).multiplyBy(3));d.panBy(c);d.options.maxBounds&&d.panInsideBounds(d.options.maxBounds)}else if(c in this._zoomKeys)d.setZoom(d.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else if(27===c)d.closePopup();else return;b.DomEvent.stop(a)}}});b.Map.addInitHook("addHandler","keyboard",b.Map.Keyboard);b.Handler.MarkerDrag=b.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new b.Draggable(a,a,!0));this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();b.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&b.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var c=this._marker,d=c._shadow,f=b.DomUtil.getPosition(c._icon),l=c._map.layerPointToLatLng(f);d&&b.DomUtil.setPosition(d,f);c._latlng=l;a.latlng=l;a.oldLatLng=this._oldLatLng;c.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}});b.Control=b.Class.extend({options:{position:"topright"},initialize:function(a){b.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;b&&b.removeControl(this);this.options.position=a;b&&b.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var c=this._container=this.onAdd(a),d=this.getPosition();a=a._controlCorners[d];b.DomUtil.addClass(c,"leaflet-control");-1!==d.indexOf("bottom")?a.insertBefore(c,a.firstChild):a.appendChild(c);return this},remove:function(){if(!this._map)return this;b.DomUtil.remove(this._container);if(this.onRemove)this.onRemove(this._map);this._map=null;return this},_refocusOnMap:function(a){this._map&&a&&0<a.screenX&&0<a.screenY&&this._map.getContainer().focus()}});b.control=function(a){return new b.Control(a)};b.Map.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.remove();return this},_initControlPos:function(){function a(a,e){c[a+e]=b.DomUtil.create("div","leaflet-"+a+" leaflet-"+e,d)}var c=this._controlCorners={},d=this._controlContainer=b.DomUtil.create("div","leaflet-control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){b.DomUtil.remove(this._controlContainer)}});b.Control.Zoom=b.Control.extend({options:{position:"topright",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var c=b.DomUtil.create("div","leaflet-control-zoom leaflet-bar"),d=this.options;this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,"leaflet-control-zoom-in",c,this._zoomIn);this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,"leaflet-control-zoom-out",c,this._zoomOut);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){this._disabled=!0;this._updateDisabled();return this},enable:function(){this._disabled=!1;this._updateDisabled();return this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,c,d,f,l){d=b.DomUtil.create("a",d,f);d.innerHTML=a;d.href="#";d.title=c;d.setAttribute("role","button");d.setAttribute("aria-label",c);b.DomEvent.on(d,"mousedown dblclick",b.DomEvent.stopPropagation).on(d,"click",b.DomEvent.stop).on(d,"click",l,this).on(d,"click",this._refocusOnMap,this);return d},_updateDisabled:function(){var a=this._map;b.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");b.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMinZoom())&&b.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&b.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});b.Map.mergeOptions({zoomControl:!0});b.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new b.Control.Zoom,this.addControl(this.zoomControl))});b.control.zoom=function(a){return new b.Control.Zoom(a)};b.Control.Attribution=b.Control.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(a){b.setOptions(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=b.DomUtil.create("div","leaflet-control-attribution");b.DomEvent&&b.DomEvent.disableClickPropagation(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());this._update();return this._container},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(!a)return this;this._attributions[a]||(this._attributions[a]=0);this._attributions[a]++;this._update();return this},removeAttribution:function(a){if(!a)return this;this._attributions[a]&&(this._attributions[a]--,this._update());return this},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}}});b.Map.mergeOptions({attributionControl:!1});b.Map.addInitHook(function(){this.options.attributionControl&&(new b.Control.Attribution).addTo(this)});b.control.attribution=function(a){return new b.Control.Attribution(a)};b.Control.Scale=b.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var c=b.DomUtil.create("div","leaflet-control-scale"),d=this.options;this._addScales(d,"leaflet-control-scale-line",c);a.on(d.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,c,d){a.metric&&(this._mScale=b.DomUtil.create("div",c,d));a.imperial&&(this._iScale=b.DomUtil.create("div",c,d))},_update:function(){var a=this._map,b=a.getSize().y/2,a=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(a)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a);this._updateScale(this._mScale,1E3>b?b+" m":b/1E3+" km",b/a)},_updateImperial:function(a){a*=3.2808399;var b;5280<a?(a/=5280,b=this._getRoundNum(a),this._updateScale(this._iScale,b+" mi",b/a)):(b=this._getRoundNum(a),this._updateScale(this._iScale,b+" ft",b/a))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px";a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return b*(10<=a?10:5<=a?5:3<=a?3:2<=a?2:1)}});b.control.scale=function(a){return new b.Control.Scale(a)};b.Control.Layers=b.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,b,c,d){return c<d?-1:d<c?1:0}},initialize:function(a,c,d){b.setOptions(this,d);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var e in a)this._addLayer(a[e],e);for(e in c)this._addLayer(c[e],e,!0)},onAdd:function(a){this._initLayout();this._update();this._map=a;a.on("zoomend",this._checkDisabledLayers,this);return this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){this._addLayer(a,b);return this._map?this._update():this},addOverlay:function(a,b){this._addLayer(a,b,!0);return this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);(a=this._getLayer(b.stamp(a)))&&this._layers.splice(this._layers.indexOf(a),1);return this._map?this._update():this},expand:function(){b.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);a<this._form.clientHeight?(b.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):b.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar");this._checkDisabledLayers();return this},collapse:function(){b.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded");return this},_initLayout:function(){var a=this._container=b.DomUtil.create("div","leaflet-control-layers"),c=this.options.collapsed;a.setAttribute("aria-haspopup",!0);b.DomEvent.disableClickPropagation(a);b.Browser.touch||b.DomEvent.disableScrollPropagation(a);var d=this._form=b.DomUtil.create("form","leaflet-control-layers-list");if(c&&(this._map.on("click",this.collapse,this),!b.Browser.android))b.DomEvent.on(a,{mouseenter:this.expand,mouseleave:this.collapse},this);var f=this._layersLink=b.DomUtil.create("a","leaflet-control-layers-toggle",a);f.href="#";f.title="Layers";if(b.Browser.touch)b.DomEvent.on(f,"click",b.DomEvent.stop).on(f,"click",this.expand,this);else b.DomEvent.on(f,"focus",this.expand,this);b.DomEvent.on(d,"click",function(){setTimeout(b.bind(this._onInputClick,this),0)},this);c||this.expand();this._baseLayersList=b.DomUtil.create("div","leaflet-control-layers-base",d);this._separator=b.DomUtil.create("div","leaflet-control-layers-separator",d);this._overlaysList=b.DomUtil.create("div","leaflet-control-layers-overlays",d);a.appendChild(d)},_getLayer:function(a){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&b.stamp(this._layers[c].layer)===a)return this._layers[c]},_addLayer:function(a,c,d){a.on("add remove",this._onLayerChange,this);this._layers.push({layer:a,name:c,overlay:d});this.options.sortLayers&&this._layers.sort(b.bind(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)},this));this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;b.DomUtil.empty(this._baseLayersList);b.DomUtil.empty(this._overlaysList);var a,c,d,f,l=0;for(d=0;d<this._layers.length;d++)f=this._layers[d],this._addItem(f),c=c||f.overlay,a=a||!f.overlay,l+=f.overlay?0:1;this.options.hideSingleBase&&(a=a&&1<l,this._baseLayersList.style.display=a?"":"none");this._separator.style.display=c&&a?"":"none";return this},_onLayerChange:function(a){this._handlingClick||this._update();var c=this._getLayer(b.stamp(a.target));(a=c.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null)&&this._map.fire(a,c)},_createRadioElement:function(a,b){var c='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+a+'"'+(b?' checked\x3d"checked"':"")+"/\x3e",e=g.createElement("div");e.innerHTML=c;return e.firstChild},_addItem:function(a){var c=g.createElement("label"),d=this._map.hasLayer(a.layer),f;a.overlay?(f=g.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=d):f=this._createRadioElement("leaflet-base-layers",d);f.layerId=b.stamp(a.layer);b.DomEvent.on(f,"click",this._onInputClick,this);d=g.createElement("span");d.innerHTML=" "+a.name;var l=g.createElement("div");c.appendChild(l);l.appendChild(f);l.appendChild(d);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(c);this._checkDisabledLayers();return c},_onInputClick:function(){var a=this._form.getElementsByTagName("input"),b,c,d,f=[],l=[];this._handlingClick=!0;for(var g=a.length-1;0<=g;g--)b=a[g],c=this._getLayer(b.layerId).layer,d=this._map.hasLayer(c),b.checked&&!d?f.push(c):!b.checked&&d&&l.push(c);for(g=0;g<l.length;g++)this._map.removeLayer(l[g]);for(g=0;g<f.length;g++)this._map.addLayer(f[g]);this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var a=this._form.getElementsByTagName("input"),b,c,f=this._map.getZoom(),l=a.length-1;0<=l;l--)b=a[l],c=this._getLayer(b.layerId).layer,b.disabled=c.options.minZoom!==d&&f<c.options.minZoom||c.options.maxZoom!==d&&f>c.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}});b.control.layers=function(a,c,d){return new b.Control.Layers(a,c,d)}})(window,document);(function(f){var g,d;if("function"===typeof define&&define.amd)define(["leaflet","proj4"],f);else if("object"===typeof module&&"object"===typeof module.exports)g=require("leaflet"),d=require("proj4"),module.exports=f(g,d);else{if("undefined"===typeof window.L||"undefined"===typeof window.proj4)throw"Leaflet and proj4 must be loaded first";f(window.L,window.proj4)}})(function(f,g){f.Proj={};f.Proj._isProj4Obj=function(d){return"undefined"!==typeof d.inverse&&"undefined"!==typeof d.forward};f.Proj.Projection=f.Class.extend({initialize:function(d,c,b){var l=f.Proj._isProj4Obj(d);this._proj=l?d:this._projFromCodeDef(d,c);this.bounds=l?c:b},project:function(d){d=this._proj.forward([d.lng,d.lat]);return new f.Point(d[0],d[1])},unproject:function(d,c){var b=this._proj.inverse([d.x,d.y]);return new f.LatLng(b[1],b[0],c)},_projFromCodeDef:function(d,c){if(c)g.defs(d,c);else if(void 0===g.defs[d]){var b=d.split(":");3<b.length&&(d=b[b.length-3]+":"+b[b.length-1]);if(void 0===g.defs[d])throw"No projection definition for code "+d;}return g(d)}});f.Proj.CRS=f.Class.extend({includes:f.CRS,options:{transformation:new f.Transformation(1,0,-1,0)},initialize:function(d,c,b){var l;f.Proj._isProj4Obj(d)?(l=d.srsCode,b=c||{},this.projection=new f.Proj.Projection(d,b.bounds)):(l=d,b=b||{},this.projection=new f.Proj.Projection(l,c,b.bounds));f.Util.setOptions(this,b);this.code=l;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new f.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions)for(this._scales=[],d=this.options.resolutions.length-1;0<=d;d--)this.options.resolutions[d]&&(this._scales[d]=1/this.options.resolutions[d]);this.infinite=!this.options.bounds},scale:function(d){var c=Math.floor(d),b;if(d===c)return this._scales[d];b=this._scales[c];return b+(this._scales[c+1]-b)*(d-c)},zoom:function(d){var c=this._closestElement(this._scales,d),b=this._scales.indexOf(c),f;if(d===c)return b;f=this._scales[b+1];return void 0===f?Infinity:(d-c)/(f-c)+b},distance:f.CRS.Earth.distance,R:f.CRS.Earth.R,_closestElement:function(d,c){for(var b,f=d.length;f--;)d[f]<=c&&(void 0===b||b<d[f])&&(b=d[f]);return b}});f.Proj.GeoJSON=f.GeoJSON.extend({initialize:function(d,c){this._callLevel=0;f.GeoJSON.prototype.initialize.call(this,d,c)},addData:function(d){var c;d&&(d.crs&&"name"===d.crs.type?c=new f.Proj.CRS(d.crs.properties.name):d.crs&&d.crs.type&&(c=new f.Proj.CRS(d.crs.type+":"+d.crs.properties.code)),void 0!==c&&(this.options.coordsToLatLng=function(b){b=f.point(b[0],b[1]);return c.projection.unproject(b)}));this._callLevel++;try{f.GeoJSON.prototype.addData.call(this,d)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});f.Proj.geoJson=function(d,c){return new f.Proj.GeoJSON(d,c)};f.Proj.ImageOverlay=f.ImageOverlay.extend({initialize:function(d,c,b){f.ImageOverlay.prototype.initialize.call(this,d,null,b);this._projectedBounds=c},_animateZoom:function(d){var c=this._map.getZoomScale(d.zoom),b=f.point(this._projectedBounds.min.x,this._projectedBounds.max.y);d=this._projectedToNewLayerPoint(b,d.zoom,d.center);f.DomUtil.setTransform(this._image,d,c)},_reset:function(){var d=this._map.getZoom(),c=this._map.getPixelOrigin(),d=f.bounds(this._transform(this._projectedBounds.min,d)._subtract(c),this._transform(this._projectedBounds.max,d)._subtract(c)),c=d.getSize();f.DomUtil.setPosition(this._image,d.min);this._image.style.width=c.x+"px";this._image.style.height=c.y+"px"},_projectedToNewLayerPoint:function(d,c,b){var f=this._map.getSize()._divideBy(2);b=this._map.project(b,c)._subtract(f)._round().add(this._map._getMapPanePos());return this._transform(d,c)._subtract(b)},_transform:function(d,c){var b=this._map.options.crs,f=b.transformation,b=b.scale(c);return f.transform(d,b)}});f.Proj.imageOverlay=function(d,c,b){return new f.Proj.ImageOverlay(d,c,b)};return f.Proj});(function(f,g){"object"===typeof exports&&"undefined"!==typeof module?g(exports,require("leaflet")):"function"===typeof define&&define.amd?define(["exports","leaflet"],g):g((f.L=f.L||{},f.L.esri=f.L.esri||{}),f.L)})(this,function(f,g){function d(a){var b="";a.f=a.f||"json";for(var c in a)if(a.hasOwnProperty(c)){var e=a[c],d=Object.prototype.toString.call(e);b.length&&(b+="\x26");e="[object Array]"===d?"[object Object]"===Object.prototype.toString.call(e[0])?JSON.stringify(e):e.join(","):"[object Object]"===d?JSON.stringify(e):"[object Date]"===d?e.valueOf():e;b+=encodeURIComponent(c)+"\x3d"+encodeURIComponent(e)}return b}function c(a,b){var c=new window.XMLHttpRequest;c.onerror=function(e){c.onreadystatechange=g.Util.falseFn;a.call(b,{error:{code:500,message:"XMLHttpRequest error"}},null)};c.onreadystatechange=function(){var e,d;if(4===c.readyState){try{e=JSON.parse(c.responseText)}catch(oa){e=null,d={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!d&&e.error&&(d=e.error,e=null);c.onerror=g.Util.falseFn;a.call(b,d,e)}};c.ontimeout=function(){this.onerror()};return c}function b(a,b,e,f){e=c(e,f);e.open("POST",a);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(e.timeout=f.options.timeout);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.send(d(b));return e}function l(a,b,e,f){e=c(e,f);e.open("GET",a+"?"+d(b),!0);"undefined"!==typeof f&&null!==f&&"undefined"!==typeof f.options&&(e.timeout=f.options.timeout);e.send(null);return e}function a(a,b,f,h){var k=d(b),l=c(f,h),g=(a+"?"+k).length;2E3>=g&&aa.cors?l.open("GET",a+"?"+k):2E3<g&&aa.cors&&(l.open("POST",a),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));"undefined"!==typeof h&&null!==h&&"undefined"!==typeof h.options&&(l.timeout=h.options.timeout);if(2E3>=g&&aa.cors)l.send(null);else if(2E3<g&&aa.cors)l.send(k);else{if(2E3>=g&&!aa.cors)return e(a,b,f,h);H("a request to "+a+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return l}function e(a,b,c,e){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var f="c"+ua;b.callback="window._EsriLeafletCallbacks."+f;window._EsriLeafletCallbacks[f]=function(a){if(!0!==window._EsriLeafletCallbacks[f]){var b,d=Object.prototype.toString.call(a);"[object Object]"!==d&&"[object Array]"!==d&&(b={error:{code:500,message:"Expected array or object as JSONP response"}},a=null);!b&&a.error&&(b=a,a=null);c.call(e,b,a);window._EsriLeafletCallbacks[f]=!0}};var h=g.DomUtil.create("script",null,document.body);h.type="text/javascript";h.src=a+"?"+d(b);h.id=f;ua++;return{id:f,url:h.src,abort:function(){window._EsriLeafletCallbacks._callback[f]({code:0,message:"Request aborted."})}}}function h(a){var b;a:{b=a[0];for(var c=0;c<b.length;c++)if(b[c]!==a[a.length-1][c]){b=!1;break a}b=!0}b||a.push(a[0]);return a}function k(a){var b=0,c=0,e=a.length,d=a[c],f;for(c;c<e-1;c++)f=a[c+1],b+=(f[0]-d[0])*(f[1]+d[1]),d=f;return 0<=b}function n(a,b){for(var c=0;c<a.length-1;c++)for(var e=0;e<b.length-1;e++){var d;a:{var f=a[c],h=a[c+1],k=b[e],l=b[e+1],g=(l[0]-k[0])*(f[1]-k[1])-(l[1]-k[1])*(f[0]-k[0]);d=(h[0]-f[0])*(f[1]-k[1])-(h[1]-f[1])*(f[0]-k[0]);f=(l[1]-k[1])*(h[0]-f[0])-(l[0]-k[0])*(h[1]-f[1]);if(0!==f&&(g/=f,d/=f,0<=g&&1>=g&&0<=d&&1>=d)){d=!0;break a}d=!1}if(d)return!0}return!1}function m(a){var b=[];a=a.slice(0);var c=h(a.shift().slice(0));if(4<=c.length)for(k(c)||c.reverse(),b.push(c),c=0;c<a.length;c++){var e=h(a[c].slice(0));4<=e.length&&(k(e)&&e.reverse(),b.push(e))}return b}function t(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function p(a,b){var c={};"number"===typeof a.x&&"number"===typeof a.y&&(c.type="Point",c.coordinates=[a.x,a.y]);a.points&&(c.type="MultiPoint",c.coordinates=a.points.slice(0));a.paths&&(1===a.paths.length?(c.type="LineString",c.coordinates=a.paths[0].slice(0)):(c.type="MultiLineString",c.coordinates=a.paths.slice(0)));if(a.rings){var e=a.rings.slice(0),c=[],d=[],f,l;for(l=0;l<e.length;l++){var g=h(e[l].slice(0));4>g.length||(k(g)?c.push([g]):d.push(g))}for(g=[];d.length;){l=d.pop();for(var S=!1,e=c.length-1;0<=e;e--){var B=f=c[e][0],m=l;f=n(B,m);for(var m=m[0],fa=!1,Q=-1,pa=B.length,r=pa-1;++Q<pa;r=Q)(B[Q][1]<=m[1]&&m[1]<B[r][1]||B[r][1]<=m[1]&&m[1]<B[Q][1])&&m[0]<(B[r][0]-B[Q][0])*(m[1]-B[Q][1])/(B[r][1]-B[Q][1])+B[Q][0]&&(fa=!fa);B=fa;if(!f&&B){c[e].push(l);S=!0;break}}S||g.push(l)}for(;g.length;){l=g.pop();d=!1;for(e=c.length-1;0<=e;e--)if(f=c[e][0],n(f,l)){c[e].push(l);d=!0;break}d||c.push([l.reverse()])}c=1===c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}if(a.geometry||a.attributes)c.type="Feature",c.geometry=a.geometry?p(a.geometry):null,c.properties=a.attributes?t(a.attributes):null,a.attributes&&(c.id=a.attributes[b]||a.attributes.OBJECTID||a.attributes.FID);return c}function r(a,b){b=b||"OBJECTID";var c={wkid:4326},e={};switch(a.type){case "Point":e.x=a.coordinates[0];e.y=a.coordinates[1];e.spatialReference=c;break;case "MultiPoint":e.points=a.coordinates.slice(0);e.spatialReference=c;break;case "LineString":e.paths=[a.coordinates.slice(0)];e.spatialReference=c;break;case "MultiLineString":e.paths=a.coordinates.slice(0);e.spatialReference=c;break;case "Polygon":e.rings=m(a.coordinates.slice(0));e.spatialReference=c;break;case "MultiPolygon":for(var d=e,f=a.coordinates.slice(0),h=[],k=0;k<f.length;k++)for(var l=m(f[k]),g=l.length-1;0<=g;g--){var S=l[g].slice(0);h.push(S)}d.rings=h;e.spatialReference=c;break;case "Feature":a.geometry&&(e.geometry=r(a.geometry,b));e.attributes=a.properties?t(a.properties):{};a.id&&(e.attributes[b]=a.id);break;case "FeatureCollection":e=[];for(c=0;c<a.features.length;c++)e.push(r(a.features[c],b));break;case "GeometryCollection":for(e=[],c=0;c<a.geometries.length;c++)e.push(r(a.geometries[c],b))}return e}function q(a){if("NaN"!==a.xmin&&"NaN"!==a.ymin&&"NaN"!==a.xmax&&"NaN"!==a.ymax){var b=g.latLng(a.ymin,a.xmin);a=g.latLng(a.ymax,a.xmax);return g.latLngBounds(b,a)}return null}function x(a){a=g.latLngBounds(a);return{xmin:a.getSouthWest().lng,ymin:a.getSouthWest().lat,xmax:a.getNorthEast().lng,ymax:a.getNorthEast().lat,spatialReference:{wkid:4326}}}function A(a,b){var c,e=a.features||a.results,d=e.length;if(b)c=b;else if(a.objectIdFieldName)c=a.objectIdFieldName;else if(a.fields)for(var f=0;f<=a.fields.length-1;f++){if("esriFieldTypeOID"===a.fields[f].type){c=a.fields[f].name;break}}else if(d)for(f in e[0].attributes)if(f.match(/^(OBJECTID|FID|OID|ID)$/i)){c=f;break}f={type:"FeatureCollection",features:[]};if(d)for(d=e.length-1;0<=d;d--){var h=p(e[d],c);f.features.push(h)}return f}function F(a){a=g.Util.trim(a);"/"!==a[a.length-1]&&(a+="/");return a}function D(a){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(a)}function E(a){var b;switch(a){case "Point":b="esriGeometryPoint";break;case "MultiPoint":b="esriGeometryMultipoint";break;case "LineString":b="esriGeometryPolyline";break;case "MultiLineString":b="esriGeometryPolyline";break;case "Polygon":b="esriGeometryPolygon";break;case "MultiPolygon":b="esriGeometryPolygon"}return b}function H(){console&&console.warn&&console.warn.apply(console,arguments)}function U(a){return a.getSize().x-Q.attributionWidthOffset+"px"}function u(a){if(a.attributionControl&&!a.attributionControl._esriAttributionAdded){a.attributionControl.setPrefix('\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e | Powered by \x3ca href\x3d"https://www.esri.com"\x3eEsri\x3c/a\x3e');var b=document.createElement("style");b.type="text/css";b.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}";document.getElementsByTagName("head")[0].appendChild(b);g.DomUtil.addClass(a.attributionControl._container,"esri-truncated-attribution:hover");b=document.createElement("style");b.type="text/css";b.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+U(a)+";}";document.getElementsByTagName("head")[0].appendChild(b);g.DomUtil.addClass(a.attributionControl._container,"esri-truncated-attribution");a.on("resize",function(b){a.attributionControl._container.style.maxWidth=U(b.target)});a.attributionControl._esriAttributionAdded=!0}}function I(a,b){e(a,{},g.Util.bind(function(a,c){if(!a){b._esriAttributions=[];for(var e=0;e<c.contributors.length;e++)for(var d=c.contributors[e],f=0;f<d.coverageAreas.length;f++){var h=d.coverageAreas[f],k=g.latLng(h.bbox[0],h.bbox[1]),l=g.latLng(h.bbox[2],h.bbox[3]);b._esriAttributions.push({attribution:d.attribution,score:h.score,bounds:g.latLngBounds(k,l),minZoom:h.zoomMin,maxZoom:h.zoomMax})}b._esriAttributions.sort(function(a,b){return b.score-a.score});N({target:b})}},this))}function N(a){a=a.target;var b=a._esriAttributions;if(a&&a.attributionControl&&b){for(var c="",e=a.getBounds(),e=g.latLngBounds(e.getSouthWest().wrap(),e.getNorthEast().wrap()),d=a.getZoom(),f=0;f<b.length;f++){var h=b[f],k=h.attribution;!c.match(k)&&h.bounds.intersects(e)&&d>=h.minZoom&&d<=h.maxZoom&&(c+=", "+k)}c=c.substr(2);b=a.attributionControl._container.querySelector(".esri-dynamic-attribution");b.innerHTML=c;b.style.maxWidth=U(a);a.fire("attributionupdated",{attribution:c})}}function G(a){return new w(a)}function z(a){return new R(a)}function v(a){return new Ca(a)}function O(a){return new qa(a)}function V(a){return new Da(a)}function ba(a){return new sa(a)}function Y(a){return new Aa(a)}function T(a){this.values=[].concat(a||[])}var M="default"in g?g["default"]:g,C=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Z=""===document.documentElement.style.pointerEvents,aa={cors:C,pointerEvents:Z},Q={attributionWidthOffset:55},ua=0,la=aa.cors?l:e;la.CORS=l;la.JSONP=e;var da={request:a,get:la,post:b},ta={shallowClone:function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},warn:H,cleanUrl:F,isArcgisOnline:D,geojsonTypeToArcGIS:E,responseToFeatureCollection:A,geojsonToArcGIS:function(a,b){return r(a,b)},arcgisToGeoJSON:function(a,b){return p(a,b)},boundsToExtent:x,extentToBounds:q,calcAttributionWidth:U,setEsriAttribution:u,_getAttributionData:I,_updateMapAttribution:N},W=g.Class.extend({options:{proxy:!1,useCors:C},generateSetter:function(a,b){return g.Util.bind(function(b){this.params[a]=b;return this},b)},initialize:function(a){a.request&&a.options?(this._service=a,g.Util.setOptions(this,a.options)):(g.Util.setOptions(this,a),this.options.url=F(a.url));this.params=g.Util.extend({},this.params||{});if(this.setters)for(var b in this.setters)this[b]=this.generateSetter(this.setters[b],this)},token:function(a){this._service?this._service.authenticate(a):this.params.token=a;return this},request:function(a,b){return this._service?this._service.request(this.path,this.params,a,b):this._request("request",this.path,this.params,a,b)},_request:function(a,b,c,e,d){b=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b;return"get"!==a&&"request"!==a||this.options.useCors?da[a](b,c,e,d):da.get.JSONP(b,c,e,d)}}),w=W.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",token:"token"},path:"query",params:{returnGeometry:!0,where:"1\x3d1",outSr:4326,outFields:"*"},within:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelContains";return this},intersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIntersects";return this},contains:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelWithin";return this},crosses:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelCrosses";return this},touches:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelTouches";return this},overlaps:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelOverlaps";return this},bboxIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelEnvelopeIntersects";return this},indexIntersects:function(a){this._setGeometry(a);this.params.spatialRel="esriSpatialRelIndexIntersects";return this},nearby:function(a,b){a=g.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";this.params.spatialRel="esriSpatialRelIntersects";this.params.units="esriSRUnit_Meter";this.params.distance=b;this.params.inSr=4326;return this},where:function(a){this.params.where=a;return this},between:function(a,b){this.params.time=[a.valueOf(),b.valueOf()];return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},orderBy:function(a,b){this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"";this.params.orderByFields+=[a,b||"ASC"].join(" ");return this},run:function(a,b){this._cleanParams();return this.options.isModern||D(this.options.url)?(this.params.f="geojson",this.request(function(c,e){this._trapSQLerrors(c);a.call(b,c,e,e)},this)):this.request(function(c,e){this._trapSQLerrors(c);a.call(b,c,e&&A(e),e)},this)},count:function(a,b){this._cleanParams();this.params.returnCountOnly=!0;return this.request(function(b,c){a.call(this,b,c&&c.count,c)},b)},ids:function(a,b){this._cleanParams();this.params.returnIdsOnly=!0;return this.request(function(b,c){a.call(this,b,c&&c.objectIds,c)},b)},bounds:function(a,b){this._cleanParams();this.params.returnExtentOnly=!0;return this.request(function(c,e){e&&e.extent&&q(e.extent)?a.call(b,c,q(e.extent),e):(c={message:"Invalid Bounds"},a.call(b,c,null,e))},b)},pixelSize:function(a){a=g.point(a);this.params.pixelSize=[a.x,a.y];return this},layer:function(a){this.path=a+"/query";return this},_trapSQLerrors:function(a){a&&"400"===a.code&&H("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly;delete this.params.returnExtentOnly;delete this.params.returnCountOnly},_setGeometry:function(a){this.params.inSr=4326;a instanceof g.LatLngBounds?(this.params.geometry=x(a),this.params.geometryType="esriGeometryEnvelope"):(a.getLatLng&&(a=a.getLatLng()),a instanceof g.LatLng&&(a={type:"Point",coordinates:[a.lng,a.lat]}),a instanceof g.GeoJSON&&(a=a.getLayers()[0].feature.geometry,this.params.geometry=r(a,void 0),this.params.geometryType=E(a.type)),a.toGeoJSON&&(a=a.toGeoJSON()),"Feature"===a.type&&(a=a.geometry),"Point"===a.type||"LineString"===a.type||"Polygon"===a.type||"MultiPolygon"===a.type?(this.params.geometry=r(a,void 0),this.params.geometryType=E(a.type)):H("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}}),R=W.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(a,b){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,b].join(":");return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},run:function(a,b){return this.request(function(c,e){a.call(b,c,e&&A(e),e)},b)}}),ia=W.extend({path:"identify",between:function(a,b){this.params.time=[a.valueOf(),b.valueOf()];return this}}),Ca=ia.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(a){var b=x(a.getBounds());a=a.getSize();this.params.imageDisplay=[a.x,a.y,96];this.params.mapExtent=[b.xmin,b.ymin,b.xmax,b.ymax];return this},at:function(a){a=g.latLng(a);this.params.geometry=[a.lng,a.lat];this.params.geometryType="esriGeometryPoint";return this},layerDef:function(a,b){this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"";this.params.layerDefs+=[a,b].join(":");return this},simplify:function(a,b){var c=Math.abs(a.getBounds().getWest()-a.getBounds().getEast());this.params.maxAllowableOffset=c/a.getSize().y*b;return this},run:function(a,b){return this.request(function(c,e){if(c)a.call(b,c,void 0,e);else{var d=A(e);e.results=e.results.reverse();for(var f=0;f<d.features.length;f++)d.features[f].layerId=e.results[f].layerId;a.call(b,void 0,d,e)}})}}),qa=ia.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(a){a=g.latLng(a);this.params.geometry=JSON.stringify({x:a.lng,y:a.lat,spatialReference:{wkid:4326}});this.params.geometryType="esriGeometryPoint";return this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(a,b){return this.request(function(c,e){a.call(b,c,e&&this._responseToGeoJSON(e),e)},this)},_responseToGeoJSON:function(a){var b=a.location,c=a.catalogItems,e=a.catalogItemVisibilities,b={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[b.x,b.y]},crs:{type:"EPSG",properties:{code:b.spatialReference.wkid}},properties:{OBJECTID:a.objectId,name:a.name,value:a.value},id:a.objectId}};a.properties&&a.properties.Values&&(b.pixel.properties.values=a.properties.Values);if(c&&c.features&&(b.catalogItems=A(c),e&&e.length===b.catalogItems.features.length))for(a=e.length-1;0<=a;a--)b.catalogItems.features[a].properties.catalogItemVisibility=e[a];return b}}),ha=g.Evented.extend({options:{proxy:!1,useCors:C,timeout:0},initialize:function(a){a=a||{};this._requestQueue=[];this._authenticating=!1;g.Util.setOptions(this,a);this.options.url=F(this.options.url)},get:function(a,b,c,e){return this._request("get",a,b,c,e)},post:function(a,b,c,e){return this._request("post",a,b,c,e)},request:function(a,b,c,e){return this._request("request",a,b,c,e)},metadata:function(a,b){return this._request("get","",{},a,b)},authenticate:function(a){this._authenticating=!1;this.options.token=a;this._runQueue();return this},getTimeout:function(){return this.options.timeout},setTimeout:function(a){this.options.timeout=a},_request:function(a,b,c,e,d){this.fire("requeststart",{url:this.options.url+b,params:c,method:a},!0);var f=this._createServiceCallback(a,b,c,e,d);this.options.token&&(c.token=this.options.token);if(this._authenticating)this._requestQueue.push([a,b,c,e,d]);else return b=this.options.proxy?this.options.proxy+"?"+this.options.url+b:this.options.url+b,"get"!==a&&"request"!==a||this.options.useCors?da[a](b,c,f,d):da.get.JSONP(b,c,f,d)},_createServiceCallback:function(a,b,c,e,d){return g.Util.bind(function(f,h){!f||499!==f.code&&498!==f.code||(this._authenticating=!0,this._requestQueue.push([a,b,c,e,d]),this.fire("authenticationrequired",{authenticate:g.Util.bind(this.authenticate,this)},!0),f.authenticate=g.Util.bind(this.authenticate,this));e.call(d,f,h);f?this.fire("requesterror",{url:this.options.url+b,params:c,message:f.message,code:f.code,method:a},!0):this.fire("requestsuccess",{url:this.options.url+b,params:c,response:h,method:a},!0);this.fire("requestend",{url:this.options.url+b,params:c,method:a},!0)},this)},_runQueue:function(){for(var a=this._requestQueue.length-1;0<=a;a--){var b=this._requestQueue[a];this[b.shift()].apply(this,b)}this._requestQueue=[]}}),Da=ha.extend({identify:function(){return v(this)},find:function(){return z(this)},query:function(){return G(this)}}),sa=ha.extend({query:function(){return G(this)},identify:function(){return O(this)}}),Aa=ha.extend({options:{idAttribute:"OBJECTID"},query:function(){return G(this)},addFeature:function(a,b,c){delete a.id;a=r(a,void 0);return this.post("addFeatures",{features:[a]},function(a,e){var d=e&&e.addResults?e.addResults[0]:void 0;b&&b.call(c,a||e.addResults[0].error,d)},c)},updateFeature:function(a,b,c){a=r(a,this.options.idAttribute);return this.post("updateFeatures",{features:[a]},function(a,e){var d=e&&e.updateResults?e.updateResults[0]:void 0;b&&b.call(c,a||e.updateResults[0].error,d)},c)},deleteFeature:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,e){var d=e&&e.deleteResults?e.deleteResults[0]:void 0;b&&b.call(c,a||e.deleteResults[0].error,d)},c)},deleteFeatures:function(a,b,c){return this.post("deleteFeatures",{objectIds:a},function(a,e){var d=e&&e.deleteResults?e.deleteResults:void 0;b&&b.call(c,a||e.deleteResults[0].error,d)},c)}}),P="https:"!==window.location.protocol?"http:":"https:",na=g.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:P+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:P+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane"}},NationalGeographic:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, \x26copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community"}},ImageryLabels:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane"}},ShadedRelief:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:Z?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:P+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}}}},initialize:function(a,b){var c;if("object"===typeof a&&a.urlTemplate&&a.options)c=a;else if("string"===typeof a&&na.TILES[a])c=na.TILES[a];else throw Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var e=g.Util.extend(c.options,b);g.Util.setOptions(this,e);this.options.token&&(c.urlTemplate+="?token\x3d"+this.options.token);g.TileLayer.prototype.initialize.call(this,c.urlTemplate,e)},onAdd:function(a){u(a);"esri-labels"===this.options.pane&&this._initPane();this.options.attributionUrl&&I(this.options.attributionUrl,a);a.on("moveend",N);g.TileLayer.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("moveend",N);g.TileLayer.prototype.onRemove.call(this,a)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var a=this._map.createPane(this.options.pane);a.style.pointerEvents="none";a.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var a='\x3cspan class\x3d"esri-dynamic-attribution"\x3e'+this.options.attribution+"\x3c/span\x3e";return a}}),ra=g.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg\x3d\x3d"},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(a){a.url=F(a.url);a=g.Util.setOptions(this,a);this.tileUrl=a.url+"tile/{z}/{y}/{x}";this.service=V(a);this.service.addEventParent(this);(new RegExp(/tiles.arcgis(online)?\.com/g)).test(a.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),a.subdomains=["1","2","3","4"]);this.options.token&&(this.tileUrl+="?token\x3d"+this.options.token);g.TileLayer.prototype.initialize.call(this,this.tileUrl,a)},getTileUrl:function(a){var b=this._getZoomForUrl();return g.Util.template(this.tileUrl,g.Util.extend({s:this._getSubdomain(a),x:a.x,y:a.y,z:this._lodMap&&this._lodMap[b]?this._lodMap[b]:b},this.options))},createTile:function(a,b){var c=document.createElement("img");L.DomEvent.on(c,"load",L.bind(this._tileOnLoad,this,b,c));L.DomEvent.on(c,"error",L.bind(this._tileOnError,this,b,c));this.options.crossOrigin&&(c.crossOrigin="");c.alt="";if(!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()])c.src=this.getTileUrl(a);else this.once("lodmap",function(){c.src=this.getTileUrl(a)},this);return c},onAdd:function(a){u(a);this._lodMap||this.metadata(function(b,c){if(!b&&c.spatialReference){var e=c.spatialReference.latestWkid||c.spatialReference.wkid;!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()));if(a.options.crs===L.CRS.EPSG3857&&102100===e||3857===e){this._lodMap={};for(var e=c.tileInfo.lods,d=ra.MercatorZoomLevels,f=0;f<e.length;f++){var h=e[f],k;for(k in d)if(this._withinPercentage(h.resolution,d[k],this.options.zoomOffsetAllowance)){this._lodMap[k]=h.level;break}}this.fire("lodmap")}else proj4||H("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this);g.TileLayer.prototype.onAdd.call(this,a)},metadata:function(a,b){this.service.metadata(a,b);return this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(a){var b="?token\x3d"+a;this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,b):this.tileUrl+b;this.options.token=a;this.service.authenticate(a);return this},_withinPercentage:function(a,b,c){return Math.abs(a/b-1)<c}}),Ba=g.ImageOverlay.extend({onAdd:function(a){this._topLeft=a.getPixelBounds().min;g.ImageOverlay.prototype.onAdd.call(this,a)},_reset:function(){this._map.options.crs===g.CRS.EPSG3857?g.ImageOverlay.prototype._reset.call(this):g.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),C=g.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:C,attribution:null,interactive:!1,alt:""},onAdd:function(a){u(a);this._update=g.Util.throttle(this._update,this.options.updateInterval,this);a.on("moveend",this._update,this);this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?a.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null);this._update();this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));this.metadata(function(b,c){!b&&!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(a){this._currentImage&&this._map.removeLayer(this._currentImage);this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._map.off("moveend",this._update,this)},bindPopup:function(a,b){this._lastClick=this._shouldRenderPopup=!1;this._popup=g.popup(b);this._popupFunction=a;this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this));return this},unbindPopup:function(){this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this));this._popup=!1;return this},bringToFront:function(){this.options.position="front";this._currentImage&&this._currentImage.bringToFront();return this},bringToBack:function(){this.options.position="back";this._currentImage&&this._currentImage.bringToBack();return this},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(a){this.options.opacity=a;this._currentImage&&this._currentImage.setOpacity(a);return this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b){this.options.from=a;this.options.to=b;this._update();return this},metadata:function(a,b){this.service.metadata(a,b);return this},authenticate:function(a){this.service.authenticate(a);return this},redraw:function(){this._update()},_renderImage:function(a,b,c){this._map&&(c&&(a="data:"+c+";base64,"+a),(new Ba(a,b,{opacity:0,crossOrigin:this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive})).addTo(this._map).once("load",function(a){if(this._map){a=a.target;var c=this._currentImage;a._bounds.equals(b)&&a._bounds.equals(this._map.getBounds())?(this._currentImage=a,"front"===this.options.position?this.bringToFront():this.bringToBack(),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),c&&this._map&&this._map.removeLayer(c),c&&c._map&&c._map.removeLayer(c)):this._map.removeLayer(a)}this.fire("load",{bounds:b})},this),this.fire("loading",{bounds:b}))},_update:function(){if(this._map){var a=this._map.getZoom(),b=this._map.getBounds();this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress||(a>this.options.maxZoom||a<this.options.minZoom?this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null):(a=this._buildExportParams(),this._requestExport(a,b)))}},_renderPopup:function(a,b,c,e){a=g.latLng(a);this._shouldRenderPopup&&this._lastClick.equals(a)&&(b=this._popupFunction(b,c,e))&&this._popup.setLatLng(a).setContent(b).openOn(this._map)},_resetPopupState:function(a){this._shouldRenderPopup=!1;this._lastClick=a.latlng}}),Ea=C.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"json"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(a){a.url=F(a.url);this.service=ba(a);this.service.addEventParent(this);g.Util.setOptions(this,a)},setPixelType:function(a){this.options.pixelType=a;this._update();return this},getPixelType:function(){return this.options.pixelType},setBandIds:function(a){g.Util.isArray(a)?this.options.bandIds=a.join(","):this.options.bandIds=a.toString();this._update();return this},getBandIds:function(){return this.options.bandIds},setNoData:function(a,b){g.Util.isArray(a)?this.options.noData=a.join(","):this.options.noData=a.toString();b&&(this.options.noDataInterpretation=b);this._update();return this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(a){this.options.renderingRule=a;this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(a){this.options.mosaicRule=a;this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(a){var b=g.Util.bind(function(b,c,e){b||setTimeout(g.Util.bind(function(){this._renderPopup(a.latlng,b,c,e)},this),300)},this),c=this.identify().at(a.latlng);this.options.mosaicRule&&c.setMosaicRule(this.options.mosaicRule);c.run(b);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a._northEast),e=this._map.options.crs.project(a._southWest),d=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<d.y||a.y<b.y)b.y=a.y-d.y;d=parseInt(this._map.options.crs.code.split(":")[1],10);b={bbox:[e.x,e.y,c.x,c.y].join(),size:b.x+","+b.y,format:this.options.format,transparent:this.options.transparent,bboxSR:d,imageSR:d};this.options.from&&this.options.to&&(b.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.options.pixelType&&(b.pixelType=this.options.pixelType);this.options.interpolation&&(b.interpolation=this.options.interpolation);this.options.compressionQuality&&(b.compressionQuality=this.options.compressionQuality);this.options.bandIds&&(b.bandIds=this.options.bandIds);this.options.noData&&(b.noData=this.options.noData);this.options.noDataInterpretation&&(b.noDataInterpretation=this.options.noDataInterpretation);this.service.options.token&&(b.token=this.service.options.token);this.options.renderingRule&&(b.renderingRule=JSON.stringify(this.options.renderingRule));this.options.mosaicRule&&(b.mosaicRule=JSON.stringify(this.options.mosaicRule));return b},_requestExport:function(a,b){"json"===this.options.f?this.service.request("exportImage",a,function(a,c){a||(this.options.token&&(c.href+="?token\x3d"+this.options.token),this._renderImage(c.href,b))},this):(a.f="image",2437==a.bboxSR&&(a.imageSR=a.bboxSR='{"wkt":"PROJCS["WX",GEOGCS["GCS_Beijing_1954",DATUM["D_Beijing_1954",SPHEROID["Krasovsky_1940",6378245.0,298.3]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Gauss_Kruger"],PARAMETER["False_Easting",50000.0],PARAMETER["False_Northing",-3450000.0],PARAMETER["Central_Meridian",120.0],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]"}'),this._renderImage(this.options.url+"exportImage"+g.Util.getParamString(a),b))}}),va=C.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png24",transparent:!0,f:"json"},initialize:function(a){a.url=F(a.url);this.service=V(a);this.service.addEventParent(this);(a.proxy||a.token)&&"json"!==a.f&&(a.f="json");g.Util.setOptions(this,a)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(a){this.options.dynamicLayers=a;this._update();return this},getLayers:function(){return this.options.layers},setLayers:function(a){this.options.layers=a;this._update();return this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(a){this.options.layerDefs=a;this._update();return this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(a){this.options.timeOptions=a;this._update();return this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(a){var b=g.Util.bind(function(b,c,e){b||setTimeout(g.Util.bind(function(){this._renderPopup(a.latlng,b,c,e)},this),300)},this),c=this.identify().on(this._map).at(a.latlng);c.simplify(this._map,.5);this.options.layers?c.layers("visible:"+this.options.layers.join(",")):c.layers("visible");c.run(b);this._shouldRenderPopup=!0;this._lastClick=a.latlng},_buildExportParams:function(){var a=this._map.getBounds(),b=this._map.getSize(),c=this._map.options.crs.project(a.getNorthEast()),e=this._map.options.crs.project(a.getSouthWest()),d=parseInt(this._map.options.crs.code.split(":")[1],10),f=this._map.latLngToLayerPoint(a._northEast),a=this._map.latLngToLayerPoint(a._southWest);if(0<f.y||a.y<b.y)b.y=a.y-f.y;b={bbox:[e.x,e.y,c.x,c.y].join(),size:b.x+","+b.y,dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:d,imageSR:d};this.options.dynamicLayers&&(b.dynamicLayers=this.options.dynamicLayers);this.options.layers&&(b.layers="show:"+this.options.layers.join(","));this.options.layerDefs&&(b.layerDefs="string"===typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs));this.options.timeOptions&&(b.timeOptions=JSON.stringify(this.options.timeOptions));this.options.from&&this.options.to&&(b.time=this.options.from.valueOf()+","+this.options.to.valueOf());this.service.options.token&&(b.token=this.service.options.token);this.options.proxy&&(b.proxy=this.options.proxy);this.options.geokey&&(b.geokey=this.options.geokey);return b},_requestExport:function(a,b){"json"===this.options.f?this.service.request("export",a,function(a,c){a||(this.options.token&&(c.href+="?token\x3d"+this.options.token),this.options.proxy&&(c.href=this.options.proxy+"?"+c.href),c.href?this._renderImage(c.href,b):this._renderImage(c.imageData,b,c.contentType))},this):(a.f="image",2437==a.bboxSR&&(a.imageSR=a.bboxSR='{"wkt":"PROJCS["WX",GEOGCS["GCS_Beijing_1954",DATUM["D_Beijing_1954",SPHEROID["Krasovsky_1940",6378245.0,298.3]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Gauss_Kruger"],PARAMETER["False_Easting",50000.0],PARAMETER["False_Northing",-3450000.0],PARAMETER["Central_Meridian",120.0],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]"}'),this._renderImage(this.options.url+"export"+g.Util.getParamString(a),b))}}),ea=M.Layer.extend({options:{cellSize:512,updateInterval:150},initialize:function(a){M.setOptions(this,a);this._zooming=!1},onAdd:function(a){this._map=a;this._update=M.Util.throttle(this._update,this.options.updateInterval,this);this._reset();this._update()},onRemove:function(){this._map.removeEventListener(this.getEvents(),this);this._removeCells()},getEvents:function(){return{moveend:this._update,zoomstart:this._zoomstart,zoomend:this._reset}},addTo:function(a){a.addLayer(this);return this},removeFrom:function(a){a.removeLayer(this);return this},_zoomstart:function(){this._zooming=!0},_reset:function(){this._removeCells();this._cells={};this._activeCells={};this._cellsTotal=this._cellsToLoad=0;this._cellNumBounds=this._getCellNumBounds();this._resetWrap();this._zooming=!1},_resetWrap:function(){var a=this._map,b=a.options.crs;if(!b.infinite){var c=this._getCellSize();b.wrapLng&&(this._wrapLng=[Math.floor(a.project([0,b.wrapLng[0]]).x/c),Math.ceil(a.project([0,b.wrapLng[1]]).x/c)]);b.wrapLat&&(this._wrapLat=[Math.floor(a.project([b.wrapLat[0],0]).y/c),Math.ceil(a.project([b.wrapLat[1],0]).y/c)])}},_getCellSize:function(){return this.options.cellSize},_update:function(){if(this._map){var a=this._map.getPixelBounds(),b=this._getCellSize(),a=M.bounds(a.min.divideBy(b).floor(),a.max.divideBy(b).floor());this._removeOtherCells(a);this._addCells(a);this.fire("cellsupdated")}},_addCells:function(a){var b=[],c=a.getCenter(),e=this._map.getZoom(),d,f,h;for(d=a.min.y;d<=a.max.y;d++)for(f=a.min.x;f<=a.max.x;f++)h=M.point(f,d),h.z=e,this._isValidCell(h)&&b.push(h);a=b.length;if(0!==a)for(this._cellsToLoad+=a,this._cellsTotal+=a,b.sort(function(a,b){return a.distanceTo(c)-b.distanceTo(c)}),f=0;f<a;f++)this._addCell(b[f])},_isValidCell:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._cellNumBounds;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;a=this._cellCoordsToBounds(a);return M.latLngBounds(this.options.bounds).intersects(a)},_cellCoordsToBounds:function(a){var b=this._map,c=this.options.cellSize,e=a.multiplyBy(c),c=e.add([c,c]),e=b.wrapLatLng(b.unproject(e,a.z));a=b.wrapLatLng(b.unproject(c,a.z));return M.latLngBounds(e,a)},_cellCoordsToKey:function(a){return a.x+":"+a.y},_keyToCellCoords:function(a){var b=a.split(":");a=parseInt(b[0],10);b=parseInt(b[1],10);return M.point(a,b)},_removeOtherCells:function(a){for(var b in this._cells)a.contains(this._keyToCellCoords(b))||this._removeCell(b)},_removeCell:function(a){var b=this._activeCells[a];b&&(delete this._activeCells[a],this.cellLeave&&this.cellLeave(b.bounds,b.coords),this.fire("cellleave",{bounds:b.bounds,coords:b.coords}))},_removeCells:function(){for(var a in this._cells){var b=this._cells[a].bounds,c=this._cells[a].coords;this.cellLeave&&this.cellLeave(b,c);this.fire("cellleave",{bounds:b,coords:c})}},_addCell:function(a){this._wrapCoords(a);var b=this._cellCoordsToKey(a),c=this._cells[b];c&&!this._activeCells[b]&&(this.cellEnter&&this.cellEnter(c.bounds,a),this.fire("cellenter",{bounds:c.bounds,coords:a}),this._activeCells[b]=c);c||(c={coords:a,bounds:this._cellCoordsToBounds(a)},this._cells[b]=c,this._activeCells[b]=c,this.createCell&&this.createCell(c.bounds,a),this.fire("cellcreate",{bounds:c.bounds,coords:a}))},_wrapCoords:function(a){a.x=this._wrapLng?M.Util.wrapNum(a.x,this._wrapLng):a.x;a.y=this._wrapLat?M.Util.wrapNum(a.y,this._wrapLat):a.y},_getCellNumBounds:function(){var a=this._map.getPixelWorldBounds(),b=this._getCellSize();return a?M.bounds(a.min.divideBy(b).floor(),a.max.divideBy(b).ceil().subtract([1,1])):null}});T.prototype.query=function(a){a=this.getIndex(a);return this.values[a]};T.prototype.getIndex=function(a){this.dirty&&this.sort();for(var b=0,c=this.values.length-1,e,d;b<=c;)if(e=(b+c)/2|0,d=this.values[Math.round(e)],+d.value<+a)b=e+1;else if(+d.value>+a)c=e-1;else return e;return Math.abs(~c)};T.prototype.between=function(a,b){var c=this.getIndex(a),e=this.getIndex(b);if(0===c&&0===e)return[];for(;this.values[c-1]&&this.values[c-1].value===a;)c--;for(;this.values[e+1]&&this.values[e+1].value===b;)e++;this.values[e]&&this.values[e].value===b&&this.values[e+1]&&e++;return this.values.slice(c,e)};T.prototype.insert=function(a){this.values.splice(this.getIndex(a.value),0,a);return this};T.prototype.bulkAdd=function(a,b){this.values=this.values.concat([].concat(a||[]));b?this.sort():this.dirty=!0;return this};T.prototype.sort=function(){this.values.sort(function(a,b){return+b.value-+a.value}).reverse();this.dirty=!1;return this};var ma=ea.extend({options:{attribution:null,where:"1\x3d1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6},initialize:function(a){ea.prototype.initialize.call(this,a);a.url=F(a.url);a=g.setOptions(this,a);this.service=Y(a);this.service.addEventParent(this);if("*"!==this.options.fields[0]){a=!1;for(var b=0;b<this.options.fields.length;b++)this.options.fields[b].match(/^(OBJECTID|FID|OID|ID)$/i)&&(a=!0);!1===a&&H("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new T,this._endTimeIndex=new T):this.options.timeField&&(this._timeIndex=new T);this._cache={};this._currentSnapshot=[];this._activeRequests=0},onAdd:function(a){u(a);this.service.metadata(function(b,c){if(!b){var e=c.supportedQueryFormats,d=!1;!1===this.service.options.isModern&&(d=!0);!d&&e&&-1!==e.indexOf("geoJSON")&&(this.service.options.isModern=!0);!this.options.attribution&&a.attributionControl&&c.copyrightText&&(this.options.attribution=c.copyrightText,a.attributionControl.addAttribution(this.getAttribution()))}},this);a.on("zoomend",this._handleZoomChange,this);return ea.prototype.onAdd.call(this,a)},onRemove:function(a){a.off("zoomend",this._handleZoomChange,this);return ea.prototype.onRemove.call(this,a)},getAttribution:function(){return this.options.attribution},createCell:function(a,b){this._visibleZoom()&&this._requestFeatures(a,b)},_requestFeatures:function(a,b,c){this._activeRequests++;1===this._activeRequests&&this.fire("loading",{bounds:a},!0);return this._buildQuery(a).run(function(e,d,f){f&&f.exceededTransferLimit&&this.fire("drawlimitexceeded");!e&&d&&d.features.length&&g.Util.requestAnimFrame(g.Util.bind(function(){this._addFeatures(d.features,b);this._postProcessFeatures(a)},this));e||!d||d.features.length||this._postProcessFeatures(a);e&&this._postProcessFeatures(a);c&&c.call(this,e,d)},this)},_postProcessFeatures:function(a){this._activeRequests--;0>=this._activeRequests&&this.fire("load",{bounds:a})},_cacheKey:function(a){return a.z+":"+a.x+":"+a.y},_addFeatures:function(a,b){var c=this._cacheKey(b);this._cache[c]=this._cache[c]||[];for(var e=a.length-1;0<=e;e--){var d=a[e].id;-1===this._currentSnapshot.indexOf(d)&&this._currentSnapshot.push(d);-1===this._cache[c].indexOf(d)&&this._cache[c].push(d)}this.options.timeField&&this._buildTimeIndexes(a);this.createLayers(a)},_buildQuery:function(a){a=this.service.query().intersects(a).where(this.options.where).fields(this.options.fields).precision(this.options.precision);this.options.simplifyFactor&&a.simplify(this._map,this.options.simplifyFactor);"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&a.between(this.options.from,this.options.to);return a},setWhere:function(a,b,c){this.options.where=a&&a.length?a:"1\x3d1";var e=[],d=[],f=0,h=null;a=g.Util.bind(function(a,k){a&&(h=a);if(k)for(var l=k.features.length-1;0<=l;l--)d.push(k.features[l].id);f--;0>=f&&(this._currentSnapshot=d,g.Util.requestAnimFrame(g.Util.bind(function(){this.removeLayers(e);this.addLayers(d);b&&b.call(c,h)},this)))},this);for(var k=this._currentSnapshot.length-1;0<=k;k--)e.push(this._currentSnapshot[k]);for(var l in this._activeCells)f++,k=this._keyToCellCoords(l),k=this._cellCoordsToBounds(k),this._requestFeatures(k,l,a);return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(a,b,c,e){var d=this.options.from,f=this.options.to,h=0,k=null,l=g.Util.bind(function(l){l&&(k=l);this._filterExistingFeatures(d,f,a,b);h--;c&&0>=h&&c.call(e,k)},this);this.options.from=a;this.options.to=b;this._filterExistingFeatures(d,f,a,b);if("server"===this.options.timeFilterMode)for(var B in this._activeCells){h++;var n=this._keyToCellCoords(B),n=this._cellCoordsToBounds(n);this._requestFeatures(n,B,l)}return this},refresh:function(){for(var a in this._activeCells){var b=this._keyToCellCoords(a),b=this._cellCoordsToBounds(b);this._requestFeatures(b,a)}if(this.redraw)this.once("load",function(){this.eachFeature(function(a){this._redraw(a.feature.id)},this)},this)},_filterExistingFeatures:function(a,b,c,e){var d=a&&b?this._getFeaturesInTimeRange(a,b):this._currentSnapshot,f=this._getFeaturesInTimeRange(c,e);if(f.indexOf)for(a=0;a<f.length;a++)b=d.indexOf(f[a]),0<=b&&d.splice(b,1);g.Util.requestAnimFrame(g.Util.bind(function(){this.removeLayers(d);this.addLayers(f)},this))},_getFeaturesInTimeRange:function(a,b){var c=[],e;if(this.options.timeField.start&&this.options.timeField.end){e=this._startTimeIndex.between(a,b);var d=this._endTimeIndex.between(a,b);e=e.concat(d)}else e=this._timeIndex.between(a,b);for(d=e.length-1;0<=d;d--)c.push(e[d].id);return c},_buildTimeIndexes:function(a){var b,c;if(this.options.timeField.start&&this.options.timeField.end){var e=[],d=[];for(b=a.length-1;0<=b;b--)c=a[b],e.push({id:c.id,value:new Date(c.properties[this.options.timeField.start])}),d.push({id:c.id,value:new Date(c.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(e);this._endTimeIndex.bulkAdd(d)}else{e=[];for(b=a.length-1;0<=b;b--)c=a[b],e.push({id:c.id,value:new Date(c.properties[this.options.timeField])});this._timeIndex.bulkAdd(e)}},_featureWithinTimeRange:function(a){if(!this.options.from||!this.options.to)return!0;var b=+this.options.from.valueOf(),c=+this.options.to.valueOf();if("string"===typeof this.options.timeField){var e=+a.properties[this.options.timeField];return e>=b&&e<=c}if(this.options.timeField.start&&this.options.timeField.end)return e=+a.properties[this.options.timeField.start],a=+a.properties[this.options.timeField.end],e>=b&&e<=c||a>=b&&a<=c},_visibleZoom:function(){if(!this._map)return!1;var a=this._map.getZoom();return a>this.options.maxZoom||a<this.options.minZoom?!1:!0},_handleZoomChange:function(){if(this._visibleZoom())for(var a in this._activeCells){var b=this._cacheKey(this._activeCells[a].coords);this._cache[b]&&this.addLayers(this._cache[b])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(a){this.service.authenticate(a);return this},metadata:function(a,b){this.service.metadata(a,b);return this},query:function(){return this.service.query()},_getMetadata:function(a){this._metadata?a(void 0,this._metadata):this.metadata(g.Util.bind(function(b,c){this._metadata=c;a(b,this._metadata)},this))},addFeature:function(a,b,c){this._getMetadata(g.Util.bind(function(e,d){e?b&&b.call(this,e,null):this.service.addFeature(a,g.Util.bind(function(e,f){e||(a.properties[d.objectIdField]=f.objectId,a.id=f.objectId,this.createLayers([a]));b&&b.call(c,e,f)},this))},this))},updateFeature:function(a,b,c){this.service.updateFeature(a,function(e,d){e||(this.removeLayers([a.id],!0),this.createLayers([a]));b&&b.call(c,e,d)},this)},deleteFeature:function(a,b,c){this.service.deleteFeature(a,function(a,e){!a&&e.objectId&&this.removeLayers([e.objectId],!0);b&&b.call(c,a,e)},this)},deleteFeatures:function(a,b,c){return this.service.deleteFeatures(a,function(a,e){if(!a&&0<e.length)for(var d=0;d<e.length;d++)this.removeLayers([e[d].objectId],!0);b&&b.call(c,a,e)},this)}}),X=ma.extend({options:{cacheLayers:!0},initialize:function(a){ma.prototype.initialize.call(this,a);this._originalStyle=this.options.style;this._layers={}},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b]),this.fire("removefeature",{feature:this._layers[b].feature,permanent:!1},!0);return ma.prototype.onRemove.call(this,a)},createNewLayer:function(a){a=g.GeoJSON.geometryToLayer(a,this.options);a.defaultOptions=a.options;return a},_updateLayer:function(a,b){var c;c=this.options.coordsToLatLng||g.GeoJSON.coordsToLatLng;b.properties&&(a.feature.properties=b.properties);switch(b.geometry.type){case "Point":c=g.GeoJSON.coordsToLatLng(b.geometry.coordinates);a.setLatLng(c);break;case "LineString":c=g.GeoJSON.coordsToLatLngs(b.geometry.coordinates,0,c);a.setLatLngs(c);break;case "MultiLineString":c=g.GeoJSON.coordsToLatLngs(b.geometry.coordinates,1,c);a.setLatLngs(c);break;case "Polygon":c=g.GeoJSON.coordsToLatLngs(b.geometry.coordinates,1,c);a.setLatLngs(c);break;case "MultiPolygon":c=g.GeoJSON.coordsToLatLngs(b.geometry.coordinates,2,c),a.setLatLngs(c)}},createLayers:function(a){for(var b=a.length-1;0<=b;b--){var c=a[b],e=this._layers[c.id];this._visibleZoom()&&e&&!this._map.hasLayer(e)&&(this._map.addLayer(e),this.fire("addfeature",{feature:e.feature},!0));e&&0<this.options.simplifyFactor&&(e.setLatLngs||e.setLatLng)&&this._updateLayer(e,c);if(!e){e=this.createNewLayer(c);e.feature=c;e.addEventParent(this);if(this.options.onEachFeature)this.options.onEachFeature(e.feature,e);this._layers[e.feature.id]=e;this.setFeatureStyle(e.feature.id,this.options.style);this.fire("createfeature",{feature:e.feature},!0);this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(c))&&this._map.addLayer(e)}}},addLayers:function(a){for(var b=a.length-1;0<=b;b--){var c=this._layers[a[b]];c&&this._map.addLayer(c)}},removeLayers:function(a,b){for(var c=a.length-1;0<=c;c--){var e=a[c],d=this._layers[e];d&&(this.fire("removefeature",{feature:d.feature,permanent:b},!0),this._map.removeLayer(d));d&&b&&delete this._layers[e]}},cellEnter:function(a,b){this._visibleZoom()&&!this._zooming&&this._map&&g.Util.requestAnimFrame(g.Util.bind(function(){var a=this._cacheKey(b),c=this._cellCoordsToKey(b),a=this._cache[a];this._activeCells[c]&&a&&this.addLayers(a)},this))},cellLeave:function(a,b){this._zooming||g.Util.requestAnimFrame(g.Util.bind(function(){if(this._map){var a=this._cacheKey(b),c=this._cellCoordsToKey(b),e=this._cache[a],d=this._map.getBounds();if(!this._activeCells[c]&&e){for(var f=!0,h=0;h<e.length;h++){var k=this._layers[e[h]];k&&k.getBounds&&d.intersects(k.getBounds())&&(f=!1)}f&&this.removeLayers(e,!this.options.cacheLayers);!this.options.cacheLayers&&f&&(delete this._cache[a],delete this._cells[c],delete this._activeCells[c])}}},this))},resetStyle:function(){this.options.style=this._originalStyle;this.eachFeature(function(a){this.resetFeatureStyle(a.feature.id)},this);return this},setStyle:function(a){this.options.style=a;this.eachFeature(function(b){this.setFeatureStyle(b.feature.id,a)},this);return this},resetFeatureStyle:function(a){var b=this._layers[a],c=this._originalStyle||L.Path.prototype.options;b&&(g.Util.extend(b.options,b.defaultOptions),this.setFeatureStyle(a,c));return this},setFeatureStyle:function(a,b){var c=this._layers[a];"function"===typeof b&&(b=b(c.feature));c.setStyle&&c.setStyle(b);return this},eachActiveFeature:function(a,b){if(this._map){var c=this._map.getBounds(),e;for(e in this._layers)c.intersects(this._layers[e].getBounds())&&-1!==this._currentSnapshot.indexOf(this._layers[e].feature.id)&&a.call(b,this._layers[e])}return this},eachFeature:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getFeature:function(a){return this._layers[a]},bringToBack:function(){this.eachFeature(function(a){a.bringToBack&&a.bringToBack()})},bringToFront:function(){this.eachFeature(function(a){a.bringToFront&&a.bringToFront()})},redraw:function(a){a&&this._redraw(a);return this},_redraw:function(a){a=this._layers[a];var b=a.feature;if(a&&a.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var c=this.options.pointToLayer(b,g.latLng(b.geometry.coordinates[1],b.geometry.coordinates[0])).options.icon;a.setIcon(c)}a&&a.setStyle&&this.options.pointToLayer&&(c=this.options.pointToLayer(b,g.latLng(b.geometry.coordinates[1],b.geometry.coordinates[0])).options,this.setFeatureStyle(b.id,c));a&&a.setStyle&&this.options.style&&this.resetStyle(b.id)}});f.VERSION="2.0.8";f.Support=aa;f.options=Q;f.Util=ta;f.get=la;f.post=b;f.request=a;f.Task=W;f.task=function(a){return new W(a)};f.Query=w;f.query=G;f.Find=R;f.find=z;f.Identify=ia;f.identify=function(a){return new ia(a)};f.IdentifyFeatures=Ca;f.identifyFeatures=v;f.IdentifyImage=qa;f.identifyImage=O;f.Service=ha;f.service=function(a){return new ha(a)};f.MapService=Da;f.mapService=V;f.ImageService=sa;f.imageService=ba;f.FeatureLayerService=Aa;f.featureLayerService=Y;f.BasemapLayer=na;f.basemapLayer=function(a,b){return new na(a,b)};f.TiledMapLayer=ra;f.tiledMapLayer=function(a,b){return new ra(a,b)};f.RasterLayer=C;f.ImageMapLayer=Ea;f.imageMapLayer=function(a,b){return new Ea(a,b)};f.DynamicMapLayer=va;f.dynamicMapLayer=function(a,b){return new va(a,b)};f.FeatureManager=ma;f.FeatureLayer=X;f.featureLayer=function(a){return new X(a)}});(function(f,g){"object"===typeof module&&"object"===typeof module.exports&&(exports=module.exports=g(require("leaflet")));if("object"===typeof f.navigator){if(!f.L)throw Error("L.Terraformer requires leaflet ");f.L.Terraformer=g(f.L)}})(this,function(){function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(){var a=Array.prototype.slice.apply(arguments);console.warn&&console.warn.apply(console,a)}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function c(a){if(a.type)switch(a.type){case "Point":return[a.coordinates[0],a.coordinates[1],a.coordinates[0],a.coordinates[1]];case "MultiPoint":return l(a.coordinates);case "LineString":return l(a.coordinates);case "MultiLineString":return b(a.coordinates);case "Polygon":return b(a.coordinates);case "MultiPolygon":a=a.coordinates;for(var e=null,d=null,f=null,h=null,k=0;k<a.length;k++)for(var g=a[k],n=0;n<g.length;n++)for(var m=g[n],Q=0;Q<m.length;Q++){var t=m[Q],p=t[0],t=t[1];null===e?e=p:p<e&&(e=p);null===d?d=p:p>d&&(d=p);null===f?f=t:t<f&&(f=t);null===h?h=t:t>h&&(h=t)}return[e,f,d,h];case "Feature":return a.geometry?c(a.geometry):null;case "FeatureCollection":e=[];for(f=a.features.length-1;0<=f;f--)d=c(a.features[f].geometry),e.push([d[0],d[1]]),e.push([d[2],d[3]]);return l(e);case "GeometryCollection":e=[];for(f=a.geometries.length-1;0<=f;f--)d=c(a.geometries[f]),e.push([d[0],d[1]]),e.push([d[2],d[3]]);return l(e);default:throw Error("Unknown type: "+a.type);}return null}function b(a){for(var b=null,c=null,e=null,d=null,f=0;f<a.length;f++)for(var h=a[f],k=0;k<h.length;k++){var l=h[k],g=l[0],l=l[1];null===b?b=g:g<b&&(b=g);null===c?c=g:g>c&&(c=g);null===e?e=l:l<e&&(e=l);null===d?d=l:l>d&&(d=l)}return[b,e,c,d]}function l(a){for(var b=null,c=null,e=null,d=null,f=0;f<a.length;f++){var h=a[f],k=h[0],h=h[1];null===b?b=k:k<b&&(b=k);null===c?c=k:k>c&&(c=k);null===e?e=h:h<e&&(e=h);null===d?d=h:h>d&&(d=h)}return[b,e,c,d]}function a(a){a=c(a);return{x:a[0],y:a[1],w:Math.abs(a[0]-a[2]),h:Math.abs(a[1]-a[3])}}function e(a,b){for(var c=0;c<a.length;c++)"number"===typeof a[c][0]&&(a[c]=b(a[c])),"object"===typeof a[c]&&(a[c]=e(a[c],b));return a}function h(a){var b=a[0];return[b/6378137*57.29577951308232-360*Math.floor((b/6378137*57.29577951308232+180)/360),57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*a[1]/6378137)))]}function k(a){var b=Math.max(Math.min(a[1],89.99999),-89.99999);return[111319.49079327169*a[0],3189068.5*Math.log((1+Math.sin(.017453292519943*b))/(1-Math.sin(.017453292519943*b)))]}function n(a,b,c){if("Point"===a.type)a.coordinates=b(a.coordinates);else if("Feature"===a.type)a.geometry=n(a.geometry,b,!0);else if("FeatureCollection"===a.type)for(var d=0;d<a.features.length;d++)a.features[d]=n(a.features[d],b,!0);else if("GeometryCollection"===a.type)for(d=0;d<a.geometries.length;d++)a.geometries[d]=n(a.geometries[d],b,!0);else a.coordinates=e(a.coordinates,b);c||b!==k||(a.crs=Z);b===h&&delete a.crs;return a}function m(a){return n(a,k)}function t(a){return n(a,h)}function p(a,b){return a[0]>b[0]?-1:a[0]<b[0]?1:a[1]>b[1]?-1:a[1]<b[1]?1:0}function r(a,b){var c=b[0]-a[0],e=b[1]-a[1];return c*c+e*e}function q(a){if(0===a.length)return[];if(1===a.length)return a;for(var b=[a.sort(p)[0]],c=0;c<b.length;c++){var e;e=a;var d=b[c],f=d,h=void 0;for(h in e){var k;k=e[h];k=(f[0]-d[0])*(k[1]-d[1])-(k[0]-d[0])*(f[1]-d[1]);k=0>k?-1:0<k?1:0;if(-1===k||0===k&&r(d,e[h])>r(d,f))f=e[h]}e=f;e!==b[0]&&b.push(e)}return b}function x(a,b){for(var c=!1,e=-1,d=a.length,f=d-1;++e<d;f=e)(a[e][1]<=b[1]&&b[1]<a[f][1]||a[f][1]<=b[1]&&b[1]<a[e][1])&&b[0]<(a[f][0]-a[e][0])*(b[1]-a[e][1])/(a[f][1]-a[e][1])+a[e][0]&&(c=!c);return c}function A(a,b){if(a&&a.length){if(1===a.length)return x(a[0],b);if(x(a[0],b)){for(var c=1;c<a.length;c++)if(x(a[c],b))return!1;return!0}}return!1}function F(a){return!isNaN(parseFloat(a))&&isFinite(a)}function D(a,b){if(F(a[0][0]))if(F(b[0][0]))for(var c=0;c<a.length-1;c++)for(var e=0;e<b.length-1;e++){var d;a:{var f=a[c],h=a[c+1],k=b[e],l=b[e+1],g=(l[0]-k[0])*(f[1]-k[1])-(l[1]-k[1])*(f[0]-k[0]);d=(h[0]-f[0])*(f[1]-k[1])-(h[1]-f[1])*(f[0]-k[0]);f=(l[1]-k[1])*(h[0]-f[0])-(l[0]-k[0])*(h[1]-f[1]);if(0!==f&&(g/=f,d/=f,0<=g&&1>=g&&0<=d&&1>=d)){d=!0;break a}d=!1}if(d)return!0}else for(c=0;c<b.length;c++){if(D(a,b[c]))return!0}else for(c=0;c<a.length;c++)if(D(a[c],b))return!0;return!1}function E(a){for(var b=[],c=0;c<a.length;c++){var e=a[c].slice();!1===H(e[0],e[e.length-1])&&e.push(e[0]);b.push(e)}return b}function H(a,b){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function U(a,b){if(a.length!==b.length)return!1;for(var c=a.slice().sort(p),e=b.slice().sort(p),d=0;d<c.length;d++){if(c[d].length!==e[d].length)return!1;for(var f=0;f<c.length;f++)if(c[d][f]!==e[d][f])return!1}return!0}function u(a){if(a)switch(a.type){case "Point":return new I(a);case "MultiPoint":return new N(a);case "LineString":return new G(a);case "MultiLineString":return new z(a);case "Polygon":return new v(a);case "MultiPolygon":return new O(a);case "Feature":return new V(a);case "FeatureCollection":return new ba(a);case "GeometryCollection":return new Y(a);default:throw Error("Unknown type: "+a.type);}}function I(a){var b=Array.prototype.slice.call(arguments);if(a&&"Point"===a.type&&a.coordinates)d(this,a);else if(a&&f(a))this.coordinates=a;else if(2<=b.length)this.coordinates=b;else throw"Terraformer: invalid input for Terraformer.Point";this.type="Point"}function N(a){if(a&&"MultiPoint"===a.type&&a.coordinates)d(this,a);else if(f(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.MultiPoint";this.type="MultiPoint"}function G(a){if(a&&"LineString"===a.type&&a.coordinates)d(this,a);else if(f(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.LineString";this.type="LineString"}function z(a){if(a&&"MultiLineString"===a.type&&a.coordinates)d(this,a);else if(f(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.MultiLineString";this.type="MultiLineString"}function v(a){if(a&&"Polygon"===a.type&&a.coordinates)d(this,a);else if(f(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.Polygon";this.type="Polygon"}function O(a){if(a&&"MultiPolygon"===a.type&&a.coordinates)d(this,a);else if(f(a))this.coordinates=a;else throw"Terraformer: invalid input for Terraformer.MultiPolygon";this.type="MultiPolygon"}function V(a){if(a&&"Feature"===a.type)d(this,a);else if(a&&a.type&&a.coordinates)this.geometry=a;else throw"Terraformer: invalid input for Terraformer.Feature";this.type="Feature"}function ba(a){if(a&&"FeatureCollection"===a.type&&a.features)d(this,a);else if(f(a))this.features=a;else throw"Terraformer: invalid input for Terraformer.FeatureCollection";this.type="FeatureCollection"}function Y(a){if(a&&"GeometryCollection"===a.type&&a.geometries)d(this,a);else if(f(a))this.geometries=a;else if(a.coordinates&&a.type)this.type="GeometryCollection",this.geometries=[a];else throw"Terraformer: invalid input for Terraformer.GeometryCollection";this.type="GeometryCollection"}function T(a,b,c){a=k(a);c=c||64;for(var e={type:"Polygon",coordinates:[[]]},d=1;d<=c;d++){var f=360/c*d*Math.PI/180;e.coordinates[0].push([a[0]+b*Math.cos(f),a[1]+b*Math.sin(f)])}e.coordinates=E(e.coordinates);return t(e)}function M(a,b,c){c=c||64;b=b||250;if(!a||2>a.length||!b||!c)throw Error("Terraformer: missing parameter for Terraformer.Circle");d(this,new V({type:"Feature",geometry:T(a,b,c),properties:{radius:b,center:a,steps:c}}))}var C={},Z={type:"link",properties:{href:"http://spatialreference.org/ref/sr-org/6928/ogcwkt/",type:"ogcwkt"}},aa=["length"];u.prototype.toMercator=function(){return m(this)};u.prototype.toGeographic=function(){return t(this)};u.prototype.envelope=function(){return a(this)};u.prototype.bbox=function(){return c(this)};u.prototype.convexHull=function(){var a=[],b,c;if("Point"===this.type)return null;if("LineString"===this.type||"MultiPoint"===this.type)if(this.coordinates&&3<=this.coordinates.length)a=this.coordinates;else return null;else if("Polygon"===this.type||"MultiLineString"===this.type)if(this.coordinates&&0<this.coordinates.length){for(b=0;b<this.coordinates.length;b++)a=a.concat(this.coordinates[b]);if(3>a.length)return null}else return null;else if("MultiPolygon"===this.type)if(this.coordinates&&0<this.coordinates.length){for(b=0;b<this.coordinates.length;b++)for(c=0;c<this.coordinates[b].length;c++)a=a.concat(this.coordinates[b][c]);if(3>a.length)return null}else return null;else if("Feature"===this.type)return(new u(this.geometry)).convexHull();return new v({type:"Polygon",coordinates:E([q(a)])})};u.prototype.toJSON=function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&-1===aa.indexOf(b)&&(a[b]=this[b]);a.bbox=c(this);return a};u.prototype.contains=function(a){return(new u(a)).within(this)};u.prototype.within=function(a){var b,c;"Feature"===a.type&&(a=a.geometry);if("Point"===a.type&&"Point"===this.type)return H(this.coordinates,a.coordinates);if("MultiLineString"===a.type&&"Point"===this.type)for(c=0;c<a.coordinates.length;c++)if(this.within({type:"LineString",coordinates:a.coordinates[c]}))return!0;if(("LineString"===a.type||"MultiPoint"===a.type)&&"Point"===this.type)for(c=0;c<a.coordinates.length;c++){if(this.coordinates.length!==a.coordinates[c].length)return!1;if(H(this.coordinates,a.coordinates[c]))return!0}if("Polygon"===a.type){if("Polygon"===this.type){if(a.coordinates.length===this.coordinates.length)for(c=0;c<this.coordinates.length;c++)if(U(this.coordinates[c],a.coordinates[c]))return!0;return this.coordinates.length&&A(a.coordinates,this.coordinates[0][0])?!D(E(this.coordinates),E(a.coordinates)):!1}if("Point"===this.type)return A(a.coordinates,this.coordinates);if("LineString"===this.type||"MultiPoint"===this.type){if(!this.coordinates||0===this.coordinates.length)return!1;for(c=0;c<this.coordinates.length;c++)if(!1===A(a.coordinates,this.coordinates[c]))return!1;return!0}if("MultiLineString"===this.type){for(c=0;c<this.coordinates.length;c++)if(!1===(new G(this.coordinates[c])).within(a))return!1;return!0}if("MultiPolygon"===this.type){for(c=0;c<this.coordinates.length;c++)if(!1===(new u({type:"Polygon",coordinates:this.coordinates[c]})).within(a))return!1;return!0}}if("MultiPolygon"===a.type)if("Point"===this.type){if(a.coordinates.length)for(c=0;c<a.coordinates.length;c++)if(b=a.coordinates[c],A(b,this.coordinates)&&!1===D([this.coordinates],a.coordinates))return!0}else if("Polygon"===this.type){for(c=0;c<this.coordinates.length;c++)if(a.coordinates[c].length===this.coordinates.length)for(j=0;j<this.coordinates.length;j++)if(U(this.coordinates[j],a.coordinates[c][j]))return!0;if(!1===D(this.coordinates,a.coordinates)&&a.coordinates.length){for(c=0;c<a.coordinates.length;c++)b=a.coordinates[c],b=!1===A(b,this.coordinates[0][0])?!1:!0;return b}}else if("LineString"===this.type||"MultiPoint"===this.type)for(c=0;c<a.coordinates.length;){if(this.within({type:"Polygon",coordinates:a.coordinates[c]}))return!0;break}else{if("MultiLineString"===this.type){for(c=0;c<this.coordinates.length;c++)if(!1===(new G(this.coordinates[c])).within(a))return!1;return!0}if("MultiPolygon"===this.type){for(c=0;c<a.coordinates.length;c++)if(!1===this.within({type:"Polygon",coordinates:a.coordinates[c]}))return!1;return!0}}return!1};u.prototype.intersects=function(a){"Feature"===a.type&&(a=a.geometry);var b=new u(a);if(this.within(a)||b.within(this))return!0;if("Point"!==this.type&&"MultiPoint"!==this.type&&"Point"!==a.type&&"MultiPoint"!==a.type)return D(this.coordinates,a.coordinates);if("Feature"===this.type)return(new u(this.geometry)).intersects(a);g("Type "+this.type+" to "+a.type+" intersection is not supported by intersects");return!1};I.prototype=new u;I.prototype.constructor=I;N.prototype=new u;N.prototype.constructor=N;N.prototype.forEach=function(a){for(var b=0;b<this.coordinates.length;b++)a.apply(this,[this.coordinates[b],b,this.coordinates]);return this};N.prototype.addPoint=function(a){this.coordinates.push(a);return this};N.prototype.insertPoint=function(a,b){this.coordinates.splice(b,0,a);return this};N.prototype.removePoint=function(a){"number"===typeof a?this.coordinates.splice(a,1):this.coordinates.splice(this.coordinates.indexOf(a),1);return this};N.prototype.get=function(a){return new I(this.coordinates[a])};G.prototype=new u;G.prototype.constructor=G;G.prototype.addVertex=function(a){this.coordinates.push(a);return this};G.prototype.insertVertex=function(a,b){this.coordinates.splice(b,0,a);return this};G.prototype.removeVertex=function(a){this.coordinates.splice(a,1);return this};z.prototype=new u;z.prototype.constructor=z;z.prototype.forEach=function(a){for(var b=0;b<this.coordinates.length;b++)a.apply(this,[this.coordinates[b],b,this.coordinates])};z.prototype.get=function(a){return new G(this.coordinates[a])};v.prototype=new u;v.prototype.constructor=v;v.prototype.addVertex=function(a){this.insertVertex(a,this.coordinates[0].length-1);return this};v.prototype.insertVertex=function(a,b){this.coordinates[0].splice(b,0,a);return this};v.prototype.removeVertex=function(a){this.coordinates[0].splice(a,1);return this};v.prototype.close=function(){this.coordinates=E(this.coordinates)};v.prototype.hasHoles=function(){return 1<this.coordinates.length};v.prototype.holes=function(){holes=[];if(this.hasHoles())for(var a=1;a<this.coordinates.length;a++)holes.push(new v([this.coordinates[a]]));return holes};O.prototype=new u;O.prototype.constructor=O;O.prototype.forEach=function(a){for(var b=0;b<this.coordinates.length;b++)a.apply(this,[this.coordinates[b],b,this.coordinates])};O.prototype.get=function(a){return new v(this.coordinates[a])};O.prototype.close=function(){var a=[];this.forEach(function(b){a.push(E(b))});this.coordinates=a;return this};V.prototype=new u;V.prototype.constructor=V;ba.prototype=new u;ba.prototype.constructor=ba;ba.prototype.forEach=function(a){for(var b=0;b<this.features.length;b++)a.apply(this,[this.features[b],b,this.features])};ba.prototype.get=function(a){var b;this.forEach(function(c){c.id===a&&(b=c)});return new V(b)};Y.prototype=new u;Y.prototype.constructor=Y;Y.prototype.forEach=function(a){for(var b=0;b<this.geometries.length;b++)a.apply(this,[this.geometries[b],b,this.geometries])};Y.prototype.get=function(a){return new u(this.geometries[a])};M.prototype=new u;M.prototype.constructor=M;M.prototype.recalculate=function(){this.geometry=T(this.properties.center,this.properties.radius,this.properties.steps);return this};M.prototype.center=function(a){a&&(this.properties.center=a,this.recalculate());return this.properties.center};M.prototype.radius=function(a){a&&(this.properties.radius=a,this.recalculate());return this.properties.radius};M.prototype.steps=function(a){a&&(this.properties.steps=a,this.recalculate());return this.properties.steps};M.prototype.toJSON=function(){return u.prototype.toJSON.call(this)};C.Primitive=u;C.Point=I;C.MultiPoint=N;C.LineString=G;C.MultiLineString=z;C.Polygon=v;C.MultiPolygon=O;C.Feature=V;C.FeatureCollection=ba;C.GeometryCollection=Y;C.Circle=M;C.toMercator=m;C.toGeographic=t;C.Tools={};C.Tools.positionToMercator=k;C.Tools.positionToGeographic=h;C.Tools.applyConverter=n;C.Tools.toMercator=m;C.Tools.toGeographic=t;C.Tools.createCircle=T;C.Tools.calculateBounds=c;C.Tools.calculateEnvelope=a;C.Tools.coordinatesContainPoint=x;C.Tools.polygonContainsPoint=A;C.Tools.arraysIntersectArrays=D;C.Tools.coordinatesContainPoint=x;C.Tools.coordinatesEqual=U;C.Tools.convexHull=q;C.Tools.isConvex=function(a){for(var b,c=0;c<a.length-3;c++){var e=a[c],d=a[c+1],f=a[c+2],d=[d[0]-e[0],d[1]-e[1]],e=f[0]*d[1]-f[1]*d[0]+d[0]*e[1]-d[1]*e[0];if(0===c)b=0>e?!0:!1;else if(b&&0<e||!b&&0>e)return!1}return!0};C.MercatorCRS=Z;C.GeographicCRS={type:"link",properties:{href:"http://spatialreference.org/ref/epsg/4326/ogcwkt/",type:"ogcwkt"}};return C});(function(f,g){"object"===typeof module&&"object"===typeof module.exports&&(exports=module.exports=g(require("L.Terraformer")));if("object"===typeof f.navigator){if(!f.L.Terraformer)throw Error("L.Terraformer.ArcGIS requires the core L.Terraformer library");f.L.Terraformer.ArcGIS=g(f.L.Terraformer)}})(this,function(f){function g(a){var b=0,c=0,e=[],d,f,h;f=a.match(/((\+|\-)[^\+\-]+)/g);h=parseInt(f[0],32);for(var k=1;k<f.length;k+=2)b=a=parseInt(f[k],32)+b,c=d=parseInt(f[k+1],32)+c,e.push([a/h,d/h]);return e}function d(a){var b;a:{b=a[0];for(var c=0;c<b.length;c++)if(b[c]!==a[a.length-1][c]){b=!1;break a}b=!0}b||a.push(a[0]);return a}function c(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function b(a){var b=0,c=0,e=a.length,d=a[c],f;for(c;c<e-1;c++)f=a[c+1],b+=(f[0]-d[0])*(f[1]+d[1]),d=f;return 0<=b}function l(a){var c=[];a=a.slice(0);var e=d(a.shift().slice(0));if(4<=e.length)for(b(e)||e.reverse(),c.push(e),e=0;e<a.length;e++){var f=d(a[e].slice(0));4<=f.length&&(b(f)&&f.reverse(),c.push(f))}return c}function a(e,h){var k={};h=h||{};h.idAttribute=h.idAttribute||void 0;"number"===typeof e.x&&"number"===typeof e.y&&(k.type="Point",k.coordinates=[e.x,e.y],(e.z||e.m)&&k.coordinates.push(e.z),e.m&&k.coordinates.push(e.m));e.points&&(k.type="MultiPoint",k.coordinates=e.points.slice(0));e.paths&&(1===e.paths.length?(k.type="LineString",k.coordinates=e.paths[0].slice(0)):(k.type="MultiLineString",k.coordinates=e.paths.slice(0)));if(e.rings){var l=e.rings.slice(0),k=[],n=[],r,q;for(q=0;q<l.length;q++){var x=d(l[q].slice(0));4>x.length||(b(x)?k.push([x]):n.push(x))}for(x=[];n.length;){q=n.pop();for(var A=!1,l=k.length-1;0<=l;l--){var F=r=k[l][0],D=q;r=f.Tools.arraysIntersectArrays(F,D);F=f.Tools.coordinatesContainPoint(F,D[0]);if(!r&&F){k[l].push(q);A=!0;break}}A||x.push(q)}for(;x.length;){q=x.pop();n=!1;for(l=k.length-1;0<=l;l--)if(r=k[l][0],f.Tools.arraysIntersectArrays(r,q)){k[l].push(q);n=!0;break}n||k.push([q.reverse()])}k=1===k.length?{type:"Polygon",coordinates:k[0]}:{type:"MultiPolygon",coordinates:k}}if(e.compressedGeometry||e.geometry||e.attributes)k.type="Feature",e.compressedGeometry&&(e.geometry={paths:[g(e.compressedGeometry)]}),k.geometry=e.geometry?a(e.geometry):null,k.properties=e.attributes?c(e.attributes):null,e.attributes&&(k.id=e.attributes[h.idAttribute]||e.attributes.OBJECTID||e.attributes.FID);(n=e.geometry?e.geometry.spatialReference:e.spatialReference)&&102100===n.wkid&&(k=f.toGeographic(k));return new f.Primitive(k)}function e(a,b){var d;b=b||{};var h=b.idAttribute||"OBJECTID";d=b.sr?{wkid:b.sr}:a&&a.crs===f.MercatorCRS?{wkid:102100}:{wkid:4326};var k={};switch(a.type){case "Point":k.x=a.coordinates[0];k.y=a.coordinates[1];a.coordinates[2]&&(k.z=a.coordinates[2]);a.coordinates[3]&&(k.m=a.coordinates[3]);k.spatialReference=d;break;case "MultiPoint":k.points=a.coordinates.slice(0);k.spatialReference=d;break;case "LineString":k.paths=[a.coordinates.slice(0)];k.spatialReference=d;break;case "MultiLineString":k.paths=a.coordinates.slice(0);k.spatialReference=d;break;case "Polygon":k.rings=l(a.coordinates.slice(0));k.spatialReference=d;break;case "MultiPolygon":for(var h=k,g=a.coordinates.slice(0),n=[],x=0;x<g.length;x++)for(var A=l(g[x]),F=A.length-1;0<=F;F--){var D=A[F].slice(0);n.push(D)}h.rings=n;k.spatialReference=d;break;case "Feature":a.geometry&&(k.geometry=e(a.geometry,b));k.attributes=a.properties?c(a.properties):{};a.id&&(k.attributes[h]=a.id);break;case "FeatureCollection":k=[];for(d=0;d<a.features.length;d++)k.push(e(a.features[d],b));break;case "GeometryCollection":for(k=[],d=0;d<a.geometries.length;d++)k.push(e(a.geometries[d],b))}return k}var h={};h.parse=a;h.convert=e;h.toGeoJSON=a;h.fromGeoJSON=e;h.parseCompressedGeometry=function(a){return new f.LineString(g(a))};return h});(function(f,g){if("object"===typeof module&&"object"===typeof module.exports)exports=module.exports=g(require("L.Terraformer"));else if("object"===typeof navigator){if(!f.L.Terraformer)throw Error("L.Terraformer.WKT requires the core L.Terraformer library. ");f.L.Terraformer.WKT=g(f.L.Terraformer)}})(this,function(f){function g(a){this.data=[a];this.type="PointArray"}function d(a){this.data=a;this.type="Ring"}function c(a){this.data=[a];this.type="RingList"}function b(a){this.data=[a];this.type="PolygonList"}function l(a){for(var b=[],c="",e=0;e<a.length;e++)b.push(a[e].join(" "));return c+="("+b.join(", ")+")"}var a={},e=function(){function a(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,point:4,EOF:5,linestring:6,polygon:7,multipoint:8,multilinestring:9,multipolygon:10,coordinate:11,DOUBLE_TOK:12,ptarray:13,COMMA:14,ring_list:15,ring:16,"(":17,")":18,POINT:19,Z:20,ZM:21,M:22,EMPTY:23,point_untagged:24,polygon_list:25,polygon_untagged:26,point_list:27,LINESTRING:28,POLYGON:29,MULTIPOINT:30,MULTILINESTRING:31,MULTIPOLYGON:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"DOUBLE_TOK",14:"COMMA",17:"(",18:")",19:"POINT",20:"Z",21:"ZM",22:"M",23:"EMPTY",28:"LINESTRING",29:"POLYGON",30:"MULTIPOINT",31:"MULTILINESTRING",32:"MULTIPOLYGON"},productions_:[0,[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[11,2],[11,3],[11,4],[13,3],[13,1],[15,3],[15,1],[16,3],[4,4],[4,5],[4,5],[4,5],[4,2],[24,1],[24,3],[25,3],[25,1],[26,3],[27,3],[27,1],[6,4],[6,5],[6,5],[6,5],[6,2],[7,4],[7,5],[7,5],[7,5],[7,2],[8,4],[8,5],[8,5],[8,5],[8,2],[9,4],[9,5],[9,5],[9,5],[9,2],[10,4],[10,5],[10,5],[10,5],[10,2]],performAction:function(a,e,f,h,k,l,n){a=l.length-1;switch(k){case 1:return l[a-1];case 2:return l[a-1];case 3:return l[a-1];case 4:return l[a-1];case 5:return l[a-1];case 6:return l[a-1];case 7:this.$=new g([Number(l[a-1]),Number(l[a])]);break;case 8:this.$=new g([Number(l[a-2]),Number(l[a-1]),Number(l[a])]);break;case 9:this.$=new g([Number(l[a-3]),Number(l[a-2]),Number(l[a-1]),Number(l[a])]);break;case 10:this.$=l[a-2].addPoint(l[a]);break;case 11:this.$=l[a];break;case 12:this.$=l[a-2].addRing(l[a]);break;case 13:this.$=new c(l[a]);break;case 14:this.$=new d(l[a-1]);break;case 15:this.$={type:"Point",coordinates:l[a-1].data[0]};break;case 16:this.$={type:"Point",coordinates:l[a-1].data[0],properties:{z:!0}};break;case 17:this.$={type:"Point",coordinates:l[a-1].data[0],properties:{z:!0,m:!0}};break;case 18:this.$={type:"Point",coordinates:l[a-1].data[0],properties:{m:!0}};break;case 19:this.$={type:"Point",coordinates:[]};break;case 20:this.$=l[a];break;case 21:this.$=l[a-1];break;case 22:this.$=l[a-2].addPolygon(l[a]);break;case 23:this.$=new b(l[a]);break;case 24:this.$=l[a-1];break;case 25:this.$=l[a-2].addPoint(l[a]);break;case 26:this.$=l[a];break;case 27:this.$={type:"LineString",coordinates:l[a-1].data};break;case 28:this.$={type:"LineString",coordinates:l[a-1].data,properties:{z:!0}};break;case 29:this.$={type:"LineString",coordinates:l[a-1].data,properties:{m:!0}};break;case 30:this.$={type:"LineString",coordinates:l[a-1].data,properties:{z:!0,m:!0}};break;case 31:this.$={type:"LineString",coordinates:[]};break;case 32:this.$={type:"Polygon",coordinates:l[a-1].toJSON()};break;case 33:this.$={type:"Polygon",coordinates:l[a-1].toJSON(),properties:{z:!0}};break;case 34:this.$={type:"Polygon",coordinates:l[a-1].toJSON(),properties:{m:!0}};break;case 35:this.$={type:"Polygon",coordinates:l[a-1].toJSON(),properties:{z:!0,m:!0}};break;case 36:this.$={type:"Polygon",coordinates:[]};break;case 37:this.$={type:"MultiPoint",coordinates:l[a-1].data};break;case 38:this.$={type:"MultiPoint",coordinates:l[a-1].data,properties:{z:!0}};break;case 39:this.$={type:"MultiPoint",coordinates:l[a-1].data,properties:{m:!0}};break;case 40:this.$={type:"MultiPoint",coordinates:l[a-1].data,properties:{z:!0,m:!0}};break;case 41:this.$={type:"MultiPoint",coordinates:[]};break;case 42:this.$={type:"MultiLineString",coordinates:l[a-1].toJSON()};break;case 43:this.$={type:"MultiLineString",coordinates:l[a-1].toJSON(),properties:{z:!0}};break;case 44:this.$={type:"MultiLineString",coordinates:l[a-1].toJSON(),properties:{m:!0}};break;case 45:this.$={type:"MultiLineString",coordinates:l[a-1].toJSON(),properties:{z:!0,m:!0}};break;case 46:this.$={type:"MultiLineString",coordinates:[]};break;case 47:this.$={type:"MultiPolygon",coordinates:l[a-1].toJSON()};break;case 48:this.$={type:"MultiPolygon",coordinates:l[a-1].toJSON(),properties:{z:!0}};break;case 49:this.$={type:"MultiPolygon",coordinates:l[a-1].toJSON(),properties:{m:!0}};break;case 50:this.$={type:"MultiPolygon",coordinates:l[a-1].toJSON(),properties:{z:!0,m:!0}};break;case 51:this.$={type:"MultiPolygon",coordinates:[]}}},table:[{3:1,4:2,6:3,7:4,8:5,9:6,10:7,19:[1,8],28:[1,9],29:[1,10],30:[1,11],31:[1,12],32:[1,13]},{1:[3]},{5:[1,14]},{5:[1,15]},{5:[1,16]},{5:[1,17]},{5:[1,18]},{5:[1,19]},{17:[1,20],20:[1,21],21:[1,22],22:[1,23],23:[1,24]},{17:[1,25],20:[1,26],21:[1,28],22:[1,27],23:[1,29]},{17:[1,30],20:[1,31],21:[1,33],22:[1,32],23:[1,34]},{17:[1,35],20:[1,36],21:[1,38],22:[1,37],23:[1,39]},{17:[1,40],20:[1,41],21:[1,43],22:[1,42],23:[1,44]},{17:[1,45],20:[1,46],21:[1,48],22:[1,47],23:[1,49]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4]},{1:[2,5]},{1:[2,6]},{11:51,12:[1,52],13:50},{17:[1,53]},{17:[1,54]},{17:[1,55]},{5:[2,19]},{11:58,12:[1,52],17:[1,59],24:57,27:56},{17:[1,60]},{17:[1,61]},{17:[1,62]},{5:[2,31]},{15:63,16:64,17:[1,65]},{17:[1,66]},{17:[1,67]},{17:[1,68]},{5:[2,36]},{11:58,12:[1,52],17:[1,59],24:57,27:69},{17:[1,70]},{17:[1,71]},{17:[1,72]},{5:[2,41]},{15:73,16:64,17:[1,65]},{17:[1,74]},{17:[1,75]},{17:[1,76]},{5:[2,46]},{17:[1,79],25:77,26:78},{17:[1,80]},{17:[1,81]},{17:[1,82]},{5:[2,51]},{14:[1,84],18:[1,83]},{14:[2,11],18:[2,11]},{12:[1,85]},{11:51,12:[1,52],13:86},{11:51,12:[1,52],13:87},{11:51,12:[1,52],13:88},{14:[1,90],18:[1,89]},{14:[2,26],18:[2,26]},{14:[2,20],18:[2,20]},{11:91,12:[1,52]},{11:58,12:[1,52],17:[1,59],24:57,27:92},{11:58,12:[1,52],17:[1,59],24:57,27:93},{11:58,12:[1,52],17:[1,59],24:57,27:94},{14:[1,96],18:[1,95]},{14:[2,13],18:[2,13]},{11:51,12:[1,52],13:97},{15:98,16:64,17:[1,65]},{15:99,16:64,17:[1,65]},{15:100,16:64,17:[1,65]},{14:[1,90],18:[1,101]},{11:58,12:[1,52],17:[1,59],24:57,27:102},{11:58,12:[1,52],17:[1,59],24:57,27:103},{11:58,12:[1,52],17:[1,59],24:57,27:104},{14:[1,96],18:[1,105]},{15:106,16:64,17:[1,65]},{15:107,16:64,17:[1,65]},{15:108,16:64,17:[1,65]},{14:[1,110],18:[1,109]},{14:[2,23],18:[2,23]},{15:111,16:64,17:[1,65]},{17:[1,79],25:112,26:78},{17:[1,79],25:113,26:78},{17:[1,79],25:114,26:78},{5:[2,15]},{11:115,12:[1,52]},{12:[1,116],14:[2,7],18:[2,7]},{14:[1,84],18:[1,117]},{14:[1,84],18:[1,118]},{14:[1,84],18:[1,119]},{5:[2,27]},{11:58,12:[1,52],17:[1,59],24:120},{18:[1,121]},{14:[1,90],18:[1,122]},{14:[1,90],18:[1,123]},{14:[1,90],18:[1,124]},{5:[2,32]},{16:125,17:[1,65]},{14:[1,84],18:[1,126]},{14:[1,96],18:[1,127]},{14:[1,96],18:[1,128]},{14:[1,96],18:[1,129]},{5:[2,37]},{14:[1,90],18:[1,130]},{14:[1,90],18:[1,131]},{14:[1,90],18:[1,132]},{5:[2,42]},{14:[1,96],18:[1,133]},{14:[1,96],18:[1,134]},{14:[1,96],18:[1,135]},{5:[2,47]},{17:[1,79],26:136},{14:[1,96],18:[1,137]},{14:[1,110],18:[1,138]},{14:[1,110],18:[1,139]},{14:[1,110],18:[1,140]},{14:[2,10],18:[2,10]},{12:[1,141],14:[2,8],18:[2,8]},{5:[2,16]},{5:[2,17]},{5:[2,18]},{14:[2,25],18:[2,25]},{14:[2,21],18:[2,21]},{5:[2,28]},{5:[2,29]},{5:[2,30]},{14:[2,12],18:[2,12]},{14:[2,14],18:[2,14]},{5:[2,33]},{5:[2,34]},{5:[2,35]},{5:[2,38]},{5:[2,39]},{5:[2,40]},{5:[2,43]},{5:[2,44]},{5:[2,45]},{14:[2,22],18:[2,22]},{14:[2,24],18:[2,24]},{5:[2,48]},{5:[2,49]},{5:[2,50]},{14:[2,9],18:[2,9]}],defaultActions:{14:[2,1],15:[2,2],16:[2,3],17:[2,4],18:[2,5],19:[2,6],24:[2,19],29:[2,31],34:[2,36],39:[2,41],44:[2,46],49:[2,51],83:[2,15],89:[2,27],95:[2,32],101:[2,37],105:[2,42],109:[2,47],117:[2,16],118:[2,17],119:[2,18],122:[2,28],123:[2,29],124:[2,30],127:[2,33],128:[2,34],129:[2,35],130:[2,38],131:[2,39],132:[2,40],133:[2,43],134:[2,44],135:[2,45],138:[2,48],139:[2,49],140:[2,50]},parseError:function(a,b){throw Error(a);},parse:function(a){var b=[0],c=[null],e=[],d=this.table,f="",h=0,l=0,k=0;this.lexer.setInput(a);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});a=this.lexer.yylloc;e.push(a);var g=this.lexer.options&&this.lexer.options.ranges;"function"===typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var n,m,u,I,N={},G,z;;){u=b[b.length-1];if(this.defaultActions[u])I=this.defaultActions[u];else{if(null===n||"undefined"==typeof n)n=this.lexer.lex()||1,"number"!==typeof n&&(n=this.symbols_[n]||n);I=d[u]&&d[u][n]}if("undefined"===typeof I||!I.length||!I[0]){var v;if(!k){z=[];for(G in d[u])this.terminals_[G]&&2<G&&z.push("'"+this.terminals_[G]+"'");v=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+z.join(", ")+", got '"+(this.terminals_[n]||n)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==n?"end of input":"'"+(this.terminals_[n]||n)+"'");this.parseError(v,{text:this.lexer.match,token:this.terminals_[n]||n,line:this.lexer.yylineno,loc:a,expected:z})}}if(I[0]instanceof Array&&1<I.length)throw Error("Parse Error: multiple actions possible at state: "+u+", token: "+n);switch(I[0]){case 1:b.push(n);c.push(this.lexer.yytext);e.push(this.lexer.yylloc);b.push(I[1]);n=null;m?(n=m,m=null):(l=this.lexer.yyleng,f=this.lexer.yytext,h=this.lexer.yylineno,a=this.lexer.yylloc,0<k&&k--);break;case 2:z=this.productions_[I[1]][1];N.$=c[c.length-z];N._$={first_line:e[e.length-(z||1)].first_line,last_line:e[e.length-1].last_line,first_column:e[e.length-(z||1)].first_column,last_column:e[e.length-1].last_column};g&&(N._$.range=[e[e.length-(z||1)].range[0],e[e.length-1].range[1]]);u=this.performAction.call(N,f,l,h,this.yy,I[1],c,e);if("undefined"!==typeof u)return u;z&&(b=b.slice(0,-2*z),c=c.slice(0,-1*z),e=e.slice(0,-1*z));b.push(this.productions_[I[1]][0]);c.push(N.$);e.push(N._$);I=d[b[b.length-2]][b[b.length-1]];b.push(I);break;case 3:return!0}}}};void 0;var f=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a);},setInput:function(a){this._input=a;this._more=this._less=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b-1);this.offset-=b;a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===a.length?this.yylloc.first_column:0)+a[a.length-c.length].length-c[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]);return this},more:function(){this._more=!0;return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c;this._more||(this.match=this.yytext="");for(var e=this._currentRules(),d=0;d<e.length&&(!(b=this._input.match(this.rules[e[d]]))||a&&!(b[0].length>a[0].length)||(a=b,c=d,this.options.flex));d++);if(a){if(b=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=b.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:b?b[b.length-1].length-b[b.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];a=this.performAction.call(this,this.yy,this,e[c],this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(a)return a}else return""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!==typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)},options:{},performAction:function(a,b,c,e){switch(c){case 1:return 17;case 2:return 18;case 3:return 12;case 4:return 19;case 5:return 28;case 6:return 29;case 7:return 30;case 8:return 31;case 9:return 32;case 10:return 14;case 11:return 23;case 12:return 22;case 13:return 20;case 14:return 21;case 15:return 5;case 16:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:\()/,/^(?:\))/,/^(?:-?[0-9]+(\.[0-9]+)?([eE][\-\+]?[0-9]+)?)/,/^(?:POINT\b)/,/^(?:LINESTRING\b)/,/^(?:POLYGON\b)/,/^(?:MULTIPOINT\b)/,/^(?:MULTILINESTRING\b)/,/^(?:MULTIPOLYGON\b)/,/^(?:,)/,/^(?:EMPTY\b)/,/^(?:M\b)/,/^(?:Z\b)/,/^(?:ZM\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],inclusive:!0}}}}();e.lexer=f;a.prototype=e;e.Parser=a;return new a}();g.prototype.addPoint=function(a){"PointArray"===a.type?this.data=this.data.concat(a.data):this.data.push(a);return this};g.prototype.toJSON=function(){return this.data};d.prototype.toJSON=function(){for(var a=[],b=0;b<this.data.data.length;b++)a.push(this.data.data[b]);return a};c.prototype.addRing=function(a){this.data.push(a);return this};c.prototype.toJSON=function(){for(var a=[],b=0;b<this.data.length;b++)a.push(this.data[b].toJSON());return a};b.prototype.addPolygon=function(a){this.data.push(a);return this};b.prototype.toJSON=function(){for(var a=[],b=0;b<this.data.length;b++)a=a.concat([this.data[b].toJSON()]);return a};a.parser=e;a.Parser=e.Parser;a.parse=function(a){var b;try{b=e.parse(a)}catch(n){throw Error("Unable to parse: "+n);}return f.Primitive(b)};a.convert=function(a){switch(a.type){case "Point":var b="POINT ";void 0===a.coordinates||0===a.coordinates.length?a=b+"EMPTY":(3===a.coordinates.length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates.length&&(b+="ZM "),a=b+="("+a.coordinates.join(" ")+")");return a;case "LineString":return b="LINESTRING ",void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length?a=b+"EMPTY":(3===a.coordinates[0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0].length&&(b+="ZM "),a=b+=l(a.coordinates)),a;case "Polygon":b="POLYGON ";if(void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length)a=b+"EMPTY";else{3===a.coordinates[0][0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0][0].length&&(b+="ZM ");for(var b=b+"(",c=[],e=0;e<a.coordinates.length;e++)c.push(l(a.coordinates[e]));b+=c.join(", ");a=b+")"}return a;case "MultiPoint":return b="MULTIPOINT ",void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length?a=b+"EMPTY":(3===a.coordinates[0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0].length&&(b+="ZM "),a=b+=l(a.coordinates)),a;case "MultiLineString":b="MULTILINESTRING ";if(void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length)a=b+"EMPTY";else{3===a.coordinates[0][0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0][0].length&&(b+="ZM ");b+="(";c=[];for(e=0;e<a.coordinates.length;e++)c.push(l(a.coordinates[e]));b+=c.join(", ");a=b+")"}return a;case "MultiPolygon":b="MULTIPOLYGON ";if(void 0===a.coordinates||0===a.coordinates.length||0===a.coordinates[0].length)a=b+"EMPTY";else{3===a.coordinates[0][0][0].length?b=a.properties&&!0===a.properties.m?b+"M ":b+"Z ":4===a.coordinates[0][0][0].length&&(b+="ZM ");b+="(";c=[];for(e=0;e<a.coordinates.length;e++){for(var d="(",f=[],h=0;h<a.coordinates[e].length;h++)f.push(l(a.coordinates[e][h]));d+=f.join(", ");d+=")";c.push(d)}b+=c.join(", ");a=b+")"}return a;default:throw Error("Unknown Type: "+a.type);}};return a});(function(f){var g;if("function"===typeof define&&define.amd)define(["leaflet"],f);else if("undefined"!==typeof module)g=require("leaflet"),module.exports=f(g);else{if("undefined"===typeof window.L)throw Error("Leaflet must be loaded first");f(window.L)}})(function(f){f.Control.Zoomslider=function(){var g=f.Draggable.extend({initialize:function(d,c,b){f.Draggable.prototype.initialize.call(this,d,d);this._element=d;this._stepHeight=c;this._knobHeight=b;this.on("predrag",function(){this._newPos.x=0;this._newPos.y=this._adjust(this._newPos.y)},this)},_adjust:function(d){d=Math.round(this._toValue(d));d=Math.max(0,Math.min(this._maxValue,d));return this._toY(d)},_toY:function(d){return this._k*d+this._m},_toValue:function(d){return(d-this._m)/this._k},setSteps:function(d){var c=d*this._stepHeight;this._maxValue=d-1;this._k=-this._stepHeight;this._m=c-(this._stepHeight+this._knobHeight)/2},setPosition:function(d){f.DomUtil.setPosition(this._element,f.point(0,this._adjust(d)))},setValue:function(d){this.setPosition(this._toY(d))},getValue:function(){return this._toValue(f.DomUtil.getPosition(this._element).y)}});return f.Control.extend({options:{position:"bottomright",stepHeight:8,knobHeight:6,styleNS:"leaflet-control-zoomslider"},onAdd:function(d){this._map=d;this._ui=this._createUI();this._knob=new g(this._ui.knob,this.options.stepHeight,this.options.knobHeight);d.whenReady(this._initKnob,this).whenReady(this._initEvents,this).whenReady(this._updateSize,this).whenReady(this._updateKnobValue,this).whenReady(this._updateDisabled,this);return this._ui.bar},onRemove:function(d){d.off("zoomlevelschange",this._updateSize,this).off("zoomend zoomlevelschange",this._updateKnobValue,this).off("zoomend zoomlevelschange",this._updateDisabled,this)},_createUI:function(){var d={},c=this.options.styleNS;d.bar=f.DomUtil.create("div",c+" leaflet-bar");d.zoomIn=this._createZoomBtn("in","top",d.bar);d.wrap=f.DomUtil.create("div",c+"-wrap leaflet-bar-part",d.bar);d.tip=f.DomUtil.create("div","leaflet-bar-tip",d.bar);d.zoomOut=this._createZoomBtn("out","bottom",d.bar);d.body=f.DomUtil.create("div",c+"-body",d.wrap);d.knob=f.DomUtil.create("div",c+"-knob");d.tip1=f.DomUtil.create("div",c+"-tip1",d.tip);d.tip2=f.DomUtil.create("div",c+"-tip2",d.tip);d.tip3=f.DomUtil.create("div",c+"-tip3",d.tip);d.tip4=f.DomUtil.create("div",c+"-tip4",d.tip);f.DomEvent.disableClickPropagation(d.bar);f.DomEvent.disableClickPropagation(d.knob);return d},_createZoomBtn:function(d,c,b){c=f.DomUtil.create("a",this.options.styleNS+"-"+d+" leaflet-bar-part leaflet-bar-part-"+c,b);c.href="#";c.title="Zoom "+d;f.DomEvent.on(c,"click",f.DomEvent.preventDefault);return c},_initKnob:function(){this._knob.enable();this._ui.body.appendChild(this._ui.knob)},_initEvents:function(){this._map.on("zoomlevelschange",this._updateSize,this).on("zoomend zoomlevelschange",this._updateKnobValue,this).on("zoomend zoomlevelschange",this._updateDisabled,this);f.DomEvent.on(this._ui.body,"click",this._onSliderClick,this);f.DomEvent.on(this._ui.wrap,"mouseover",this._onSliderHover,this);f.DomEvent.on(this._ui.tip,"mouseover",this._onSliderHover,this);f.DomEvent.on(this._ui.wrap,"mouseout",this._onSliderMouseOut,this);f.DomEvent.on(this._ui.zoomIn,"click",this._zoomIn,this);f.DomEvent.on(this._ui.zoomOut,"click",this._zoomOut,this);f.DomEvent.on(this._ui.tip1,"click",this._zoom1,this);f.DomEvent.on(this._ui.tip2,"click",this._zoom2,this);f.DomEvent.on(this._ui.tip3,"click",this._zoom3,this);f.DomEvent.on(this._ui.tip4,"click",this._zoom4,this);this._knob.on("dragend",this._updateMapZoom,this)},_onSliderHover:function(d){this._ui.tip.style.display="inline"},_onSliderMouseOut:function(d){this._ui.tip.style.display="none"},_onSliderClick:function(d){d=f.DomEvent.getMousePosition(d.touches&&1===d.touches.length?d.touches[0]:d,this._ui.body).y;this._knob.setPosition(d);this._updateMapZoom()},_zoom1:function(d){this._map.setView([29.8627,121.556],16)},_zoom2:function(d){this._map.setView([29.8627,121.556],11)},_zoom3:function(d){this._map.setView([29.8627,121.556],7)},_zoom4:function(d){this._map.setView([29.8627,104.556],4)},_zoomIn:function(d){this._map.zoomIn(d.shiftKey?3:1)},_zoomOut:function(d){this._map.zoomOut(d.shiftKey?3:1)},_zoomLevels:function(){var d=this._map.getMaxZoom()-this._map.getMinZoom()+1;return Infinity>d?d:0},_toZoomLevel:function(d){return d+this._map.getMinZoom()},_toValue:function(d){return d-this._map.getMinZoom()},_updateSize:function(){var d=this._zoomLevels();this._ui.body.style.height=this.options.stepHeight*d+"px";this._knob.setSteps(d)},_updateMapZoom:function(){this._map.setZoom(this._toZoomLevel(this._knob.getValue()))},_updateKnobValue:function(){this._knob.setValue(this._toValue(this._map.getZoom()))},_updateDisabled:function(){var d=this._map.getZoom(),c=this.options.styleNS+"-disabled";f.DomUtil.removeClass(this._ui.zoomIn,c);f.DomUtil.removeClass(this._ui.zoomOut,c);d===this._map.getMinZoom()&&f.DomUtil.addClass(this._ui.zoomOut,c);d===this._map.getMaxZoom()&&f.DomUtil.addClass(this._ui.zoomIn,c)}})}();f.Map.addInitHook(function(){this.options.zoomsliderControl&&(this.zoomsliderControl=new f.Control.Zoomslider,this.addControl(this.zoomsliderControl))});f.control.zoomslider=function(g){return new f.Control.Zoomslider(g)}});(function(f){var g;if("function"===typeof define&&define.amd)define(["leaflet"],f);else if("object"===typeof module&&"object"===typeof module.exports)g=require("leaflet"),module.exports=f(g);else{if("undefined"===typeof window.L)throw Error("Leaflet must be loaded first");f(window.L)}})(function(f){f.Map.mergeOptions({contextmenuItems:[]});f.Map.ContextMenu=f.Handler.extend({_touchstart:f.Browser.msPointer?"MSPointerDown":f.Browser.pointer?"pointerdown":"touchstart",statics:{BASE_CLS:"leaflet-contextmenu"},initialize:function(a){f.Handler.prototype.initialize.call(this,a);this._items=[];this._visible=!1;var b=this._container=f.DomUtil.create("div",f.Map.ContextMenu.BASE_CLS,a._container);b.style.zIndex=1E4;b.style.position="absolute";a.options.contextmenuWidth&&(b.style.width=a.options.contextmenuWidth+"px");this._createItems();f.DomEvent.on(b,"click",f.DomEvent.stop).on(b,"mousedown",f.DomEvent.stop).on(b,"dblclick",f.DomEvent.stop).on(b,"contextmenu",f.DomEvent.stop)},addHooks:function(){var a=this._map.getContainer();f.DomEvent.on(a,"mouseleave",this._hide,this).on(document,"keydown",this._onKeyDown,this);if(f.Browser.touch)f.DomEvent.on(document,this._touchstart,this._hide,this);this._map.on({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},removeHooks:function(){var a=this._map.getContainer();f.DomEvent.off(a,"mouseleave",this._hide,this).off(document,"keydown",this._onKeyDown,this);f.Browser.touch&&f.DomEvent.off(document,this._touchstart,this._hide,this);this._map.off({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},showAt:function(a,b){a instanceof f.LatLng&&(a=this._map.latLngToContainerPoint(a));this._showAtPoint(a,b)},hide:function(){this._hide()},addItem:function(a){return this.insertItem(a)},insertItem:function(a,b){b=void 0!==b?b:this._items.length;var c=this._createItem(this._container,a,b);this._items.push(c);this._sizeChanged=!0;this._map.fire("contextmenu.additem",{contextmenu:this,el:c.el,index:b});return c.el},removeItem:function(a){var b=this._container;isNaN(a)||(a=b.children[a]);return a?(this._removeItem(f.Util.stamp(a)),this._sizeChanged=!0,this._map.fire("contextmenu.removeitem",{contextmenu:this,el:a}),a):null},removeAllItems:function(){for(var a=this._container.children,b;a.length;)b=a[0],this._removeItem(f.Util.stamp(b));return a},hideAllItems:function(){var a,b,c;b=0;for(c=this._items.length;b<c;b++)a=this._items[b],a.el.style.display="none"},showAllItems:function(){var a,b,c;b=0;for(c=this._items.length;b<c;b++)a=this._items[b],a.el.style.display=""},setDisabled:function(a,b){var c=this._container,e=f.Map.ContextMenu.BASE_CLS+"-item";isNaN(a)||(a=c.children[a]);a&&f.DomUtil.hasClass(a,e)&&(b?(f.DomUtil.addClass(a,e+"-disabled"),this._map.fire("contextmenu.disableitem",{contextmenu:this,el:a})):(f.DomUtil.removeClass(a,e+"-disabled"),this._map.fire("contextmenu.enableitem",{contextmenu:this,el:a})))},isVisible:function(){return this._visible},_createItems:function(){var a=this._map.options.contextmenuItems,b,c;b=0;for(c=a.length;b<c;b++)this._items.push(this._createItem(this._container,a[b]))},_createItem:function(a,b,c){if(b.separator||"-"===b)return this._createSeparator(a,c);var e=f.Map.ContextMenu.BASE_CLS+"-item";a=this._insertElementAt("a",b.disabled?e+" "+e+"-disabled":e,a,c);c=this._createEventHandler(a,b.callback,b.context,b.hideOnSelect);var e=this._getIcon(b),d=this._getIconCls(b),l="";e?l='\x3cimg class\x3d"'+f.Map.ContextMenu.BASE_CLS+'-icon" src\x3d"'+e+'"/\x3e':d&&(l='\x3cspan class\x3d"'+f.Map.ContextMenu.BASE_CLS+"-icon "+d+'"\x3e\x3c/span\x3e');a.innerHTML=l+b.text;a.href="#";f.DomEvent.on(a,"mouseover",this._onItemMouseOver,this).on(a,"mouseout",this._onItemMouseOut,this).on(a,"mousedown",f.DomEvent.stopPropagation).on(a,"click",c);if(f.Browser.touch)f.DomEvent.on(a,this._touchstart,f.DomEvent.stopPropagation);if(!f.Browser.pointer)f.DomEvent.on(a,"click",this._onItemMouseOut,this);return{id:f.Util.stamp(a),el:a,callback:c}},_removeItem:function(a){var b,c,d;c=0;for(d=this._items.length;c<d;c++)if(b=this._items[c],b.id===a){a=b.el;if(d=b.callback)if(f.DomEvent.off(a,"mouseover",this._onItemMouseOver,this).off(a,"mouseover",this._onItemMouseOut,this).off(a,"mousedown",f.DomEvent.stopPropagation).off(a,"click",d),f.Browser.touch&&f.DomEvent.off(a,this._touchstart,f.DomEvent.stopPropagation),!f.Browser.pointer)f.DomEvent.on(a,"click",this._onItemMouseOut,this);this._container.removeChild(a);this._items.splice(c,1);return b}return null},_createSeparator:function(a,b){var c=this._insertElementAt("div",f.Map.ContextMenu.BASE_CLS+"-separator",a,b);return{id:f.Util.stamp(c),el:c}},_createEventHandler:function(a,b,c,d){var e=this,l=this._map,h=f.Map.ContextMenu.BASE_CLS+"-item-disabled";d=void 0!==d?d:!0;return function(k){f.DomUtil.hasClass(a,h)||(d&&e._hide(),b&&b.call(c||l,e._showLocation),e._map.fire("contextmenu.select",{contextmenu:e,el:a}))}},_insertElementAt:function(a,b,c,d){var e;a=document.createElement(a);a.className=b;void 0!==d&&(e=c.children[d]);e?c.insertBefore(a,e):c.appendChild(a);return a},_show:function(a){this._showAtPoint(a.containerPoint,a)},_showAtPoint:function(a,b){if(this._items.length){var c=this._map,e=c.containerPointToLayerPoint(a),c=c.layerPointToLatLng(e),d=f.extend(b||{},{contextmenu:this});this._showLocation={latlng:c,layerPoint:e,containerPoint:a};b&&b.relatedTarget&&(this._showLocation.relatedTarget=b.relatedTarget);this._setPosition(a);this._visible||(this._container.style.display="block",this._visible=!0);this._map.fire("contextmenu.show",d)}},_hide:function(){this._visible&&(this._visible=!1,this._container.style.display="none",this._map.fire("contextmenu.hide",{contextmenu:this}))},_getIcon:function(a){return f.Browser.retina&&a.retinaIcon||a.icon},_getIconCls:function(a){return f.Browser.retina&&a.retinaIconCls||a.iconCls},_setPosition:function(a){var b=this._map.getSize(),c=this._container,d=this._getElementSize(c),l;this._map.options.contextmenuAnchor&&(l=f.point(this._map.options.contextmenuAnchor),a=a.add(l));c._leaflet_pos=a;a.x+d.x>b.x?(c.style.left="auto",c.style.right=Math.min(Math.max(b.x-a.x,0),b.x-d.x-1)+"px"):(c.style.left=Math.max(a.x,0)+"px",c.style.right="auto");a.y+d.y>b.y?(c.style.top="auto",c.style.bottom=Math.min(Math.max(b.y-a.y,0),b.y-d.y-1)+"px"):(c.style.top=Math.max(a.y,0)+"px",c.style.bottom="auto")},_getElementSize:function(a){var b=this._size,c=a.style.display;if(!b||this._sizeChanged)b={},a.style.left="-999999px",a.style.right="auto",a.style.display="block",b.x=a.offsetWidth,b.y=a.offsetHeight,a.style.left="auto",a.style.display=c,this._sizeChanged=!1;return b},_onKeyDown:function(a){27===a.keyCode&&this._hide()},_onItemMouseOver:function(a){f.DomUtil.addClass(a.target||a.srcElement,"over")},_onItemMouseOut:function(a){f.DomUtil.removeClass(a.target||a.srcElement,"over")}});f.Map.addInitHook("addHandler","contextmenu",f.Map.ContextMenu);f.Mixin.ContextMenu={bindContextMenu:function(a){f.setOptions(this,a);this._initContextMenu();return this},unbindContextMenu:function(){this.off("contextmenu",this._showContextMenu,this);return this},addContextMenuItem:function(a){this.options.contextmenuItems.push(a)},removeContextMenuItemWithIndex:function(a){for(var b=[],c=0;c<this.options.contextmenuItems.length;c++)this.options.contextmenuItems[c].index==a&&b.push(c);for(a=b.pop();void 0!==a;)this.options.contextmenuItems.splice(a,1),a=b.pop()},replaceContextMenuItem:function(a){this.removeContextMenuItemWithIndex(a.index);this.addContextMenuItem(a)},_initContextMenu:function(){this._items=[];this.on("contextmenu",this._showContextMenu,this)},_showContextMenu:function(a){var b,c,d,l;if(this._map.contextmenu){b=f.extend({relatedTarget:this},a);c=this._map.mouseEventToContainerPoint(a.originalEvent);this.options.contextmenuInheritItems||this._map.contextmenu.hideAllItems();d=0;for(l=this.options.contextmenuItems.length;d<l;d++)a=this.options.contextmenuItems[d],this._items.push(this._map.contextmenu.insertItem(a,a.index));this._map.once("contextmenu.hide",this._hideContextMenu,this);this._map.contextmenu.showAt(c,b)}},_hideContextMenu:function(){var a,b;a=0;for(b=this._items.length;a<b;a++)this._map.contextmenu.removeItem(this._items[a]);this._items.length=0;this.options.contextmenuInheritItems||this._map.contextmenu.showAllItems()}};var g=[f.Marker,f.Path],d={contextmenu:!1,contextmenuItems:[],contextmenuInheritItems:!0},c,b,l;b=0;for(l=g.length;b<l;b++)c=g[b],c.prototype.options?c.mergeOptions(d):c.prototype.options=d,c.addInitHook(function(){this.options.contextmenu&&this._initContextMenu()}),c.include(f.Mixin.ContextMenu);return f.Map.ContextMenu});(function(f,g,d){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(c){L.Util.setOptions(this,c);this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction);this._featureGroup=L.featureGroup();this._featureGroup.addEventParent(this);this._nonPointGroup=L.featureGroup();this._nonPointGroup.addEventParent(this);this._inZoomAnimation=0;this._needsClustering=[];this._needsRemoving=[];this._currentShownBounds=null;this._queue=[];this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};c=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,c?this._withAnimation:this._noAnimation);this._markerCluster=c?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(c){if(c instanceof L.LayerGroup)return this.addLayers([c]);if(!c.getLatLng)return this._nonPointGroup.addLayer(c),this.fire("layeradd",{layer:c}),this;if(!this._map)return this._needsClustering.push(c),this.fire("layeradd",{layer:c}),this;if(this.hasLayer(c))return this;this._unspiderfy&&this._unspiderfy();this._addLayer(c,this._maxZoom);this.fire("layeradd",{layer:c});this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();var b=c,d=this._zoom;if(c.__parent)for(;b.__parent._zoom>=d;)b=b.__parent;this._currentShownBounds.contains(b.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(c,b):this._animationAddLayerNonAnimated(c,b));return this},removeLayer:function(c){if(c instanceof L.LayerGroup)return this.removeLayers([c]);if(!c.getLatLng)return this._nonPointGroup.removeLayer(c),this.fire("layerremove",{layer:c}),this;if(!this._map)return!this._arraySplice(this._needsClustering,c)&&this.hasLayer(c)&&this._needsRemoving.push({layer:c,latlng:c._latlng}),this.fire("layerremove",{layer:c}),this;if(!c.__parent)return this;this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(c));this._removeLayer(c,!0);this.fire("layerremove",{layer:c});this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();c.off(this._childMarkerEventHandlers,this);this._featureGroup.hasLayer(c)&&(this._featureGroup.removeLayer(c),c.clusterShow&&c.clusterShow());return this},addLayers:function(c,b){if(!L.Util.isArray(c))return this.addLayer(c);var d=this._featureGroup,a=this._nonPointGroup,e=this.options.chunkedLoading,f=this.options.chunkInterval,k=this.options.chunkProgress,g=c.length,m=0,t=!0,p;if(this._map){var r=(new Date).getTime(),q=L.bind(function(){for(var l=(new Date).getTime();m<g&&!(e&&0===m%200&&(new Date).getTime()-l>f);m++)if(p=c[m],p instanceof L.LayerGroup)t&&(c=c.slice(),t=!1),this._extractNonGroupLayers(p,c),g=c.length;else if(!p.getLatLng)a.addLayer(p),b||this.fire("layeradd",{layer:p});else if(!this.hasLayer(p)&&(this._addLayer(p,this._maxZoom),b||this.fire("layeradd",{layer:p}),p.__parent&&2===p.__parent.getChildCount())){var h=p.__parent.getAllChildMarkers();d.removeLayer(h[0]===p?h[1]:h[0])}k&&k(m,g,(new Date).getTime()-r);m===g?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(q,this.options.chunkDelay)},this);q()}else for(var x=this._needsClustering;m<g;m++)p=c[m],p instanceof L.LayerGroup?(t&&(c=c.slice(),t=!1),this._extractNonGroupLayers(p,c),g=c.length):p.getLatLng?this.hasLayer(p)||x.push(p):a.addLayer(p);return this},removeLayers:function(c){var b,d,a=c.length,e=this._featureGroup,f=this._nonPointGroup,k=!0;if(!this._map){for(b=0;b<a;b++)d=c[b],d instanceof L.LayerGroup?(k&&(c=c.slice(),k=!1),this._extractNonGroupLayers(d,c),a=c.length):(this._arraySplice(this._needsClustering,d),f.removeLayer(d),this.hasLayer(d)&&this._needsRemoving.push({layer:d,latlng:d._latlng}),this.fire("layerremove",{layer:d}));return this}if(this._unspiderfy){this._unspiderfy();var g=c.slice(),m=a;for(b=0;b<m;b++)d=g[b],d instanceof L.LayerGroup?(this._extractNonGroupLayers(d,g),m=g.length):this._unspiderfyLayer(d)}for(b=0;b<a;b++)d=c[b],d instanceof L.LayerGroup?(k&&(c=c.slice(),k=!1),this._extractNonGroupLayers(d,c),a=c.length):d.__parent?(this._removeLayer(d,!0,!0),this.fire("layerremove",{layer:d}),e.hasLayer(d)&&(e.removeLayer(d),d.clusterShow&&d.clusterShow())):(f.removeLayer(d),this.fire("layerremove",{layer:d}));this._topClusterLevel._recalculateBounds();this._refreshClustersIcons();this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds);return this},clearLayers:function(){this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered);this._noanimationUnspiderfy&&this._noanimationUnspiderfy();this._featureGroup.clearLayers();this._nonPointGroup.clearLayers();this.eachLayer(function(c){c.off(this._childMarkerEventHandlers,this);delete c.__parent},this);this._map&&this._generateInitialClusters();return this},getBounds:function(){var c=new L.LatLngBounds;this._topClusterLevel&&c.extend(this._topClusterLevel._bounds);for(var b=this._needsClustering.length-1;0<=b;b--)c.extend(this._needsClustering[b].getLatLng());c.extend(this._nonPointGroup.getBounds());return c},eachLayer:function(c,b){var d=this._needsClustering.slice(),a=this._needsRemoving,e,f,k;this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(d);for(f=d.length-1;0<=f;f--){e=!0;for(k=a.length-1;0<=k;k--)if(a[k].layer===d[f]){e=!1;break}e&&c.call(b,d[f])}this._nonPointGroup.eachLayer(c,b)},getLayers:function(){var c=[];this.eachLayer(function(b){c.push(b)});return c},getLayer:function(c){var b=null;c=parseInt(c,10);this.eachLayer(function(d){L.stamp(d)===c&&(b=d)});return b},hasLayer:function(c){if(!c)return!1;var b,d=this._needsClustering;for(b=d.length-1;0<=b;b--)if(d[b]===c)return!0;d=this._needsRemoving;for(b=d.length-1;0<=b;b--)if(d[b].layer===c)return!1;return!(!c.__parent||c.__parent._group!==this)||this._nonPointGroup.hasLayer(c)},zoomToShowLayer:function(c,b){"function"!==typeof b&&(b=function(){});var d=function(){!c._icon&&!c.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",d,this),this.off("animationend",d,this),c._icon?b():c.__parent._icon&&(this.once("spiderfied",b,this),c.__parent.spiderfy()))};c._icon&&this._map.getBounds().contains(c.getLatLng())?b():c.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",d,this),this._map.panTo(c.getLatLng())):(this._map.on("moveend",d,this),this.on("animationend",d,this),c.__parent.zoomToBounds())},onAdd:function(c){this._map=c;var b,d;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.addTo(c);this._nonPointGroup.addTo(c);this._gridClusters||this._generateInitialClusters();this._maxLat=c.options.crs.projection.MAX_LATITUDE;c=0;for(b=this._needsRemoving.length;c<b;c++)d=this._needsRemoving[c],d.newlatlng=d.layer._latlng,d.layer._latlng=d.latlng;c=0;for(b=this._needsRemoving.length;c<b;c++)d=this._needsRemoving[c],this._removeLayer(d.layer,!0),d.layer._latlng=d.newlatlng;this._needsRemoving=[];this._zoom=Math.round(this._map._zoom);this._currentShownBounds=this._getExpandedVisibleBounds();this._map.on("zoomend",this._zoomEnd,this);this._map.on("moveend",this._moveEnd,this);this._spiderfierOnAdd&&this._spiderfierOnAdd();this._bindEvents();b=this._needsClustering;this._needsClustering=[];this.addLayers(b,!0)},onRemove:function(c){c.off("zoomend",this._zoomEnd,this);c.off("moveend",this._moveEnd,this);this._unbindEvents();this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","");this._spiderfierOnRemove&&this._spiderfierOnRemove();delete this._maxLat;this._hideCoverage();this._featureGroup.remove();this._nonPointGroup.remove();this._featureGroup.clearLayers();this._map=null},getVisibleParent:function(c){for(;c&&!c._icon;)c=c.__parent;return c||null},_arraySplice:function(c,b){for(var d=c.length-1;0<=d;d--)if(c[d]===b)return c.splice(d,1),!0},_removeFromGridUnclustered:function(c,b){for(var d=this._map,a=this._gridUnclustered,e=this._map.getMinZoom();b>=e&&a[b].removeObject(c,d.project(c.getLatLng(),b));b--);},_childMarkerDragStart:function(c){c.target.__dragStart=c.target._latlng},_childMarkerMoved:function(c){if(!this._ignoreMove&&!c.target.__dragStart){var b=c.target._popup&&c.target._popup.isOpen();this._moveChild(c.target,c.oldLatLng,c.latlng);b&&c.target.openPopup()}},_moveChild:function(c,b,d){c._latlng=b;this.removeLayer(c);c._latlng=d;this.addLayer(c)},_childMarkerDragEnd:function(c){c.target.__dragStart&&this._moveChild(c.target,c.target.__dragStart,c.target._latlng);delete c.target.__dragStart},_removeLayer:function(c,b,d){var a=this._gridClusters,e=this._gridUnclustered,f=this._featureGroup,l=this._map,g=this._map.getMinZoom();b&&this._removeFromGridUnclustered(c,this._maxZoom);var m=c.__parent,t;for(this._arraySplice(m._markers,c);m;){m._childCount--;m._boundsNeedUpdate=!0;if(m._zoom<g)break;else b&&1>=m._childCount?(t=m._markers[0]===c?m._markers[1]:m._markers[0],a[m._zoom].removeObject(m,l.project(m._cLatLng,m._zoom)),e[m._zoom].addObject(t,l.project(t.getLatLng(),m._zoom)),this._arraySplice(m.__parent._childClusters,m),m.__parent._markers.push(t),t.__parent=m.__parent,m._icon&&(f.removeLayer(m),d||f.addLayer(t))):m._iconNeedsUpdate=!0;m=m.__parent}delete c.__parent},_isOrIsParent:function(c,b){for(;b;){if(c===b)return!0;b=b.parentNode}return!1},fire:function(c,b,d){if(b&&b.layer instanceof L.MarkerCluster){if(b.originalEvent&&this._isOrIsParent(b.layer._icon,b.originalEvent.relatedTarget))return;c="cluster"+c}L.FeatureGroup.prototype.fire.call(this,c,b,d)},listens:function(c,b){return L.FeatureGroup.prototype.listens.call(this,c,b)||L.FeatureGroup.prototype.listens.call(this,"cluster"+c,b)},_defaultIconCreateFunction:function(c){c=c.getChildCount();var b=" marker-cluster-";return new L.DivIcon({html:"\x3cdiv\x3e\x3cspan\x3e"+c+"\x3c/span\x3e\x3c/div\x3e",className:"marker-cluster"+(10>c?b+"small":100>c?b+"medium":b+"large"),iconSize:new L.Point(40,40)})},_bindEvents:function(){var c=this._map,b=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick;if(this.options.spiderfyOnMaxZoom||d)this.on("clusterclick",this._zoomOrSpiderfy,this);b&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),c.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(c){for(var b=c.layer,d=b;1===d._childClusters.length;)d=d._childClusters[0];d._zoom===this._maxZoom&&d._childCount===b._childCount&&this.options.spiderfyOnMaxZoom?b.spiderfy():this.options.zoomToBoundsOnClick&&b.zoomToBounds();c.originalEvent&&13===c.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(c){var b=this._map;this._inZoomAnimation||(this._shownPolygon&&b.removeLayer(this._shownPolygon),2<c.layer.getChildCount()&&c.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(c.layer.getConvexHull(),this.options.polygonOptions),b.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var c=this.options.showCoverageOnHover,b=this.options.zoomToBoundsOnClick,d=this._map;(this.options.spiderfyOnMaxZoom||b)&&this.off("clusterclick",this._zoomOrSpiderfy,this);c&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),d.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var c=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),c);this._currentShownBounds=c}},_generateInitialClusters:function(){var c=this._map.getMaxZoom(),b=this._map.getMinZoom(),d=this.options.maxClusterRadius,a=d;"function"!==typeof d&&(a=function(){return d});this.options.disableClusteringAtZoom&&(c=this.options.disableClusteringAtZoom-1);this._maxZoom=c;this._gridClusters={};for(this._gridUnclustered={};c>=b;c--)this._gridClusters[c]=new L.DistanceGrid(a(c)),this._gridUnclustered[c]=new L.DistanceGrid(a(c));this._topClusterLevel=new this._markerCluster(this,b-1)},_addLayer:function(c,b){var d=this._gridClusters,a=this._gridUnclustered,e=this._map.getMinZoom(),f;this.options.singleMarkerMode&&this._overrideMarkerIcon(c);for(c.on(this._childMarkerEventHandlers,this);b>=e;b--){f=this._map.project(c.getLatLng(),b);var k=d[b].getNearObject(f);if(k){k._addChild(c);c.__parent=k;return}if(k=a[b].getNearObject(f)){(a=k.__parent)&&this._removeLayer(k,!1);e=new this._markerCluster(this,b,k,c);d[b].addObject(e,this._map.project(e._cLatLng,b));k.__parent=e;f=c.__parent=e;for(e=b-1;e>a._zoom;e--)f=new this._markerCluster(this,e,f),d[e].addObject(f,this._map.project(k.getLatLng(),e));a._addChild(f);this._removeFromGridUnclustered(k,b);return}a[b].addObject(c,f)}this._topClusterLevel._addChild(c);c.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(c){c instanceof L.MarkerCluster&&c._iconNeedsUpdate&&c._updateIcon()})},_enqueue:function(c){this._queue.push(c);this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var c=0;c<this._queue.length;c++)this._queue[c].call(this);this._queue.length=0;clearTimeout(this._queueTimeout);this._queueTimeout=null},_mergeSplitClusters:function(){var c=Math.round(this._map._zoom);this._processQueue();this._zoom<c&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,c)):this._zoom>c?(this._animationStart(),this._animationZoomOut(this._zoom,c)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(c){var b=this._maxLat;b!==d&&(c.getNorth()>=b&&(c._northEast.lat=Infinity),c.getSouth()<=-b&&(c._southWest.lat=-Infinity));return c},_animationAddLayerNonAnimated:function(c,b){if(b===c)this._featureGroup.addLayer(c);else if(2===b._childCount){b._addToMap();var d=b.getAllChildMarkers();this._featureGroup.removeLayer(d[0]);this._featureGroup.removeLayer(d[1])}else b._updateIcon()},_extractNonGroupLayers:function(c,b){var d=c.getLayers(),a=0,e;for(b=b||[];a<d.length;a++)e=d[a],e instanceof L.LayerGroup?this._extractNonGroupLayers(e,b):b.push(e);return b},_overrideMarkerIcon:function(c){return c.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[c]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-Infinity,-Infinity),new L.LatLng(Infinity,Infinity))});L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(c,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this.fire("animationend")},_animationZoomOut:function(c,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,c);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this.fire("animationend")},_animationAddLayer:function(c,b){this._animationAddLayerNonAnimated(c,b)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim";this._inZoomAnimation++},_animationZoomIn:function(c,b){var d=this._getExpandedVisibleBounds(),a=this._featureGroup,e=this._map.getMinZoom(),f;this._ignoreMove=!0;this._topClusterLevel._recursively(d,c,e,function(e){var l=e._latlng,h=e._markers;d.contains(l)||(l=null);e._isSingleParent()&&c+1===b?(a.removeLayer(e),e._recursivelyAddChildrenToMap(null,b,d)):(e.clusterHide(),e._recursivelyAddChildrenToMap(l,b,d));for(f=h.length-1;0<=f;f--)e=h[f],d.contains(e._latlng)||a.removeLayer(e)});this._forceLayout();this._topClusterLevel._recursivelyBecomeVisible(d,b);a.eachLayer(function(a){a instanceof L.MarkerCluster||!a._icon||a.clusterShow()});this._topClusterLevel._recursively(d,c,b,function(a){a._recursivelyRestoreChildPositions(b)});this._ignoreMove=!1;this._enqueue(function(){this._topClusterLevel._recursively(d,c,e,function(b){a.removeLayer(b);b.clusterShow()});this._animationEnd()})},_animationZoomOut:function(c,b){this._animationZoomOutSingle(this._topClusterLevel,c-1,b);this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds());this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,c,this._getExpandedVisibleBounds())},_animationAddLayer:function(c,b){var d=this,a=this._featureGroup;a.addLayer(c);b!==c&&(2<b._childCount?(b._updateIcon(),this._forceLayout(),this._animationStart(),c._setPos(this._map.latLngToLayerPoint(b.getLatLng())),c.clusterHide(),this._enqueue(function(){a.removeLayer(c);c.clusterShow();d._animationEnd()})):(this._forceLayout(),d._animationStart(),d._animationZoomOutSingle(b,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(c,b,d){var a=this._getExpandedVisibleBounds(),e=this._map.getMinZoom();c._recursivelyAnimateChildrenInAndAddSelfToMap(a,b+1,d);var f=this;this._forceLayout();c._recursivelyBecomeVisible(a,d);this._enqueue(function(){if(1===c._childCount){var l=c._markers[0];this._ignoreMove=!0;l.setLatLng(l.getLatLng());this._ignoreMove=!1;l.clusterShow&&l.clusterShow()}else c._recursively(a,d,e,function(c){c._recursivelyRemoveChildrenFromMap(a,b+1)});f._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""));this._inZoomAnimation--;this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(g.body.offsetWidth)}});L.markerClusterGroup=function(c){return new L.MarkerClusterGroup(c)};L.MarkerCluster=L.Marker.extend({initialize:function(c,b,d,a){L.Marker.prototype.initialize.call(this,d?d._cLatLng||d.getLatLng():new L.LatLng(0,0),{icon:this});this._group=c;this._zoom=b;this._markers=[];this._childClusters=[];this._childCount=0;this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._bounds=new L.LatLngBounds;d&&this._addChild(d);a&&this._addChild(a)},getAllChildMarkers:function(c){c=c||[];for(var b=this._childClusters.length-1;0<=b;b--)this._childClusters[b].getAllChildMarkers(c);for(b=this._markers.length-1;0<=b;b--)c.push(this._markers[b]);return c},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var c=this._childClusters.slice(),b=this._group._map,d=b.getBoundsZoom(this._bounds),a=this._zoom+1,b=b.getZoom(),e;0<c.length&&d>a;){a++;var f=[];for(e=0;e<c.length;e++)f=f.concat(c[e]._childClusters);c=f}d>a?this._group._map.setView(this._latlng,a):d<=b?this._group._map.setView(this._latlng,b+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var c=new L.LatLngBounds;c.extend(this._bounds);return c},_updateIcon:function(){this._iconNeedsUpdate=!0;this._icon&&this.setIcon(this)},createIcon:function(){this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1);return this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(c,b){this._boundsNeedUpdate=this._iconNeedsUpdate=!0;this._setClusterCenter(c);c instanceof L.MarkerCluster?(b||(this._childClusters.push(c),c.__parent=this),this._childCount+=c._childCount):(b||this._markers.push(c),this._childCount++);this.__parent&&this.__parent._addChild(c,!0)},_setClusterCenter:function(c){this._cLatLng||(this._cLatLng=c._cLatLng||c._latlng)},_resetBounds:function(){var c=this._bounds;c._southWest&&(c._southWest.lat=Infinity,c._southWest.lng=Infinity);c._northEast&&(c._northEast.lat=-Infinity,c._northEast.lng=-Infinity)},_recalculateBounds:function(){var c=this._markers,b=this._childClusters,d=0,a=0,e=this._childCount,f,k;if(0!==e){this._resetBounds();for(f=0;f<c.length;f++)k=c[f]._latlng,this._bounds.extend(k),d+=k.lat,a+=k.lng;for(f=0;f<b.length;f++)c=b[f],c._boundsNeedUpdate&&c._recalculateBounds(),this._bounds.extend(c._bounds),k=c._wLatLng,c=c._childCount,d+=k.lat*c,a+=k.lng*c;this._latlng=this._wLatLng=new L.LatLng(d/e,a/e);this._boundsNeedUpdate=!1}},_addToMap:function(c){c&&(this._backupLatlng=this._latlng,this.setLatLng(c));this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(c,b,d){this._recursively(c,this._group._map.getMinZoom(),d-1,function(a){a=a._markers;var c,d;for(c=a.length-1;0<=c;c--)d=a[c],d._icon&&(d._setPos(b),d.clusterHide())},function(a){a=a._childClusters;var c,d;for(c=a.length-1;0<=c;c--)d=a[c],d._icon&&(d._setPos(b),d.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(c,b,d){this._recursively(c,d,this._group._map.getMinZoom(),function(a){a._recursivelyAnimateChildrenIn(c,a._group._map.latLngToLayerPoint(a.getLatLng()).round(),b);a._isSingleParent()&&b-1===d?(a.clusterShow(),a._recursivelyRemoveChildrenFromMap(c,b)):a.clusterHide();a._addToMap()})},_recursivelyBecomeVisible:function(c,b){this._recursively(c,this._group._map.getMinZoom(),b,null,function(b){b.clusterShow()})},_recursivelyAddChildrenToMap:function(c,b,d){this._recursively(d,this._group._map.getMinZoom()-1,b,function(a){if(b!==a._zoom)for(var e=a._markers.length-1;0<=e;e--){var f=a._markers[e];d.contains(f._latlng)&&(c&&(f._backupLatlng=f.getLatLng(),f.setLatLng(c),f.clusterHide&&f.clusterHide()),a._group._featureGroup.addLayer(f))}},function(a){a._addToMap(c)})},_recursivelyRestoreChildPositions:function(c){for(var b=this._markers.length-1;0<=b;b--){var d=this._markers[b];d._backupLatlng&&(d.setLatLng(d._backupLatlng),delete d._backupLatlng)}if(c-1===this._zoom)for(c=this._childClusters.length-1;0<=c;c--)this._childClusters[c]._restorePosition();else for(b=this._childClusters.length-1;0<=b;b--)this._childClusters[b]._recursivelyRestoreChildPositions(c)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(c,b,d){var a,e;this._recursively(c,this._group._map.getMinZoom()-1,b-1,function(b){for(e=b._markers.length-1;0<=e;e--)a=b._markers[e],d&&d.contains(a._latlng)||(b._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())},function(b){for(e=b._childClusters.length-1;0<=e;e--)a=b._childClusters[e],d&&d.contains(a._latlng)||(b._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())})},_recursively:function(c,b,d,a,e){var f=this._childClusters,l=this._zoom,g;b<=l&&(a&&a(this),e&&l===d&&e(this));if(l<b||l<d)for(l=f.length-1;0<=l;l--)g=f[l],c.intersects(g._bounds)&&g._recursively(c,b,d,a,e)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){this.options.opacityWhenUnclustered=this.options.opacity||1;return this.setOpacity(0)},clusterShow:function(){var c=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);delete this.options.opacityWhenUnclustered;return c}});L.DistanceGrid=function(c){this._cellSize=c;this._sqCellSize=c*c;this._grid={};this._objectPoint={}};L.DistanceGrid.prototype={addObject:function(c,b){var d=this._getCoord(b.x),a=this._getCoord(b.y),e=this._grid,a=e[a]=e[a]||{},d=a[d]=a[d]||[],a=L.Util.stamp(c);this._objectPoint[a]=b;d.push(c)},updateObject:function(c,b){this.removeObject(c);this.addObject(c,b)},removeObject:function(c,b){var d=this._getCoord(b.x),a=this._getCoord(b.y),e=this._grid,a=e[a]=e[a]||{},e=a[d]=a[d]||[],f,k;delete this._objectPoint[L.Util.stamp(c)];f=0;for(k=e.length;f<k;f++)if(e[f]===c)return e.splice(f,1),1===k&&delete a[d],!0},eachObject:function(c,b){var d,a,e,f,k,g,m,t=this._grid;for(d in t)for(a in k=t[d],k)for(g=k[a],e=0,f=g.length;e<f;e++)if(m=c.call(b,g[e]))e--,f--},getNearObject:function(c){var b=this._getCoord(c.x),d=this._getCoord(c.y),a,e,f,k,g,m,t,p,r=this._objectPoint,q=this._sqCellSize,x=null;for(a=d-1;a<=d+1;a++)if(k=this._grid[a])for(e=b-1;e<=b+1;e++)if(g=k[e])for(f=0,m=g.length;f<m;f++)t=g[f],p=this._sqDist(r[L.Util.stamp(t)],c),p<q&&(q=p,x=t);return x},_getCoord:function(c){return Math.floor(c/this._cellSize)},_sqDist:function(c,b){var d=b.x-c.x,a=b.y-c.y;return d*d+a*a}};(function(){L.QuickHull={getDistant:function(c,b){return(b[0].lng-b[1].lng)*(c.lat-b[0].lat)+(b[1].lat-b[0].lat)*(c.lng-b[0].lng)},findMostDistantPointFromBaseLine:function(c,b){var d=0,a=null,e=[],f,k,g;for(f=b.length-1;0<=f;f--)k=b[f],g=this.getDistant(k,c),0<g&&(e.push(k),g>d&&(d=g,a=k));return{maxPoint:a,newPoints:e}},buildConvexHull:function(c,b){var d=[],a=this.findMostDistantPointFromBaseLine(c,b);return a.maxPoint?(d=d.concat(this.buildConvexHull([c[0],a.maxPoint],a.newPoints)),d=d.concat(this.buildConvexHull([a.maxPoint,c[1]],a.newPoints))):[c[0]]},getConvexHull:function(c){var b=!1,d=!1,a=!1,e=!1,f=null,k=null,g=null,m=null,t;for(t=c.length-1;0<=t;t--){var p=c[t];if(!1===b||p.lat>b)f=p,b=p.lat;if(!1===d||p.lat<d)k=p,d=p.lat;if(!1===a||p.lng>a)g=p,a=p.lng;if(!1===e||p.lng<e)m=p,e=p.lng}d!==b?b=k:(b=m,f=g);return[].concat(this.buildConvexHull([b,f],c),this.buildConvexHull([f,b],c))}}})();L.MarkerCluster.include({getConvexHull:function(){var c=this.getAllChildMarkers(),b=[],d,a;for(a=c.length-1;0<=a;a--)d=c[a].getLatLng(),b.push(d);return L.QuickHull.getConvexHull(b)}});L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var c=this.getAllChildMarkers(),b=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy();this._group._spiderfied=this;c.length>=this._circleSpiralSwitchover?b=this._generatePointsSpiral(c.length,b):(b.y+=10,b=this._generatePointsCircle(c.length,b));this._animationSpiderfy(c,b)}},unspiderfy:function(c){this._group._inZoomAnimation||(this._animationUnspiderfy(c),this._group._spiderfied=null)},_generatePointsCircle:function(c,b){var d=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+c)/this._2PI,a=this._2PI/c,e=[],f,k;e.length=c;for(f=c-1;0<=f;f--)k=this._circleStartAngle+f*a,e[f]=(new L.Point(b.x+d*Math.cos(k),b.y+d*Math.sin(k)))._round();return e},_generatePointsSpiral:function(c,b){var d=this._group.options.spiderfyDistanceMultiplier,a=d*this._spiralLengthStart,e=d*this._spiralFootSeparation,d=d*this._spiralLengthFactor*this._2PI,f=0,k=[],g;k.length=c;for(g=c-1;0<=g;g--)f+=e/a+5E-4*g,k[g]=(new L.Point(b.x+a*Math.cos(f),b.y+a*Math.sin(f)))._round(),a+=d/f;return k},_noanimationUnspiderfy:function(){var c=this._group,b=c._map,d=c._featureGroup,a=this.getAllChildMarkers(),e,f;c._ignoreMove=!0;this.setOpacity(1);for(f=a.length-1;0<=f;f--)e=a[f],d.removeLayer(e),e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng),e.setZIndexOffset&&e.setZIndexOffset(0),e._spiderLeg&&(b.removeLayer(e._spiderLeg),delete e._spiderLeg);c.fire("unspiderfied",{cluster:this,markers:a});c._ignoreMove=!1;c._spiderfied=null}});L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(c,b){var d=this._group,a=d._map,e=d._featureGroup,f=this._group.options.spiderLegPolylineOptions,k,g,m,t;d._ignoreMove=!0;for(k=0;k<c.length;k++)t=a.layerPointToLatLng(b[k]),g=c[k],m=new L.Polyline([this._latlng,t],f),a.addLayer(m),g._spiderLeg=m,g._preSpiderfyLatlng=g._latlng,g.setLatLng(t),g.setZIndexOffset&&g.setZIndexOffset(1E6),e.addLayer(g);this.setOpacity(.3);d._ignoreMove=!1;d.fire("spiderfied",{cluster:this,markers:c})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}});L.MarkerCluster.include({_animationSpiderfy:function(c,b){var f=this,a=this._group,e=a._map,h=a._featureGroup,k=this._latlng,g=e.latLngToLayerPoint(k),m=L.Path.SVG,t=L.extend({},this._group.options.spiderLegPolylineOptions),p=t.opacity,r,q,x,A;p===d&&(p=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity);m?(t.opacity=0,t.className=(t.className||"")+" leaflet-cluster-spider-leg"):t.opacity=p;a._ignoreMove=!0;for(r=0;r<c.length;r++)q=c[r],A=e.layerPointToLatLng(b[r]),x=new L.Polyline([k,A],t),e.addLayer(x),q._spiderLeg=x,m&&(A=x._path,x=A.getTotalLength()+.1,A.style.strokeDasharray=x,A.style.strokeDashoffset=x),q.setZIndexOffset&&q.setZIndexOffset(1E6),q.clusterHide&&q.clusterHide(),h.addLayer(q),q._setPos&&q._setPos(g);a._forceLayout();a._animationStart();for(r=c.length-1;0<=r;r--)A=e.layerPointToLatLng(b[r]),q=c[r],q._preSpiderfyLatlng=q._latlng,q.setLatLng(A),q.clusterShow&&q.clusterShow(),m&&(x=q._spiderLeg,A=x._path,A.style.strokeDashoffset=0,x.setStyle({opacity:p}));this.setOpacity(.3);a._ignoreMove=!1;setTimeout(function(){a._animationEnd();a.fire("spiderfied",{cluster:f,markers:c})},200)},_animationUnspiderfy:function(c){var b=this,d=this._group,a=d._map,e=d._featureGroup;c=c?a._latLngToNewLayerPoint(this._latlng,c.zoom,c.center):a.latLngToLayerPoint(this._latlng);var f=this.getAllChildMarkers(),k=L.Path.SVG,g,m,t,p,r;d._ignoreMove=!0;d._animationStart();this.setOpacity(1);for(m=f.length-1;0<=m;m--)g=f[m],g._preSpiderfyLatlng&&(g.closePopup(),g.setLatLng(g._preSpiderfyLatlng),delete g._preSpiderfyLatlng,t=!0,g._setPos&&(g._setPos(c),t=!1),g.clusterHide&&(g.clusterHide(),t=!1),t&&e.removeLayer(g),k&&(t=g._spiderLeg,p=t._path,r=p.getTotalLength()+.1,p.style.strokeDashoffset=r,t.setStyle({opacity:0})));d._ignoreMove=!1;setTimeout(function(){var c=0;for(m=f.length-1;0<=m;m--)g=f[m],g._spiderLeg&&c++;for(m=f.length-1;0<=m;m--)g=f[m],g._spiderLeg&&(g.clusterShow&&g.clusterShow(),g.setZIndexOffset&&g.setZIndexOffset(0),1<c&&e.removeLayer(g),a.removeLayer(g._spiderLeg),delete g._spiderLeg);d._animationEnd();d.fire("unspiderfied",{cluster:b,markers:f})},200)}});L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this);if(this._map.options.zoomAnimation)this._map.on("zoomstart",this._unspiderfyZoomStart,this);this._map.on("zoomend",this._noanimationUnspiderfy,this);L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this);this._map.off("zoomstart",this._unspiderfyZoomStart,this);this._map.off("zoomanim",this._unspiderfyZoomAnim,this);this._map.off("zoomend",this._noanimationUnspiderfy,this);this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){if(this._map)this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(c){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(c))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(c){this._spiderfied&&this._spiderfied.unspiderfy(c)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(c){c._spiderLeg&&(this._featureGroup.removeLayer(c),c.clusterShow&&c.clusterShow(),c.setZIndexOffset&&c.setZIndexOffset(0),this._map.removeLayer(c._spiderLeg),delete c._spiderLeg)}});L.MarkerClusterGroup.include({refreshClusters:function(c){c?c instanceof L.MarkerClusterGroup?c=c._topClusterLevel.getAllChildMarkers():c instanceof L.LayerGroup?c=c._layers:c instanceof L.MarkerCluster?c=c.getAllChildMarkers():c instanceof L.Marker&&(c=[c]):c=this._topClusterLevel.getAllChildMarkers();this._flagParentsIconsNeedUpdate(c);this._refreshClustersIcons();this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(c);return this},_flagParentsIconsNeedUpdate:function(c){var b,d;for(b in c)for(d=c[b].__parent;d;)d._iconNeedsUpdate=!0,d=d.__parent},_refreshSingleMarkerModeMarkers:function(c){var b,d;for(b in c)d=c[b],this.hasLayer(d)&&d.setIcon(this._overrideMarkerIcon(d))}});L.Marker.include({refreshIconOptions:function(c,b){var d=this.options.icon;L.setOptions(d,c);this.setIcon(d);b&&this.__parent&&this.__parent._group.refreshClusters(this);return this}})})(window,document);(function(){L.miniMapLayerSwitcherVersion="0.1-dev";L.Control.MiniMapLayerSwitcher=L.Control.extend({_className:"leaflet-mini-map-control-layers",options:{miniMapLabelHeight:22,miniMapHeight:80,miniMapWidth:90,miniMapMargin:10,miniMapZoomOffset:-2,position:"bottomleft",autoZIndex:!0},initialize:function(f,g){L.setOptions(this,g);this._layers=[];this._miniMaps={};this._lastZIndex=0;for(var d in f)this._addLayer(f[d],d)},addTo:function(f){var g=this;L.Control.prototype.addTo.call(this,f);this._updateMiniMaps();this._forEachLayer(function(d){g._miniMaps[d.id].invalidateSize()});return this},onAdd:function(){this._map.on("move",this._updateMiniMaps,this).whenReady(this._onMapReady,this);this._render();return this._container},onRemove:function(){this._map.off("move",this._updateMiniMaps,this)},_render:function(){var f=this._container=L.DomUtil.create("div",this._className),g=this._inner=L.DomUtil.create("div",this._className+"-inner");f.setAttribute("aria-haspopup",!0);L.DomEvent.disableClickPropagation(f);if(L.Browser.touch)L.DomEvent.on(f,"click",this._toggleMiniMaps,this);else L.DomEvent.on(f,"mousewheel",L.DomEvent.stopPropagation).on(f,"mouseenter",this._expand,this).on(f,"mouseleave",this._contract,this);f.style.height=this.options.miniMapHeight+this.options.miniMapLabelHeight+"px";f.appendChild(g);this._forEachLayer(function(d){this._renderMiniMap(d,g)},this);this._hasMultipleLayers()?(f=this._getInitialMainMapLayerId(),this._activeLayerId=this._getInitialMiniMapLayerId(f),this._switchLayer(f)):this._container.style.display="none"},_toggleMiniMaps:function(){var f=L.DomUtil.hasClass(this._container,"expanded");this._animateMiniMaps(!f)},_expand:function(){this._animateMiniMaps(!0)},_contract:function(){this._animateMiniMaps(!1)},_renderMiniMap:function(f,g){var d=this._mapContainer=L.DomUtil.create("div","map-container"),c=L.DomUtil.create("div","map-container-inner"),b=this._mapContainer=L.DomUtil.create("div","minmap"),l=L.DomUtil.create("div","map-label"),a=f.id,e=this._findLayer(a);L.DomEvent.on(d,"click",this._onMiniMapClicked,this);b.style.height=this.options.miniMapHeight+"px";b.style.width=this.options.miniMapWidth+"px";l.innerHTML=f.name;c.appendChild(b);c.appendChild(l);d.layerId=a;d.style.width=this.options.miniMapWidth+"px";d.appendChild(c);g.appendChild(d);this._addMiniMap(a,e.miniMapLayer,b)},_addMiniMap:function(f,g,d){var c=this.options.miniMapZoomOffset,b=this._map.getMinZoom(),l=this._map.getMaxZoom();g=new L.GeoMap(d,{dragging:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,trackResize:!1,attributionControl:!1,zoomControl:!1,inertia:!1,worldCopyJump:!1,basetileLayer:[g],minZoom:b+c,maxZoom:l+c});this._miniMaps[f]=g},_addLayer:function(f,g){var d=L.stamp(f),c,b,l;if(f instanceof L.LayerGroup)for(c in b=new L.LayerGroup,f._layers)l=f._layers[c],l instanceof L.GeoWMTSLayer&&b.addLayer(new L.GeoWMTSLayer(l._url,l.options));else b=new L.GeoWMTSLayer(f._url,f.options);this._layers.push({id:d,name:g,mainMapLayer:f,miniMapLayer:b});this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex))},_findLayer:function(f){var g=this._layers,d=g.length,c,b;for(c=0;c<d;c++)if(b=g[c],b.id===f)return b;return null},_getCurrentTarget:function(f){return f.currentTarget?f.currentTarget:this._getFirstElementWithClass(f.srcElement,"map-container")},_getFirstElementWithClass:function(f,g){var d=L.DomUtil.hasClass(f,g),c=f.parentNode;return d?f:this._getFirstElementWithClass(c,g)},_onMiniMapClicked:function(f){var g=this._container;f=this._getCurrentTarget(f);var d=f.layerId,c;L.DomUtil.hasClass(this._container,"expanded")&&d!==this._activeLayerId&&(c=this._findLayer(d),L.DomUtil.addClass(g,"notransition"),this._switchLayer(d),this._map.fire("baselayerchanged",c.mainMapLayer),L.Util.falseFn(f.offsetWidth),L.DomUtil.removeClass(g,"notransition"))},_switchLayer:function(f){var g=this._findLayer(this._activeLayerId),d=this._findLayer(f),c=this._getMiniMapContainer(f),b,l,a;this._moveLayerToBack(d);l=this._layers[0].id;a=this._getMiniMapContainer(l);this._suggestedLayerId=l;this._activeLayerId=f;this._forEachLayer(function(a){b=this._getMiniMapContainer(a.id);L.DomUtil.removeClass(b,"active-map");L.DomUtil.removeClass(b,"suggested-map")});L.DomUtil.addClass(c,"active-map");L.DomUtil.addClass(a,"suggested-map");this._map.removeLayer(g.mainMapLayer);this._map.addLayer(d.mainMapLayer)},_moveLayerToBack:function(f){f=f.id;var g=this._layers,d=g.length,c;for(c=0;c<d;c++)if(g[c].id===f){f=g.splice(c,1)[0];g.push(f);break}},_animateMiniMaps:function(f){var g=0,d=this.options.miniMapWidth,c=this.options.miniMapMargin,b=this._container,l,a;L.DomUtil.hasClass(b,"expanded")!==f&&(this._forEachLayer(function(b){a=b.id;l=this._getMiniMapContainer(a);this._updateMiniMapPosition(a);f?(l.style.right=g*(d+c)+"px",g++):l.style.right="0"}),f?(b.style.width=g*(d+c)-c+"px",L.DomUtil.addClass(b,"expanded")):(b.style.width="0",L.DomUtil.removeClass(b,"expanded")))},_getInitialMainMapLayerId:function(){var f,g;this._forEachLayer(function(d){f=d.mainMapLayer;if(this._map.hasLayer(f))return g=d.id,!1});if(g)return g;this._forEachLayer(function(d){g=d.id;return!1});return g},_getInitialMiniMapLayerId:function(f){var g,d;this._forEachLayer(function(c){g=c.id;if(g!==f)return d=g,!1});return d},_forEachLayer:function(f){var g=this._layers,d=g.length,c,b;for(b=0;b<d&&(c=g[b],!1!==f.call(this,c));b++);},_getMiniMapContainer:function(f){return this._miniMaps[f].getContainer().parentNode.parentNode},_updateMiniMaps:function(){var f=this._suggestedLayerId;L.DomUtil.hasClass(this._container,"expanded")?this._forEachLayer(function(f){this._updateMiniMapPosition(f.id)},this):this._updateMiniMapPosition(f)},_updateMiniMapPosition:function(f){var g,d;this._mainMapReady&&this._hasMultipleLayers()&&(g=this._map,d=g.getCenter(),g=g.getZoom()+this.options.miniMapZoomOffset,this._miniMaps[f].setView(d,g,{pan:{animate:!1},zoom:{animate:!0}}))},_onMapReady:function(){this._mainMapReady=!0},_hasMultipleLayers:function(){return 0<this._layers.length}});L.control.miniMapLayerSwitcher=function(f,g){return new L.Control.MiniMapLayerSwitcher(f,g)}})();(function(f,g,d){L.CToolbar=(L.Layer||L.Class).extend({statics:{baseClass:"leaflet-toolbar"},includes:L.Mixin.Events,options:{className:"",filter:function(){return!0},actions:[]},initialize:function(b){L.setOptions(this,b);this._toolbar_type=this.constructor._toolbar_class_id},addTo:function(b){this._arguments=[].slice.call(arguments);b.addLayer(this);return this},onAdd:function(b){var c=b._toolbars[this._toolbar_type];0===this._calculateDepth()&&(c&&b.removeLayer(c),b._toolbars[this._toolbar_type]=this)},onRemove:function(b){0===this._calculateDepth()&&delete b._toolbars[this._toolbar_type]},appendToContainer:function(b){var c=this.constructor.baseClass+"-"+this._calculateDepth()+" "+this.options.className,a;this._container=b;this._ul=L.DomUtil.create("ul",c,b);this._disabledEvents=["click","mousemove","dblclick"];b=0;for(c=this._disabledEvents.length;b<c;b++)L.DomEvent.on(this._ul,this._disabledEvents[b],L.DomEvent.stopPropagation);b=0;for(c=this.options.actions.length;b<c;b++)a=this._getActionConstructor(this.options.actions[b]),a=new a,a._createIcon(this,this._ul,this._arguments)},_getActionConstructor:function(b){var c=this._arguments,a=this;return b.extend({initialize:function(){b.prototype.initialize.apply(this,c)},enable:function(c){a._active&&a._active.disable();a._active=this;b.prototype.enable.call(this,c)}})},_hide:function(){this._ul.style.display="none"},_show:function(){this._ul.style.display="block"},_calculateDepth:function(){for(var b=0,c=this.parentToolbar;c;)b+=1,c=c.parentToolbar;return b}});L.toolbar={};var c=0;L.CToolbar.extend=function(b){var d=L.extend({},b.statics,{_toolbar_class_id:c});c+=1;L.extend(b,{statics:d});return L.Class.extend.call(this,b)};L.Map.addInitHook(function(){this._toolbars={}});L.ToolbarAction=L.Handler.extend({statics:{baseClass:"leaflet-toolbar-icon"},options:{toolbarIcon:{html:"",className:"",tooltip:""},subToolbar:new L.CToolbar},initialize:function(b){var c=L.ToolbarAction.prototype.options.toolbarIcon;L.setOptions(this,b);this.options.toolbarIcon=L.extend({},c,this.options.toolbarIcon)},enable:function(){this._enabled||(this._enabled=!0,L.DomUtil.addClass(this._link,"enable"),this.addHooks&&this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,L.DomUtil.removeClass(this._link,"enable"),this.removeHooks&&this.removeHooks())},_createIcon:function(b,c,a){var e=this.options.toolbarIcon;this.toolbar=b;this._icon=L.DomUtil.create("li","",c);this._link=L.DomUtil.create("a","",this._icon);this._link.innerHTML=e.html;this._link.setAttribute("href","#");this._link.setAttribute("title",e.tooltip);L.DomUtil.addClass(this._link,this.constructor.baseClass);e.className&&L.DomUtil.addClass(this._link,e.className);L.DomEvent.on(this._link,"click",this._click,this);this._addSubToolbar(b,this._icon,a)},_click:function(){this._enabled?this.disable():this.enable()},_addSubToolbar:function(b,c,a){var e=this.options.subToolbar,d=this.addHooks,f=this.removeHooks;e.parentToolbar=b;0<e.options.actions.length&&(a=[].slice.call(a),a.push(this),e.addTo.apply(e,a),e.appendToContainer(c),this.addHooks=function(a){"function"===typeof d&&d.call(this,a);e._show()},this.removeHooks=function(a){"function"===typeof f&&f.call(this,a);e._hide()})}});L.toolbarAction=function(b){return new L.ToolbarAction(b)};L.ToolbarAction.extendOptions=function(b){return this.extend({options:b})};L.ToolbarClickAction=L.Handler.extend({statics:{baseClass:"leaflet-toolbar-icon"},options:{toolbarIcon:{html:"",className:"",tooltip:""},subToolbar:new L.CToolbar},initialize:function(b){var c=L.ToolbarClickAction.prototype.options.toolbarIcon;L.setOptions(this,b);this.options.toolbarIcon=L.extend({},c,this.options.toolbarIcon)},enable:function(){this._enabled||(this._enabled=!0,L.DomUtil.addClass(this._link,"enable"))},disable:function(){this._enabled&&(this._enabled=!1,L.DomUtil.removeClass(this._link,"enable"))},_createIcon:function(b,c,a){var e=this.options.toolbarIcon;this.toolbar=b;this._icon=L.DomUtil.create("li","",c);this._link=L.DomUtil.create("a","",this._icon);this._link.innerHTML=e.html;this._link.setAttribute("href","#");this._link.setAttribute("title",e.tooltip);L.DomUtil.addClass(this._link,this.constructor.baseClass);e.className&&L.DomUtil.addClass(this._link,e.className);L.DomEvent.on(this._link,"click",this._click,this);this._addSubToolbar(b,this._icon,a)},_click:function(){this._enabled?this.disable():this.enable();this.addHooks&&this.addHooks()},_addSubToolbar:function(b,c,a){var e=this.options.subToolbar,d=this.addHooks,f=this.removeHooks;e.parentToolbar=b;0<e.options.actions.length&&(a=[].slice.call(a),a.push(this),e.addTo.apply(e,a),e.appendToContainer(c),this.addHooks=function(a){"function"===typeof d&&d.call(this,a);e._show()},this.removeHooks=function(a){"function"===typeof f&&f.call(this,a);e._hide()})}});L.toolbarClickAction=function(b){return new L.ToolbarClickAction(b)};L.ToolbarClickAction.extendOptions=function(b){return this.extend({options:b})};L.CToolbar.Control=L.CToolbar.extend({statics:{baseClass:"leaflet-control-toolbar "+L.CToolbar.baseClass},initialize:function(b){L.CToolbar.prototype.initialize.call(this,b);this._control=new L.Control.CToolbar(this.options)},onAdd:function(b){this._control.addTo(b);L.CToolbar.prototype.onAdd.call(this,b);this.appendToContainer(this._control.getContainer())},onRemove:function(b){L.CToolbar.prototype.onRemove.call(this,b);this._control.remove?this._control.remove():this._control.removeFrom(b)}});L.Control.CToolbar=L.Control.extend({options:{position:"bottomright"},onAdd:function(){return L.DomUtil.create("div","leaflet-toolbar")}});L.toolbar.control=function(b){return new L.CToolbar.Control(b)};L.CToolbar.Popup=L.CToolbar.extend({statics:{baseClass:"leaflet-popup-toolbar "+L.CToolbar.baseClass},options:{anchor:[0,0]},initialize:function(b,c){L.CToolbar.prototype.initialize.call(this,c);this._marker=new L.Marker(b,{icon:new L.DivIcon({className:this.options.className,iconAnchor:[0,0]})})},onAdd:function(b){this._map=b;this._marker.addTo(b);L.CToolbar.prototype.onAdd.call(this,b);this.appendToContainer(this._marker._icon);this._setStyles()},onRemove:function(b){b.removeLayer(this._marker);L.CToolbar.prototype.onRemove.call(this,b);delete this._map},setLatLng:function(b){this._marker.setLatLng(b);return this},_setStyles:function(){for(var b=this._container,c=this._ul,a=L.point(this.options.anchor),e=c.querySelectorAll(".leaflet-toolbar-icon"),f=[],k=0,g=0,m=e.length;g<m;g++)e[g].parentNode.parentNode===c&&(f.push(parseInt(L.DomUtil.getStyle(e[g],"height"),10)),k+=Math.ceil(parseFloat(L.DomUtil.getStyle(e[g],"width"))));c.style.width=k+"px";this._tipContainer=L.DomUtil.create("div","leaflet-toolbar-tip-container",b);this._tipContainer.style.width=k+"px";this._tip=L.DomUtil.create("div","leaflet-toolbar-tip",this._tipContainer);c=Math.max.apply(d,f);e=parseInt(L.DomUtil.getStyle(this._tip,"width"),10);k=new L.Point(k/2,c+.7071*e);b.style.marginLeft=a.x-k.x+"px";b.style.marginTop=a.y-k.y+"px"}});L.toolbar.popup=function(b){return new L.CToolbar.Popup(b)};L.Text=L.Layer.extend({includes:L.Mixin.Events,options:{autoPan:!0,offset:new L.Point(0,30),autoPanPadding:new L.Point(5,5),latlng:null,content:"",className:""},layerType:"textLayer",initialize:function(b){L.Util.setOptions(this,b)},onAdd:function(b){this._map=b;this._container||this._initLayout();b._panes.popupPane.appendChild(this._container);b.on("viewreset",this._updatePosition,this);if(L.Browser.any3d)b.on("zoomanim",this._zoomAnimation,this);this._update()},addTo:function(b){b.addLayer(this);return this},onRemove:function(b){b._panes.popupPane.removeChild(this._container);b.off({viewreset:this._updatePosition,zoomanim:this._zoomAnimation},this);this._map=null},setLatLng:function(b){this.options.latlng=L.latLng(b);this._updatePosition();return this},setContent:function(b){this.options.content=b;this._updateContent();return this},_initLayout:function(){this._container=L.DomUtil.create("lable","imap-text "+this.options.className+" imap-zoom-animated");this._contentNode=L.DomUtil.create("span","imap-text-content",this._container)},_update:function(){this._map&&(this._updateContent(),this._updatePosition())},_updateContent:function(){this.options.content&&("string"==typeof this.options.content?this._contentNode.innerHTML=this.options.content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this.options.content)))},_updatePosition:function(){var b=this._map.latLngToLayerPoint(this.options.latlng),c=L.Browser.any3d,a=this.options.offset;c&&L.DomUtil.setPosition(this._container,b);this._containerBottom=-a.y-(c?0:b.y);this._containerLeft=a.x+(c?0:b.x);this._container.style.bottom=this._containerBottom+"px";this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(b){b=this._map._latLngToNewLayerPoint(this.options.latlng,b.zoom,b.center);L.DomUtil.setPosition(this._container,b)}});L.ComputeDist=L.ToolbarClickAction.extend({options:{toolbarIcon:{className:"leaflet-ComputeDist"}},_rad:Math.PI/180,initialize:function(b,c){this._map=b;this._map._distControl=this;L.setOptions(this,c);L.ToolbarClickAction.prototype.initialize.call(this,b,c)},_onMouseClick:function(){this._map._areaControl._startCompute&&this._map._areaControl._finishCompute();this._startCompute?this._finishCompute():this._enableCompute()},_setPath:function(b){b=b.latlng||this._map.mouseEventToLatLng(b);if(this._startPath){if(!b.equals(this._lastPoint)){var c=this._currentDist._latlngs;c.push(b);var a=c.length;this._totalDist+=this._getDistance(c[a-2],c[a-1]);this._addMarker(b);this._addLable(b,this._getDistanceString(this._totalDist),"dist-point")}}else this._currentDist={_layers:[],_latlngs:[]},this._addPath(b),this._totalDist=0,this._startPath=!0,this._addMarker(b),this._addLable(b,"\u8d77\u70b9","dist-start"),this._currentDist._latlngs.push(b);this._lastPoint=b;this._startMove=!1},_onMove:function(b){var c=b.latlng;b=b.containerPoint;var a=this._map._cursorTip;a.style.left=b.x+7+"px";a.style.top=b.y+23+"px";a.style.display="";this._startPath&&(this._startMove?this._currentPath.setLatLngs(this._currentDist._latlngs.concat(c)):(this._currentPath.addLatLng(c),this._startMove=!0))},_finishCompute:function(b){this._startPath&&(1<this._currentDist._latlngs.length?((!b||"contextmenu"===b.type)&&this._currentPath.setLatLngs(this._currentDist._latlngs),this._addReomveMarker(this._lastPoint),this._currentDist.lastLable._container.style.display="none",this._addLable(this._lastPoint,this._getDistanceString(this._totalDist),"dist-end")):this._clearLayers.call(this._currentDist));this._disableCompute()},_enableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.disable();this._startCompute=!0;b.on("click",this._setPath,this);b.on("dblclick contextmenu",this._finishCompute,this);b.doubleClickZoom.disable();var c=b._cursorTip=L.DomUtil.create("div","imap-cursorTip",b._container);c.style.cssText=" z-index: 1000;position:absolute;background-color:#fff;border:1px solid #f00;display:none;padding:2px;white-space:nowrap;";c.innerHTML="\u5355\u51fb\u786e\u5b9a\u5730\u70b9\uff0c\u53cc\u51fb\u7ed3\u675f";b.on("mousemove",this._onMove,this)},_disableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.enable();b._cursorTip.style.display="none";b.off("click",this._setPath,this);b.off("dblclick contextmenu",this._finishCompute,this);b.off("mousemove",this._onMove,this);b.doubleClickZoom.enable();this._startCompute=this._startMove=this._startPath=!1},_addMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[11,11],iconAnchor:[6,6],className:"md-icon"});b=new L.Marker(b,{icon:c,clickable:!1});this._map.addLayer(b);this._currentDist._layers.push(b)},_addPath:function(b){b=this._currentPath=new L.Polyline([b],{weight:2});this._map.addLayer(b);this._currentDist._layers.push(b);this._currentDist._map=this._map},_addLable:function(b,c,a){b=this._currentDist.lastLable=new L.Text({latlng:b,content:c,className:a});this._map.addLayer(b);this._currentDist._layers.push(b)},_addReomveMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[12,12],iconAnchor:[-10,7],className:"md-remove-icon"});b=new L.Marker(b,{icon:c});b.on("click",this._clearLayers,this._currentDist);this._map.addLayer(b);this._currentDist._layers.push(b)},_clearLayers:function(){var b,c=this._layers,a;b=0;for(a=c.length;b<a;b++)this._map.removeLayer(c[b])},_getDistanceString:function(b){return 1E3>b?b+"\u7c73":(b/1E3).toFixed(1)+"\u516c\u91cc"},_getDistance:function(b,c){var a=this._rad,e=a*b.lat,d=a*c.lat,a=2*Math.asin(Math.sqrt(Math.pow(Math.sin((e-d)/2),2)+Math.cos(e)*Math.cos(d)*Math.pow(Math.sin((a*b.lng-a*c.lng)/2),2)));return Math.round(6378137*a)}});L.ComputeArea=L.ToolbarClickAction.extend({options:{toolbarIcon:{className:"leaflet-ComputeDist"}},_rad:Math.PI/180,_deg:180/Math.PI,initialize:function(b,c){this._map=b;this._map._areaControl=this;L.setOptions(this,c);L.ToolbarClickAction.prototype.initialize.call(this,b,c)},addHooks:function(){this._onMouseClick()},_onMouseClick:function(){this._map._distControl._startCompute&&this._map._distControl._finishCompute();this._startCompute?this._finishCompute():this._enableCompute()},_setArea:function(b){b=b.latlng||this._map.mouseEventToLatLng(b);this._startArea?b.equals(this._lastPoint)||(this._addMarker(b),this._compute._latlngs.push(b)):(this._compute={_layers:[],_latlngs:[]},this._addArea(b),this._map.on("mousemove",this._onMove,this),this._startArea=!0,this._addMarker(b),this._compute._latlngs.push(b));this._lastPoint=b;this._startMove=!1},_onMove:function(b){var c=b.latlng;b=b.containerPoint;var a=this._map._cursorTip;a.style.left=b.x+7+"px";a.style.top=b.y+23+"px";a.style.display="";this._startArea&&(this._startMove?this._area.setLatLngs(this._compute._latlngs.concat(c)):(this._area.addLatLng(c),this._startMove=!0))},_finishCompute:function(b){this._startArea&&(2<this._compute._latlngs.length?((!b||"contextmenu"===b.type)&&this._area.setLatLngs(this._compute._latlngs),this._addReomveMarker(this._lastPoint),this._addLable(this._lastPoint,this._getAreaString(this._compute._latlngs),"area-result")):this._clearLayers.call(this._compute));this._disableCompute()},_enableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.disable();this._startCompute=!0;b.on("click",this._setArea,this);b.on("dblclick contextmenu",this._finishCompute,this);b.doubleClickZoom.disable();var c=b._cursorTip=L.DomUtil.create("div","imap-cursorTip",b._container);c.style.cssText=" z-index: 1000;position:absolute;background-color:#fff;border:1px solid #f00;display:none;padding:2px;white-space:nowrap;";c.innerHTML="\u5355\u51fb\u786e\u5b9a\u5730\u70b9\uff0c\u53cc\u51fb\u7ed3\u675f";b.on("mousemove",this._onMove,this)},_disableCompute:function(){var b=this._map;b.contextMenu&&b.contextMenu.enable();b._cursorTip.style.display="none";b.off("click",this._setArea,this);b.off("dblclick contextmenu",this._finishCompute,this);b.off("mousemove",this._onMove,this);b.doubleClickZoom.enable();this._startCompute=this._startMove=this._startArea=!1},_addMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[11,11],iconAnchor:[6,6],className:"md-icon"});b=new L.Marker(b,{icon:c,clickable:!1});this._map.addLayer(b);this._compute._layers.push(b)},_addArea:function(b){b=this._area=new L.Polygon([b],{weight:2,clickable:!1});this._map.addLayer(b);this._compute._layers.push(b);this._compute._map=this._map},_addLable:function(b,c,a){b=this._compute.lastLable=new L.Text({latlng:b,content:c,className:a});this._map.addLayer(b);this._compute._layers.push(b)},_addReomveMarker:function(b){var c=new L.Icon({iconUrl:"../src/Control/images/transparent.png",iconSize:[12,12],iconAnchor:[-10,7],className:"md-remove-icon"});b=new L.Marker(b,{icon:c});b.on("click",this._clearLayers,this._compute);this._map.addLayer(b);this._compute._layers.push(b)},_clearLayers:function(){var b,c=this._layers,a;b=0;for(a=c.length;b<a;b++)this._map.removeLayer(c[b])},_getAreaString:function(b){b=Math.round(this._computeArea(b));return 1E6>b?b+"\u5e73\u65b9\u7c73":(b/1E6).toFixed(2)+"\u5e73\u65b9\u516c\u91cc"},_computeArea:function(b){var c=0,a,e,d,f=b.length;for(a=0;a<f;++a)e=(a+1)%f,d=(a+2)%f,c+=this._angle(b[a],b[e],b[d]);b=180*(f-2);a=c-b;420<a?a=360*f-c-b:300<a&&420>a&&(a=Math.abs(360-a));return a*this._rad*40680631590769},_angle:function(b,c,a){b=this._bearing(c,b);c=this._bearing(c,a);c=b-c;0>c&&(c+=360);return c},_bearing:function(b,c){var a=this._rad,e=b.lat*a,d=b.lng*a,f=c.lat*a,a=a*c.lng,e=-Math.atan2(Math.sin(d-a)*Math.cos(f),Math.cos(e)*Math.sin(f)-Math.sin(e)*Math.cos(f)*Math.cos(d-a));0>e&&(e+=2*Math.PI);return e*=this._deg}})})(window,document);(function(f,g,d){L.drawVersion="0.4.9";L.Draw={};L.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5df2\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u70b9"},buttons:{polyline:"\u7ed8\u5236\u591a\u6bb5\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u957f\u65b9\u5f62",circle:"\u7ed8\u5236\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706"},radius:"\u534a\u5f84"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u9762",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u9762"}},polyline:{error:"\x3cstrong\x3e\u9519\u8bef:\x3c/strong\x3e \u4e0d\u53ef\u81ea\u4ea4\u53c9!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706\u77e9\u5f62"}},simpleshape:{tooltip:{end:"\u653e\u5f00\u9f20\u6807\u5b8c\u6210\u7ed8\u5236"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u4fee\u6539",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u4fee\u6539",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42",editDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u7f16\u8f91",remove:"\u5220\u9664\u56fe\u5c42",removeDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u5220\u9664"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u63a7\u5236\u70b9\u6216\u6807\u8bb0\u4ee5\u4fee\u6539\u8981\u7d20",subtext:"\u70b9\u51fb\u53d6\u6d88\u653e\u5f03\u4fee\u6539"}},remove:{tooltip:{text:"\u70b9\u51fb\u4e00\u4e2a\u8981\u7d20\u4ee5\u5220\u9664"}}}}};L.Draw.Event={};L.Draw.Event.CREATED="draw:created";L.Draw.Event.EDITED="draw:edited";L.Draw.Event.DELETED="draw:deleted";L.Draw.Event.DRAWSTART="draw:drawstart";L.Draw.Event.DRAWSTOP="draw:drawstop";L.Draw.Event.DRAWVERTEX="draw:drawvertex";L.Draw.Event.EDITSTART="draw:editstart";L.Draw.Event.EDITMOVE="draw:editmove";L.Draw.Event.EDITRESIZE="draw:editresize";L.Draw.Event.EDITVERTEX="draw:editvertex";L.Draw.Event.EDITSTOP="draw:editstop";L.Draw.Event.DELETESTART="draw:deletestart";L.Draw.Event.DELETESTOP="draw:deletestop";L.Draw=L.Draw||{};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(c,b){this._map=c;this._container=c._container;this._overlayPane=c._panes.overlayPane;this._popupPane=c._panes.popupPane;b&&b.shapeOptions&&(b.shapeOptions=L.Util.extend({},this.options.shapeOptions,b.shapeOptions));L.setOptions(this,b)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(L.DomUtil.disableTextSelection(),c.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(c){L.setOptions(this,c)},_fireCreatedEvent:function(c){this._map.fire(L.Draw.Event.CREATED,{layer:c,layerType:this.type})},_cancelDrawing:function(c){this._map.fire("draw:canceled",{layerType:this.type});27===c.keyCode&&this.disable()}});L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4E3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2E3},initialize:function(c,b){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;b&&b.drawError&&(b.drawError=L.Util.extend({},this.options.drawError,b.drawError));this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(1>=this._markers.length)){var c=this._markers.pop(),b=this._poly,d=b.getLatLngs(),a=d.splice(-1,1)[0];this._poly.setLatLngs(d);this._markerGroup.removeLayer(c);2>b.getLatLngs().length&&this._map.removeLayer(b);this._vertexChanged(a,!1)}},addVertex:function(c){2<=this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(c)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(c)),this._poly.addLatLng(c),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(c,!0))},completeShape:function(){1>=this._markers.length||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var c=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),c=this._poly.newLatLngIntersects(c[c.length-1]);!this.options.allowIntersection&&c||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent),d=this._map.layerPointToLatLng(b);this._currentLatLng=d;this._updateTooltip(d);this._updateGuide(b);this._mouseMarker.setLatLng(d);L.DomEvent.preventDefault(c.originalEvent)},_vertexChanged:function(c,b){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(c,b);this._clearGuides();this._updateTooltip()},_onMouseDown:function(c){this._clickHandled||this._touchHandled||this._disableMarkers||(this._onMouseMove(c),this._clickHandled=!0,this._disableNewMarkers(),c=c.originalEvent,this._startPoint.call(this,c.clientX,c.clientY))},_startPoint:function(c,b){this._mouseDownOrigin=L.point(c,b)},_onMouseUp:function(c){var b=c.originalEvent;this._endPoint.call(this,b.clientX,b.clientY,c);this._clickHandled=null},_endPoint:function(c,b,d){this._mouseDownOrigin&&(c=L.point(c,b).distanceTo(this._mouseDownOrigin),10>this._calculateFinishDistance(d.latlng)&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(f.devicePixelRatio||1)&&this.addVertex(d.latlng),this._enableNewMarkers());this._mouseDownOrigin=null},_onTouch:function(c){var b=c.originalEvent,d;!b.touches||!b.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(d=b.touches[0].clientX,b=b.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,d,b),this._endPoint.call(this,d,b,c),this._touchHandled=null);this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(c){var b;if(0<this._markers.length){if(this.type===L.Draw.Polyline.TYPE)b=this._markers[this._markers.length-1];else if(this.type===L.Draw.Polygon.TYPE)b=this._markers[0];else return Infinity;b=this._map.latLngToContainerPoint(b.getLatLng());c=new L.Marker(c,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});c=this._map.latLngToContainerPoint(c.getLatLng());b=b.distanceTo(c)}else b=Infinity;return b},_updateFinishHandler:function(){var c=this._markers.length;if(1<c)this._markers[c-1].on("click",this._finishShape,this);2<c&&this._markers[c-2].off("click",this._finishShape,this)},_createMarker:function(c){c=new L.Marker(c,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});this._markerGroup.addLayer(c);return c},_updateGuide:function(c){var b=this._markers?this._markers.length:0;0<b&&(c=c||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[b-1].getLatLng()),c))},_updateTooltip:function(c){var b=this._getTooltipText();c&&this._tooltip.updatePosition(c);this._errorShown||this._tooltip.updateContent(b)},_drawGuide:function(c,b){var d=Math.floor(Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))),a=this.options.guidelineDistance,e=this.options.maxGuideLineLength,a=d>e?d-e:a,f;this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));for(;a<d;a+=this.options.guidelineDistance)e=a/d,e={x:Math.floor(c.x*(1-e)+e*b.x),y:Math.floor(c.y*(1-e)+e*b.y)},f=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),f.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(f,e)},_updateGuideColor:function(c){if(this._guidesContainer)for(var b=0,d=this._guidesContainer.childNodes.length;b<d;b++)this._guidesContainer.childNodes[b].style.backgroundColor=c},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var c=this.options.showLength;L.Browser.touch&&(c=!1);0===this._markers.length?c={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(c=c?this._getMeasurementString():"",c=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:c}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:c});return c},_updateRunningMeasure:function(c,b){var d=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(d=c.distanceTo(this._markers[d-(b?2:1)].getLatLng()),this._measurementRunningTotal+=d*(b?1:-1))},_getMeasurementString:function(){var c=this._currentLatLng,b=this._markers[this._markers.length-1].getLatLng(),c=this._measurementRunningTotal+c.distanceTo(b);return L.GeometryUtil.readableDistance(c,this.options.metric,this.options.feet,this.options.nautic)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var c=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,c)}});L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(c,b){L.Draw.Polyline.prototype.initialize.call(this,c,b);this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var c=this._markers.length;if(1===c)this._markers[0].on("click",this._finishShape,this);2<c&&(this._markers[c-1].on("dblclick",this._finishShape,this),3<c&&this._markers[c-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var c,b;0===this._markers.length?c=L.drawLocal.draw.handlers.polygon.tooltip.start:3>this._markers.length?c=L.drawLocal.draw.handlers.polygon.tooltip.cont:(c=L.drawLocal.draw.handlers.polygon.tooltip.end,b=this._getMeasurementString());return{text:c,subtext:b}},_getMeasurementString:function(){var c=this._area;return c?L.GeometryUtil.readableArea(c,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(c,b){var d;!this.options.allowIntersection&&this.options.showArea&&(d=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(d));L.Draw.Polyline.prototype._vertexChanged.call(this,c,b)},_cleanUpShape:function(){var c=this._markers.length;0<c&&(this._markers[0].off("click",this._finishShape,this),2<c&&this._markers[c-1].off("dblclick",this._finishShape,this))}});L.SimpleShape={};L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(c,b){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&((this._mapDraggable=this._map.dragging.enabled())&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(g,"mouseup",this._onMouseUp,this),L.DomEvent.off(g,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(c){this._isDrawing=!0;this._startLatLng=c.latlng;L.DomEvent.on(g,"mouseup",this._onMouseUp,this).on(g,"touchend",this._onMouseUp,this).preventDefault(c.originalEvent)},_onMouseMove:function(c){c=c.latlng;this._tooltip.updatePosition(c);this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(c))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()}});L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,showArea:!0,clickable:!0},metric:!0},initialize:function(c,b){this.type=L.Draw.Rectangle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,c,b)},_drawShape:function(c){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,c)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,c),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var c=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,c)},_getTooltipText:function(){var c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),b=this.options.showArea,d;this._shape&&(d=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),d=L.GeometryUtil.geodesicArea(d),d=b?L.GeometryUtil.readableArea(d,this.options.metric):"");return{text:c.text,subtext:d}}});L.Draw.Textbox=L.Draw.Rectangle.extend({statics:{TYPE:"textbox"},options:{shapeOptions:{},textOptions:{borderColor:"#4387fd",borderWidth:2}},initialize:function(c,b){this.options.textOptions=L.extend({},this.options.textOptions,b);this._setShapeOptions();L.Draw.Rectangle.prototype.initialize.call(this,c,b);this.type=L.Draw.Textbox.TYPE},_fireCreatedEvent:function(){var c=this._shape.getLatLngs()[0],b=(new L.LatLngBounds(c)).getCenter(),d=c[3],c=this._map.latLngToLayerPoint(c[1]).round(),a=this._map.latLngToLayerPoint(d).round(),d=a.x-c.x+2,c=a.y-c.y+2,b=(new L.Textbox(b,this.options.textOptions)).setSize(new L.Point(d,c));L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,b)},_setShapeOptions:function(){this.options.shapeOptions=L.extend({},this.options.shapeOptions,{weight:this.options.textOptions.borderWidth?this.options.textOptions.borderWidth:2,color:this.options.textOptions.borderColor?this.options.textOptions.borderColor:"#4387fd",fill:!1,opacity:1})}});L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(c,b){this.type=L.Draw.Circle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,c,b)},_drawShape:function(c){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(c)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(c),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var c=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,c)},_onMouseMove:function(c){var b=c.latlng;c=this.options.showRadius;var d=this.options.metric;this._tooltip.updatePosition(b);if(this._isDrawing){this._drawShape(b);var b=this._shape.getRadius().toFixed(1),a="";c&&(a=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(b,d,this.options.feet,this.options.nautic));this._tooltip.updateContent({text:this._endLabelText,subtext:a})}}});L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2E3},initialize:function(c,b){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,c,b)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(c){c=c.latlng;this._tooltip.updatePosition(c);this._mouseMarker.setLatLng(c);this._marker?(c=this._mouseMarker.getLatLng(),this._marker.setLatLng(c)):(this._marker=new L.Marker(c,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent();this.disable();this.options.repeatMode&&this.enable()},_onTouch:function(c){this._onMouseMove(c);this._onClick()},_fireCreatedEvent:function(){var c=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,c)}});L.Edit=L.Edit||{};L.Edit.Marker=L.Handler.extend({initialize:function(c,b){this._marker=c;L.setOptions(this,b)},addHooks:function(){var c=this._marker;c.dragging.enable();c.on("dragend",this._onDragEnd,c);this._toggleMarkerHighlight()},removeHooks:function(){var c=this._marker;c.dragging.disable();c.off("dragend",this._onDragEnd,c);this._toggleMarkerHighlight()},_onDragEnd:function(c){c=c.target;c.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:c})},_toggleMarkerHighlight:function(){var c=this._marker._icon;c&&(c.style.display="none",L.DomUtil.hasClass(c,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(c,"leaflet-edit-marker-selected"),this._offsetMarker(c,-4)):(L.DomUtil.addClass(c,"leaflet-edit-marker-selected"),this._offsetMarker(c,4)),c.style.display="")},_offsetMarker:function(c,b){var d=parseInt(c.style.marginTop,10)-b,a=parseInt(c.style.marginLeft,10)-b;c.style.marginTop=d+"px";c.style.marginLeft=a+"px"}});L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{},initialize:function(c,b){this.latlngs=[c._latlngs];c._holes&&(this.latlngs=this.latlngs.concat(c._holes));this._poly=c;L.setOptions(this,b);this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(c){for(var b=0;b<this._verticesHandlers.length;b++)c(this._verticesHandlers[b])},addHooks:function(){this._initHandlers();this._eachVertexHandler(function(c){c.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(c){c.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(c){c.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var c=0;c<this.latlngs.length;c++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[c],this.options))},_updateLatLngs:function(c){this.latlngs=[c.layer._latlngs];c.layer._holes&&(this.latlngs=this.latlngs.concat(c.layer._holes))}});L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1E3}},initialize:function(c,b,d){L.Browser.touch&&(this.options.icon=this.options.touchIcon);this._poly=c;d&&d.drawError&&(d.drawError=L.Util.extend({},this.options.drawError,d.drawError));this._latlngs=b;L.setOptions(this,d)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var c=this._poly;c instanceof L.Polygon||(c.options.fill=!1,c.options.editing&&(c.options.editing.fill=!1));c.setStyle(c.options.editing);this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var c=this._poly;c.setStyle(c.options.original);c._map&&(c._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._markers=[];var c=this._defaultShape(),b,d,a;b=0;for(d=c.length;b<d;b++)a=this._createMarker(c[b],b),a.on("click",this._onMarkerClick,this),this._markers.push(a);b=0;for(c=d-1;b<d;c=b++)if(0!==b||L.Polygon&&this._poly instanceof L.Polygon)c=this._markers[c],a=this._markers[b],this._createMiddleMarker(c,a),this._updatePrevNext(c,a)},_createMarker:function(c,b){var d=new L.Marker.Touch(c,{draggable:!0,icon:this.options.icon});d._origLatLng=c;d._index=b;d.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this);this._markerGroup.addLayer(d);return d},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var c=this._defaultShape(),b=[].splice.apply(c,arguments);this._poly._convertLatLngs(c,!0);this._poly.redraw();return b},_removeMarker:function(c){var b=c._index;this._markerGroup.removeLayer(c);this._markers.splice(b,1);this._spliceLatLngs(b,1);this._updateIndexes(b,-1);c.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0;this._poly.fire("edit");this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(c){var b=c.target,d=this._poly;L.extend(b._origLatLng,b._latlng);b._middleLeft&&b._middleLeft.setLatLng(this._getMiddleLatLng(b._prev,b));b._middleRight&&b._middleRight.setLatLng(this._getMiddleLatLng(b,b._next));if(d.options.poly){var a=d._map._editTooltip;if(!d.options.poly.allowIntersection&&d.intersects()){var e=d.options.color;d.setStyle({color:this.options.drawError.color});0!==L.version.indexOf("0.7")&&b.dragging._draggable._onUp(c);this._onMarkerClick(c);a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error});setTimeout(function(){d.setStyle({color:e});a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1E3)}}this._poly.redraw();this._poly.fire("editdrag")},_onMarkerClick:function(c){var b=L.Polygon&&this._poly instanceof L.Polygon?4:3;c=c.target;this._defaultShape().length<b||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);c=c.target;L.extend(c._origLatLng,b);c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c));c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next));this._poly.redraw();this.updateMarkers()},_updateIndexes:function(c,b){this._markerGroup.eachLayer(function(d){d._index>c&&(d._index+=b)})},_createMiddleMarker:function(c,b){var d=this._getMiddleLatLng(c,b),a=this._createMarker(d),e,f,k;a.setOpacity(.6);c._middleRight=b._middleLeft=a;f=function(){a.off("touchmove",f,this);var k=b._index;a._index=k;a.off("click",e,this).on("click",this._onMarkerClick,this);d.lat=a.getLatLng().lat;d.lng=a.getLatLng().lng;this._spliceLatLngs(k,0,d);this._markers.splice(k,0,a);a.setOpacity(1);this._updateIndexes(k,1);b._index++;this._updatePrevNext(c,a);this._updatePrevNext(a,b);this._poly.fire("editstart")};k=function(){a.off("dragstart",f,this);a.off("dragend",k,this);a.off("touchmove",f,this);this._createMiddleMarker(c,a);this._createMiddleMarker(a,b)};e=function(){f.call(this);k.call(this);this._fireEdit()};a.on("click",e,this).on("dragstart",f,this).on("dragend",k,this).on("touchmove",f,this);this._markerGroup.addLayer(a)},_updatePrevNext:function(c,b){c&&(c._next=b);b&&(b._prev=c)},_getMiddleLatLng:function(c,b){var d=this._poly._map,a=d.project(c.getLatLng()),e=d.project(b.getLatLng());return d.unproject(a._add(e)._divideBy(2))}});L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});L.RotatableMarker=L.Marker.extend({options:{rotation:0},initialize:function(c,b){L.Marker.prototype.initialize.call(this,c,b);this.setRotation(this.options.rotation)},setRotation:function(c){this._rotation=c;this.update();this.fire("rotate",{rotation:this._rotation});return this},getRotation:function(){return this._rotation},_setPos:function(c){L.DomUtil.setTransform(this._icon,c,this._rotation);this._shadow&&L.DomUtil.setTransform(this._shadow,c,this._rotation);this._zIndex=c.y+this.options.zIndexOffset;this._resetZIndex()}});L.rotatableMarker=function(c,b){return new L.RotatableMarker(c,b)};L.Pointer=L.Path.extend({options:{noClip:!1},initialize:function(c,b,d){L.setOptions(this,d);this._coordinates=b;this._latlng=c},onAdd:function(c){this._map=c;this._container||this._initElements();this._updatePath();this._container&&this._pathRoot.appendChild(this._container);this.fire("add");c.on({viewreset:this._updatePath,moveend:this._updatePath},this)},onRemove:function(c){this._unbindPathRoot();this._pathRoot.parentNode.removeChild(this._pathRoot);c.off({viewreset:this._updatePath,moveend:this._updatePath},this);this.fire("remove");this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(c){this._latlng=c;this._updatePath();return this},getPoints:function(){return this._coordinates},setPoints:function(c){this._coordinates=c;this._updatePath();return this},getPathString:function(){return L.Polyline.prototype.getPathString.call(this)},_getPathPartStr:function(c){return L.Polyline.prototype._getPathPartStr.call(this,c)},_getLatLngs:function(){for(var c=this._map.latLngToLayerPoint(this._latlng),b=[],d=0,a=this._coordinates.length;d<a;d++)b[d]=this._map.layerPointToLatLng(this._coordinates[d].add(c));return b},_projectCoordinatesToLayerPoints:function(){var c=this._map.latLngToLayerPoint(this._latlng),b;this._layerPoints=[];for(var d=0,a=this._coordinates.length;d<a;d++)b=this._coordinates[d].add(c),this._layerPoints[d]=b},_clipPoints:function(){var c=this._layerPoints,b=c.length,d,a,e;if(this.options.noClip)this._parts=[c];else{var f=this._parts=[],k=this._pathViewport,g=L.LineUtil;for(a=d=0;d<b-1;d++)if(e=g.clipSegment(c[d],c[d+1],k,d))if(f[a]=f[a]||[],f[a].push(e[0]),e[1]!==c[d+1]||d===b-2)f[a].push(e[1]),a++}},_updatePath:function(){this._map&&(this._projectCoordinatesToLayerPoints(),this._clipPoints(),this._renderer._updatePath.call(this))}});L.Pointer=L.Pointer.extend({_initElements:function(){this._initPathRoot()},_animateZoom:function(c){var b=this._map.latLngToLayerPoint(this._latlng);c=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).subtract(b);this._pathRoot.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(this._pathViewport.min.add(c));this._pathZooming=!0},_endZoom:function(){this._pathZooming=!1},_initPathRoot:function(){this._pathRoot||(this._pathRoot=L.SVG.create("svg"),this._map._panes.overlayPane.appendChild(this._pathRoot));this._map.options.zoomAnimation&&L.Browser.any3d?(L.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this._map.on({zoomanim:this._animateZoom,zoomend:this._endZoom},this)):L.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide");this._map.on("moveend",this._updateSvgViewport,this);this._updateSvgViewport()},_unbindPathRoot:function(){this._map.off({zoomanim:this._animateZoom,zoomend:this._endZoom,moveend:this._updateSvgViewport},this)},_getPanePos:function(){return L.DomUtil.getPosition(this._pathRoot)},_updatePathViewport:function(){var c=L.Path.CLIP_PADDING,b=this._map.getSize(),d=this._map._getMapPanePos().multiplyBy(-1)._subtract(b.multiplyBy(c)._round()),c=d.add(b.multiplyBy(1+2*c)._round());this._pathViewport=new L.Bounds(d,c)},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var c=this._pathViewport,b=c.min,d=c.max,c=d.x-b.x,d=d.y-b.y,a=this._map._panes.overlayPane;L.Browser.mobileWebkit&&a.removeChild(this._pathRoot);L.DomUtil.setPosition(this._pathRoot,b);this._pathRoot.setAttribute("width",c);this._pathRoot.setAttribute("height",d);this._pathRoot.setAttribute("viewBox",[b.x,b.y,c,d].join(" "));L.Browser.mobileWebkit&&a.appendChild(this._pathRoot)}}});L.Textbox=L.RotatableMarker.extend({statics:{TYPE:"textbox",TEXTEDIT_EVENTS:["change","keyup","paste","cut"]},includes:[L.Mixin.Events],options:{minSize:new L.Point(10,10),textEditable:!0,textContent:""},initialize:function(c,b){b.icon=new L.DivIcon({className:"leaflet-textbox-container",html:'\x3ctextarea style\x3d"width: 100%; height: 100%"\x3e'+this.options.textContent+"\x3c/textarea\x3e",iconAnchor:new L.Point(0,0)});L.RotatableMarker.prototype.initialize.call(this,c,b);this._textContent=this.options.textContent;this._minSize=this.options.minSize;this.setSize(this.options.size||this._minSize)},onAdd:function(c){var b;L.RotatableMarker.prototype.onAdd.call(this,c);c=this.getTextarea();this.setContent(this._textContent);this.setLatLng(this._latlng);this._updateSize();this._enableTyping();this.options.textEditable||c.setAttribute("readonly","readonly");this._addClasses();for(var d=0;d<L.Textbox.TEXTEDIT_EVENTS.length;d++)b=L.Textbox.TEXTEDIT_EVENTS[d],L.DomEvent.on(c,b,this._showIfEmpty,this);this._showIfEmpty({target:c})},addTo:function(c){c.addLayer(this);return this},onRemove:function(c){this._map.dragging.enable();this.getContent();L.RotatableMarker.prototype.onRemove.call(this,c)},getSize:function(){return this._size},setSize:function(c){this._minSize=new L.Point(c.x<this._minSize.x?c.x:this._minSize.x,c.y<this._minSize.y?c.y:this._minSize.y);this._size=c;this._map&&this._updateSize();this.fire("resize",{size:this._size});return this},setContent:function(c){this.getTextarea().innerHTML=c;return this},getContent:function(){this._map&&(this._textContent=this.getTextarea().value);return this._textContent},_updateCenter:function(){this.setLatLng(this._latlng)},setStyle:function(){return this},getTextarea:function(){return this._icon.children[0]},_updateSize:function(){var c=this.getSize();this._icon&&(this._icon.style.marginTop=-Math.round(c.y/2)+"px",this._icon.style.marginLeft=-Math.round(c.x/2)+"px",this._icon.style.width=c.x+"px",this._icon.style.height=c.y+"px")},_onTextEdit:function(){this._text_edited&&(this.fire("textedit",{textContent:this.getContent()}),this._text_edited=!1)},_enableTyping:function(){var c=this._map,b=this.getTextarea(),d=function(){this._text_edited=!0},a;this._selecting=new L.Selectable(b);L.DomEvent.on(b,"click",function(a){a.target.focus()},this);L.DomEvent.on(b,"mouseover",function(){c.dragging.disable();this._selecting.enable()},this);L.DomEvent.on(b,"mouseout",function(){c.dragging.enable();this._selecting.disable()},this);for(var e=0;e<L.Textbox.TEXTEDIT_EVENTS.length;e++)a=L.Textbox.TEXTEDIT_EVENTS[e],L.DomEvent.on(b,a,d,this);L.DomEvent.on(b,"blur",this._onTextEdit,this)},_showIfEmpty:function(c){c=c.target;""===c.value?L.DomUtil.addClass(c,"leaflet-textbox-empty"):L.DomUtil.removeClass(c,"leaflet-textbox-empty")},_addClasses:function(){var c=this.getTextarea();L.DomUtil.addClass(c,"leaflet-textbox");this.options.className&&L.Domutil.addClass(c,this.options.className)}});L.Textbox.prototype.toGeoJSON=function(){var c=this.getSize(),c={textContent:this.getContent(),style:{width:c.x,height:c.y,rotation:this.getRotation()}},b=L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())});b.properties=c;return b};L.textbox=function(c,b){return new L.Textbox(c,b)};L.Edit=L.Edit||{};L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(c,b){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon);this._shape=c;L.Util.setOptions(this,b)},addHooks:function(){var c=this._shape;this._shape._map&&(this._map=this._shape._map,c.setStyle(c.options.editing),c._map&&(this._map=c._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var c=this._shape;c.setStyle(c.options.original);if(c._map){this._unbindMarker(this._moveMarker);for(var c=0,b=this._resizeMarkers.length;c<b;c++)this._unbindMarker(this._resizeMarkers[c]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup);this._createMoveMarker();this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(c,b){var d=new L.Marker.Touch(c,{draggable:!0,icon:b,zIndexOffset:10});this._bindMarker(d);this._markerGroup.addLayer(d);return d},_bindMarker:function(c){c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(c){c.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(c){c.target.setOpacity(0);this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0;this._shape.fire("edit")},_onMarkerDrag:function(c){c=c.target;var b=c.getLatLng();c===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();this._shape.fire("editdrag")},_onMarkerDragEnd:function(c){c.target.setOpacity(1);this._fireEdit()},_onTouchStart:function(c){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,c);if("function"===typeof this._getCorners){var b=this._getCorners();c=c.target;var d=c._cornerIndex;c.setOpacity(0);this._oppositeCorner=b[(d+2)%4];this._toggleCornerMarkers(0,d)}this._shape.fire("editstart")},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.touches[0]),b=this._map.layerPointToLatLng(b);c.target===this._moveMarker?this._move(b):this._resize(b);this._shape.redraw();return!1},_onTouchEnd:function(c){c.target.setOpacity(1);this.updateMarkers();this._fireEdit()},_move:function(){},_resize:function(){}});L.Edit.Textbox=L.Edit.SimpleShape.extend({addHooks:function(){this._shape.dragging.disable();this._shape._map&&(this._map=this._shape._map,this._initHandles(),this._initEvents())},removeHooks:function(){this._shape._map&&(this._map.removeLayer(this._handles),delete this._handles);this._map=null},_initHandles:function(){this._handles||(this._handles=new L.LayerGroup,this._map.addLayer(this._handles),this._addRotateHandle(),this._addResizeHandles(),this._addMoveHandle())},_initEvents:function(){for(var c=function(){this._shape.fire("edit")},b=["resize","rotate","textedit","move"],d=0;d<b.length;d++)this._shape.on(b[d],c,this)},_addRotateHandle:function(){this._rotateHandle=new L.RotateHandle(this._shape,{offset:new L.Point(0,-this._shape.getSize().y)});this._handles.addLayer(this._rotateHandle)},_addMoveHandle:function(){this._moveHandle=new L.MoveHandle(this._shape,{offset:new L.Point(0,0)});this._handles.addLayer(this._moveHandle)},_addResizeHandles:function(){var c=this._shape.getSize(),b=Math.round(c.y/2),d=Math.round(c.x/2),c=new L.ResizeHandle(this._shape,{offset:new L.Point(-d,-b),corner:"upper-left"}),a=new L.ResizeHandle(this._shape,{offset:new L.Point(d,-b),corner:"upper-right"}),e=new L.ResizeHandle(this._shape,{offset:new L.Point(-d,b),corner:"lower-left"}),b=new L.ResizeHandle(this._shape,{offset:new L.Point(d,b),corner:"lower-right"});this._resizeHandles=[c,a,e,b];for(b=0;b<this._resizeHandles.length;b++)this._handles.addLayer(this._resizeHandles[b])}});L.Textbox.addInitHook(function(){});L.Selectable=L.Handler.extend({includes:[L.Mixin.Events],statics:{START:L.Draggable.START,END:L.Draggable.END,MOVE:L.Draggable.MOVE},initialize:function(c,b){this._element=c;this._selectStartTarget=b||c},addHooks:function(){L.DomEvent.on(this._selectStartTarget,L.Selectable.START.join(" "),this._onDown,this)},removeHooks:function(){L.DomEvent.off(this._selectStartTarget,L.Selectable.START.join(" "),this._onDown,this)},_onDown:function(c){L.DomEvent.stopPropagation(c)}});L.EditHandle=L.RotatableMarker.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"})},initialize:function(c,b){L.setOptions(this,b);this._handleOffset=new L.Point(b.offset.x||0,b.offset.y||0);this._handled=c;var d=this._handled._map.layerPointToLatLng(this._textboxCoordsToLayerPoint(this._handleOffset)),a={draggable:!0,icon:this.options.resizeIcon,zIndexOffset:10};this._handled.getRotation&&(a.rotation=this._handled.getRotation());L.RotatableMarker.prototype.initialize.call(this,d,a)},onAdd:function(c){L.RotatableMarker.prototype.onAdd.call(this,c);this._bindListeners()},onRemove:function(c){this._unbindListeners();L.RotatableMarker.prototype.onRemove.call(this,c)},_animateZoom:function(c){var b=this._handled._map,d=b._newLayerPointToLatLng(this._textboxCoordsToLayerPoint(this._handleOffset,c),c.zoom,c.center);c=b._latLngToNewLayerPoint(d,c.zoom,c.center).round();this._setPos(c)},updateHandle:function(){var c=this._handled.getRotation(),b=this._textboxCoordsToLatLng(this._handleOffset);this.setRotation(c);this.setLatLng(b)},_onHandleDragStart:function(){this._handled.fire("editstart")},_onHandleDragEnd:function(){this._fireEdit()},_fireEdit:function(){this._handled.edited=!0;this._handled.fire("edit")},_bindListeners:function(){this.on({dragstart:this._onHandleDragStart,drag:this._onHandleDrag,dragend:this._onHandleDragEnd},this);this._handled._map.on("zoomend",this.updateHandle,this);this._handled.on("rotate",this.updateHandle,this);this._handled.on("resize",this.updateHandle,this);this._handled.on("move",this.updateHandle,this)},_unbindListeners:function(){this.off({dragstart:this._onHandleDragStart,drag:this._onHandleDrag,dragend:this._onHandleDragEnd},this);this._handled._map.off("zoomend",this.updateHandle,this);this._handled.off("update",this.updateHandle,this)},_calculateRotation:function(c,b){return(new L.Point(c.x*Math.cos(b)-c.y*Math.sin(b),c.y*Math.cos(b)+c.x*Math.sin(b))).round()},_layerPointToTextboxCoords:function(c,b){var d=this._handled._map,a=this._handled.getRotation(),e=this._handled.getLatLng(),d=b&&b.zoom&&b.center?d._latLngToNewLayerPoint(e,b.zoom,b.center):d.latLngToLayerPoint(e),d=c.subtract(d);return this._calculateRotation(d,-a)},_textboxCoordsToLayerPoint:function(c,b){var d=this._handled._map,a=this._handled.getRotation(),e=this._handled.getLatLng(),d=b&&b.zoom&&b.center?d._latLngToNewLayerPoint(e,b.zoom,b.center):d.latLngToLayerPoint(e);return this._calculateRotation(c,a).add(d)},_latLngToTextboxCoords:function(c,b){return this._layerPointToTextboxCoords(this._handled._map.latLngToLayerPoint(c),b)},_textboxCoordsToLatLng:function(c,b){return this._handled._map.layerPointToLatLng(this._textboxCoordsToLayerPoint(c,b))}});L.MoveHandle=L.EditHandle.extend({options:{TYPE:"move"},_onHandleDrag:function(c){this._handled.setLatLng(c.target.getLatLng())}});L.PointerHandle=L.EditHandle.extend({initialize:function(c,b){L.EditHandle.prototype.initialize.call(this,c,b);this._handled.editing&&(this._editing=this._handled.editing);this._id=b.id;this._type=b.type},_onHandleDrag:function(c){c=c.target;var b=this._editing;this._handleOffset=this._latLngToTextboxCoords(this.getLatLng());switch(c._type){case "vertex":b._updateVertex(c);break;case "midpoint":b._addVertex(c)}},_onHandleClick:function(c){c=c.target;var b=this._editing;this._handleOffset=this._latLngToTextboxCoords(c.getLatLng());switch(this._type){case "vertex":b._removeVertex(c);break;case "midpoint":b._addVertex(c)}},_bindListeners:function(){L.EditHandle.prototype._bindListeners.call(this);this.on("click",this._onHandleClick,this);this._handled.on({"edit:remove-vertex":this._onVertexRemove,"edit:add-vertex":this._onVertexAdd,"edit:update-vertex":this._onVertexUpdate},this)},_unbindListeners:function(){L.EditHandle.prototype._unbindListeners.call(this);this.off("click",this._onHandleClick,this);this._handled.off({"edit:remove-vertex":this._onVertexRemove,"edit:add-vertex":this._onVertexAdd,"edit:update-vertex":this._onVertexUpdate},this)},_onVertexAdd:function(c){c=c.addedId;this._id===c?(this._id+=1,this._type="vertex",this.setOpacity(1)):this._id>c&&(this._id+=2)},_onVertexRemove:function(c){this._id>c.removedId+1&&(this._id-=2)},_onVertexUpdate:function(c){var b=this._handled.editing,d=c.handle;c=d._id;var a=b._handleIdToCoordIndex(c,d._type),d=this._handled,e=d._map.latLngToLayerPoint(d.getLatLng());this._id===c-1&&0<a?(b=b._calculateMidpoint(a-1,a).add(e),b=d._map.layerPointToLatLng(b),this.setLatLng(b)):this._id===c+1&&a+1<d.getPoints().length&&(b=b._calculateMidpoint(a,a+1).add(e),b=d._map.layerPointToLatLng(b),this.setLatLng(b))}});L.ResizeHandle=L.EditHandle.extend({options:{TYPE:"resize"},initialize:function(c,b){L.EditHandle.prototype.initialize.call(this,c,b);this._corner=b.corner},_onHandleDrag:function(c){c=this._getOffset(c.target.getLatLng());this._handled.setSize(c.abs().multiplyBy(2).round())},_getOffset:function(c){c=this._latLngToTextboxCoords(c);var b=this._handled._minSize.divideBy(2);return new L.Point(Math.abs(c.x)<b.x?b.x:c.x,Math.abs(c.y)<b.y?b.y:c.y)},updateHandle:function(){var c=this._handled.getSize(),b=Math.round(c.y/2),c=Math.round(c.x/2);switch(this._corner){case "upper-left":this._handleOffset=new L.Point(-c,b);break;case "upper-right":this._handleOffset=new L.Point(c,b);break;case "lower-left":this._handleOffset=new L.Point(-c,-b);break;case "lower-right":this._handleOffset=new L.Point(c,-b)}L.EditHandle.prototype.updateHandle.call(this)}});L.RotateHandle=L.EditHandle.extend({options:{TYPE:"rotate"},initialize:function(c,b){L.EditHandle.prototype.initialize.call(this,c,b);this._createPointer()},onAdd:function(c){L.EditHandle.prototype.onAdd.call(this,c);this._map.addLayer(this._pointer)},onRemove:function(c){this._map.removeLayer(this._pointer);L.EditHandle.prototype.onRemove.call(this,c)},_onHandleDrag:function(c){c=c.target.getLatLng();var b=this._handled.getLatLng();c=this._map.latLngToLayerPoint(c).subtract(this._map.latLngToLayerPoint(b));this._handled.setRotation(0<c.y?Math.PI-Math.atan(c.x/c.y):-Math.atan(c.x/c.y))},updateHandle:function(){this._handleOffset=new L.Point(0,-this._handled.getSize().y);this._updatePointer();L.EditHandle.prototype.updateHandle.call(this)},_createPointer:function(){var c=this._handled.getTextarea(),b=L.DomUtil.getStyle(c,"border-width"),c={color:L.DomUtil.getStyle(c,"border-color"),weight:Math.round(b)};this._pointer=new L.Pointer(this._handled.getLatLng(),[],c);this._updatePointer();this._handled.on({update:this._updatePointer},this)},_updatePointer:function(){var c=this._handled._map,b=this._handled.getLatLng(),c=c.latLngToLayerPoint(b);this._pointerStart=this._handleOffset.multiplyBy(.5);this._pointer.setLatLng(b);this._pointer.setPoints([this._textboxCoordsToLayerPoint(this._pointerStart).subtract(c),this._textboxCoordsToLayerPoint(this._handleOffset).subtract(c)])}});L.Edit=L.Edit||{};L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var c=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var c=this._getCorners();this._resizeMarkers=[];for(var b=0,d=c.length;b<d;b++)this._resizeMarkers.push(this._createMarker(c[b],this.options.resizeIcon)),this._resizeMarkers[b]._cornerIndex=b},_onMarkerDragStart:function(c){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,c);var b=this._getCorners();c=c.target._cornerIndex;this._oppositeCorner=b[(c+2)%4];this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(c){var b=c.target,d;b===this._moveMarker&&(d=this._shape.getBounds(),d=d.getCenter(),b.setLatLng(d));this._toggleCornerMarkers(1);this._repositionCornerMarkers();L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,c)},_move:function(c){for(var b=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),d=this._shape.getBounds().getCenter(),a,e=[],f=0,k=b.length;f<k;f++)a=[b[f].lat-d.lat,b[f].lng-d.lng],e.push([c.lat+a[0],c.lng+a[1]]);this._shape.setLatLngs(e);this._repositionCornerMarkers();this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(c){this._shape.setBounds(L.latLngBounds(c,this._oppositeCorner));c=this._shape.getBounds();this._moveMarker.setLatLng(c.getCenter());this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var c=this._shape.getBounds(),b=c.getNorthWest(),d=c.getNorthEast(),a=c.getSouthEast(),c=c.getSouthWest();return[b,d,a,c]},_toggleCornerMarkers:function(c){for(var b=0,d=this._resizeMarkers.length;b<d;b++)this._resizeMarkers[b].setOpacity(c)},_repositionCornerMarkers:function(){for(var c=this._getCorners(),b=0,d=this._resizeMarkers.length;b<d;b++)this._resizeMarkers[b].setLatLng(c[b])}});L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});L.Edit=L.Edit||{};L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var c=this._shape.getLatLng();this._moveMarker=this._createMarker(c,this.options.moveIcon)},_createResizeMarker:function(){var c=this._shape.getLatLng(),c=this._getResizeMarkerPoint(c);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(c,this.options.resizeIcon))},_getResizeMarkerPoint:function(c){var b=this._shape._radius*Math.cos(Math.PI/4);c=this._map.project(c);return this._map.unproject([c.x+b,c.y-b])},_move:function(c){var b=this._getResizeMarkerPoint(c);this._resizeMarkers[0].setLatLng(b);this._shape.setLatLng(c);this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(c){c=this._moveMarker.getLatLng().distanceTo(c);this._shape.setRadius(c);this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}});L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});L.Map.mergeOptions({touchExtend:!0});L.Map.TouchExtend=L.Handler.extend({initialize:function(c){this._map=c;this._container=c._container;this._pane=c._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this);L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this);L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this);this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart);L.DomEvent.off(this._container,"touchend",this._onTouchEnd);L.DomEvent.off(this._container,"touchmove",this._onTouchMove);this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(c,b){var d;if("undefined"!==typeof c.touches){if(!c.touches.length)return;d=c.touches[0]}else if("touch"===c.pointerType){if(d=c,!this._filterClick(c))return}else return;var a=this._map.mouseEventToContainerPoint(d),e=this._map.mouseEventToLayerPoint(d),f=this._map.layerPointToLatLng(e);this._map.fire(b,{latlng:f,layerPoint:e,containerPoint:a,pageX:d.pageX,pageY:d.pageY,originalEvent:c})},_filterClick:function(c){var b=c.timeStamp||c.originalEvent.timeStamp,d=L.DomEvent._lastClick&&b-L.DomEvent._lastClick;if(d&&100<d&&500>d||c.target._simulatedClick&&!c._simulated)return L.DomEvent.stop(c),!1;L.DomEvent._lastClick=b;return!0},_onTouchStart:function(c){this._map._loaded&&this._touchEvent(c,"touchstart")},_onTouchEnd:function(c){this._map._loaded&&this._touchEvent(c,"touchend")},_onTouchCancel:function(c){if(this._map._loaded){var b="touchcancel";this._detectIE()&&(b="pointercancel");this._touchEvent(c,b)}},_onTouchLeave:function(c){this._map._loaded&&this._touchEvent(c,"touchleave")},_onTouchMove:function(c){this._map._loaded&&this._touchEvent(c,"touchmove")},_detectIE:function(){var c=f.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");return 0<b?parseInt(c.substring(b+5,c.indexOf(".",b)),10):!1}});L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend);L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var c=this._icon,b="dblclick mousedown mouseover mouseout contextmenu touchstart touchend touchmove".split(" ");this._detectIE?b.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):b.concat(["touchcancel"]);L.DomUtil.addClass(c,"leaflet-clickable");L.DomEvent.on(c,"click",this._onMouseClick,this);L.DomEvent.on(c,"keypress",this._onKeyPress,this);for(var d=0;d<b.length;d++)L.DomEvent.on(c,b[d],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var c=f.navigator.userAgent,b=c.indexOf("MSIE ");if(0<b)return parseInt(c.substring(b+5,c.indexOf(".",b)),10);if(0<c.indexOf("Trident/"))return b=c.indexOf("rv:"),parseInt(c.substring(b+3,c.indexOf(".",b)),10);b=c.indexOf("Edge/");return 0<b?parseInt(c.substring(b+5,c.indexOf(".",b)),10):!1}});L.LatLngUtil={cloneLatLngs:function(c){for(var b=[],d=0,a=c.length;d<a;d++)Array.isArray(c[d])?b.push(L.LatLngUtil.cloneLatLngs(c[d])):b.push(this.cloneLatLng(c[d]));return b},cloneLatLng:function(c){return L.latLng(c.lat,c.lng)}};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(c){var b=c.length,d=0,a=Math.PI/180,e,f;if(2<b){for(var k=0;k<b;k++)e=c[k],f=c[(k+1)%b],d+=(f.lng-e.lng)*a*(2+Math.sin(e.lat*a)+Math.sin(f.lat*a));d=40680631590769*d/2}return Math.abs(d)},readableArea:function(c,b){var d;b?d=1E4<=c?(1E-4*c).toFixed(2)+" ha":c.toFixed(2)+" m\x26sup2;":(c/=.836127,d=3097600<=c?(c/3097600).toFixed(2)+" mi\x26sup2;":4840<=c?(c/4840).toFixed(2)+" acres":Math.ceil(c)+" yd\x26sup2;");return d},readableDistance:function(c,b,d,a){switch("string"==typeof b?b:d?"feet":a?"nauticalMile":b?"metric":"yards"){case "metric":c=1E3<c?(c/1E3).toFixed(2)+" km":Math.ceil(c)+" m";break;case "feet":c=Math.ceil(3.28083*c)+" ft";break;case "nauticalMile":c=(.53996*c/1E3).toFixed(2)+" nm";break;default:c*=1.09361,c=1760<c?(c/1760).toFixed(2)+" miles":Math.ceil(c)+" yd"}return c}});L.Util.extend(L.LineUtil,{segmentsIntersect:function(c,b,d,a){return this._checkCounterclockwise(c,d,a)!==this._checkCounterclockwise(b,d,a)&&this._checkCounterclockwise(c,b,d)!==this._checkCounterclockwise(c,b,a)},_checkCounterclockwise:function(c,b,d){return(d.y-c.y)*(b.x-c.x)>(b.y-c.y)*(d.x-c.x)}});L.Polyline.include({intersects:function(){var c=this._getProjectedPoints(),b=c?c.length:0,d,a;if(this._tooFewPointsForIntersection())return!1;for(--b;3<=b;b--)if(d=c[b-1],a=c[b],this._lineSegmentsIntersectsRange(d,a,b-2))return!0;return!1},newLatLngIntersects:function(c,b){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(c),b):!1},newPointIntersects:function(c,b){var d=this._getProjectedPoints(),a=d?d.length:0,d=d?d[a-1]:null,a=a-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(d,c,a,b?1:0)},_tooFewPointsForIntersection:function(c){var b=this._getProjectedPoints(),d=b?b.length:0;return!b||3>=d+(c||0)},_lineSegmentsIntersectsRange:function(c,b,d,a){var e=this._getProjectedPoints(),f;a=a||0;for(var k=d;k>a;k--)if(d=e[k-1],f=e[k],L.LineUtil.segmentsIntersect(c,b,d,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var c=[],b=this._defaultShape(),d=0;d<b.length;d++)c.push(this._map.latLngToLayerPoint(b[d]));return c}});L.Polygon.include({intersects:function(){var c=this._getProjectedPoints(),b;if(this._tooFewPointsForIntersection())return!1;if(L.Polyline.prototype.intersects.call(this))return!0;b=c.length;return this._lineSegmentsIntersectsRange(c[b-1],c[0],b-2,1)}});L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(c){if("0.7">L.version)throw Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,c);this._toolbars={};L.DrawToolbar&&this.options.draw&&(c=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=c,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.EditToolbar&&this.options.edit&&(c=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=c,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this));L.toolbar=this},onAdd:function(c){var b=L.DomUtil.create("div","leaflet-draw"),d=!1,a,e;for(e in this._toolbars)this._toolbars.hasOwnProperty(e)&&(a=this._toolbars[e].addToolbar(c))&&(d||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),d=!0),b.appendChild(a));return b},onRemove:function(){for(var c in this._toolbars)this._toolbars.hasOwnProperty(c)&&this._toolbars[c].removeToolbar()},setDrawingOptions:function(c){for(var b in this._toolbars)this._toolbars[b]instanceof L.DrawToolbar&&this._toolbars[b].setOptions(c)},_toolbarEnabled:function(c){c=c.target;for(var b in this._toolbars)this._toolbars[b]!==c&&this._toolbars[b].disable()}});L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))});L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(c){L.setOptions(this,c);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(c){var b=L.DomUtil.create("div","leaflet-draw-section"),d=0,a=this._toolbarClass||"",e=this.getModeHandlers(c);this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar");this._map=c;for(c=0;c<e.length;c++)e[c].enabled&&this._initModeHandler(e[c].handler,this._toolbarContainer,d++,a,e[c].title);if(d)return this._lastButtonIndex=--d,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),b.appendChild(this._toolbarContainer),b.appendChild(this._actionsContainer),b},removeToolbar:function(){for(var c in this._modes)this._modes.hasOwnProperty(c)&&(this._disposeButton(this._modes[c].button,this._modes[c].handler.enable,this._modes[c].handler),this._modes[c].handler.disable(),this._modes[c].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};c=0;for(var b=this._actionButtons.length;c<b;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback,this);this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(c,b,d,a,e){var f=c.type;this._modes[f]={};this._modes[f].handler=c;this._modes[f].button=this._createButton({type:f,title:e,className:a+"-"+f,container:b,callback:this._modes[f].handler.enable,context:this._modes[f].handler});this._modes[f].buttonIndex=d;this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(c){var b=L.DomUtil.create("a",c.className||"",c.container),d=L.DomUtil.create("span","sr-only",c.container);b.href="#";b.appendChild(d);c.title&&(b.title=c.title,d.innerHTML=c.title);c.text&&(b.innerHTML=c.text,d.innerHTML=c.text);L.DomEvent.on(b,"click",L.DomEvent.stopPropagation).on(b,"mousedown",L.DomEvent.stopPropagation).on(b,"dblclick",L.DomEvent.stopPropagation).on(b,"touchstart",L.DomEvent.stopPropagation).on(b,"click",L.DomEvent.preventDefault).on(b,"click",c.callback,c.context);return b},_disposeButton:function(c,b){L.DomEvent.off(c,"click",L.DomEvent.stopPropagation).off(c,"mousedown",L.DomEvent.stopPropagation).off(c,"dblclick",L.DomEvent.stopPropagation).off(c,"touchstart",L.DomEvent.stopPropagation).off(c,"click",L.DomEvent.preventDefault).off(c,"click",b)},_handlerActivated:function(c){this.disable();this._activeMode=this._modes[c.handler];L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._showActionsToolbar();this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled");this._activeMode=null;this.fire("disable")},_createActions:function(c){var b=this._actionsContainer;c=this.getActions(c);var d=c.length,a,e;e=0;for(a=this._actionButtons.length;e<a;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback);for(this._actionButtons=[];b.firstChild;)b.removeChild(b.firstChild);for(e=0;e<d;e++)"enabled"in c[e]&&!c[e].enabled||(a=L.DomUtil.create("li","",b),a=this._createButton({title:c[e].title,text:c[e].text,container:a,callback:c[e].callback,context:c[e].context}),this._actionButtons.push({button:a,callback:c[e].callback}))},_showActionsToolbar:function(){var c=this._activeMode.buttonIndex,b=this._lastButtonIndex,d=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=d+"px";0===c&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top"));c===b&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom"));this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none";L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop");L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top");L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}});L.Draw=L.Draw||{};L.Draw.Tooltip=L.Class.extend({initialize:function(c){this._map=c;this._popupPane=c._panes.popupPane;this._container=c.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null;this._singleLineLabel=!1;this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this);this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(c){if(!this._container)return this;c.subtext=c.subtext||"";0!==c.subtext.length||this._singleLineLabel?0<c.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0);this._container.innerHTML=(0<c.subtext.length?'\x3cspan class\x3d"leaflet-draw-tooltip-subtext"\x3e'+c.subtext+"\x3c/span\x3e\x3cbr /\x3e":"")+"\x3cspan\x3e"+c.text+"\x3c/span\x3e";return this},updatePosition:function(c){c=this._map.latLngToLayerPoint(c);var b=this._container;this._container&&(b.style.visibility="inherit",L.DomUtil.setPosition(b,c));return this},showAsError:function(){this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip");return this},removeError:function(){this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip");return this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}});L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{textbox:{},polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(c){for(var b in this.options)this.options.hasOwnProperty(b)&&c[b]&&(c[b]=L.extend({},this.options[b],c[b]));this._toolbarClass="leaflet-draw-draw";L.Toolbar.prototype.initialize.call(this,c)},getModeHandlers:function(c){return[{enabled:this.options.textbox,handler:new L.Draw.Textbox(c,this.options.textbox),title:"Add a textbox"},{enabled:this.options.polyline,handler:new L.Draw.Polyline(c,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(c,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(c,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(c,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(c,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(c){return[{enabled:c.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:c.completeShape,context:c},{enabled:c.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:c.deleteLastVertex,context:c},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(c){L.setOptions(this,c);for(var b in this._modes)this._modes.hasOwnProperty(b)&&c.hasOwnProperty(b)&&this._modes[b].handler.setOptions(c[b])}});L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(c){c.edit&&("undefined"===typeof c.edit.selectedPathOptions&&(c.edit.selectedPathOptions=this.options.edit.selectedPathOptions),c.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,c.edit.selectedPathOptions));c.remove&&(c.remove=L.extend({},this.options.remove,c.remove));c.poly&&(c.poly=L.extend({},this.options.poly,c.poly));this._toolbarClass="leaflet-draw-edit";L.Toolbar.prototype.initialize.call(this,c);this._selectedFeatureCount=0},getModeHandlers:function(c){var b=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(c,{featureGroup:b,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(c,{featureGroup:b}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(c){c=L.Toolbar.prototype.addToolbar.call(this,c);this._checkDisabled();this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this);return c},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save();this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var c=0!==this.options.featureGroup.getLayers().length,b;this.options.edit&&(b=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(b,"leaflet-disabled"):L.DomUtil.addClass(b,"leaflet-disabled"),b.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled));this.options.remove&&(b=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(b,"leaflet-disabled"):L.DomUtil.addClass(b,"leaflet-disabled"),b.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}});L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(c,b){L.Handler.prototype.initialize.call(this,c);L.setOptions(this,b);this._featureGroup=b.featureGroup;if(!(this._featureGroup instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(c.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),c._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(c){this._revertLayer(c)},this)},save:function(){var c=new L.LayerGroup;this._featureGroup.eachLayer(function(b){b.edited&&(c.addLayer(b),b.edited=!1)});this._map.fire(L.Draw.Event.EDITED,{layers:c})},_backupLayer:function(c){var b=L.Util.stamp(c);this._uneditedLayerProps[b]||(c instanceof L.Polyline||c instanceof L.Polygon||c instanceof L.Rectangle?this._uneditedLayerProps[b]={latlngs:L.LatLngUtil.cloneLatLngs(c.getLatLngs())}:c instanceof L.Circle?this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(c.getLatLng()),radius:c.getRadius()}:c instanceof L.Marker&&(this._uneditedLayerProps[b]={latlng:L.LatLngUtil.cloneLatLng(c.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(c){var b=L.Util.stamp(c);c.edited=!1;this._uneditedLayerProps.hasOwnProperty(b)&&(c instanceof L.Polyline||c instanceof L.Polygon||c instanceof L.Rectangle?c.setLatLngs(this._uneditedLayerProps[b].latlngs):c instanceof L.Circle?(c.setLatLng(this._uneditedLayerProps[b].latlng),c.setRadius(this._uneditedLayerProps[b].radius)):c instanceof L.Marker&&c.setLatLng(this._uneditedLayerProps[b].latlng),c.fire("revert-edited",{layer:c}))},_enableLayerEdit:function(c){c=c.layer||c.target||c;var b;this._backupLayer(c);this.options.poly&&(b=L.Util.extend({},this.options.poly),c.options.poly=b);this.options.selectedPathOptions&&(b=L.Util.extend({},this.options.selectedPathOptions),b.maintainColor&&(b.color=c.options.color,b.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=b);c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(c){c=c.layer||c.target||c;c.edited=!1;c.editing&&c.editing.disable();delete c.options.editing;delete c.options.original;this._selectedPathOptions&&(c instanceof L.Marker?this._toggleMarkerHighlight(c):(c.setStyle(c.options.previousOptions),delete c.options.previousOptions));c instanceof L.Marker?(c.dragging.disable(),c.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.disable()},_onMouseMove:function(c){this._tooltip.updatePosition(c.latlng)},_onMarkerDragEnd:function(c){c=c.target;c.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:c})},_onTouchMove:function(c){var b=this._map.mouseEventToLayerPoint(c.originalEvent.changedTouches[0]),b=this._map.layerPointToLatLng(b);c.target.setLatLng(b)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}});L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(c,b){L.Handler.prototype.initialize.call(this,c);L.Util.setOptions(this,b);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var c=this._map;c&&(c.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(c){this._deletableLayers.addLayer(c);c.fire("revert-deleted",{layer:c})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},_enableLayerDelete:function(c){(c.layer||c.target||c).on("click",this._removeLayer,this)},_disableLayerDelete:function(c){c=c.layer||c.target||c;c.off("click",this._removeLayer,this);this._deletedLayers.removeLayer(c)},_removeLayer:function(c){c=c.layer||c.target||c;this._deletableLayers.removeLayer(c);this._deletedLayers.addLayer(c);c.fire("deleted")},_onMouseMove:function(c){this._tooltip.updatePosition(c.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})})(window,document);L.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5df2\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u70b9"},buttons:{polyline:"\u7ed8\u5236\u591a\u6bb5\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u957f\u65b9\u5f62",circle:"\u7ed8\u5236\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706"},radius:"\u534a\u5f84"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u9762",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u9762"}},polyline:{error:"\x3cstrong\x3e\u9519\u8bef:\x3c/strong\x3e \u4e0d\u53ef\u81ea\u4ea4\u53c9!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706\u77e9\u5f62"}},simpleshape:{tooltip:{end:"\u653e\u5f00\u9f20\u6807\u5b8c\u6210\u7ed8\u5236"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u4fee\u6539",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u4fee\u6539",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42",editDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u7f16\u8f91",remove:"\u5220\u9664\u56fe\u5c42",removeDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u5220\u9664"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u63a7\u5236\u70b9\u6216\u6807\u8bb0\u4ee5\u4fee\u6539\u8981\u7d20",subtext:"\u70b9\u51fb\u53d6\u6d88\u653e\u5f03\u4fee\u6539"}},remove:{tooltip:{text:"\u70b9\u51fb\u4e00\u4e2a\u8981\u7d20\u4ee5\u5220\u9664"}}}}};L.Control.GroupedLayers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,exclusiveGroups:[],groupCheckboxes:!1},initialize:function(f,g,d){var c,b;L.Util.setOptions(this,d);this._layers=[];this._lastZIndex=0;this._handlingClick=!1;this._groupList=[];this._domGroups=[];for(c in f)this._addLayer(f[c],c);for(c in g)for(b in g[c])this._addLayer(g[c][b],b,c,!0)},onAdd:function(f){this._initLayout();this._update();f.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this);return this._container},onRemove:function(f){f.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(f,g){this._addLayer(f,g);this._update();return this},addOverlay:function(f,g,d){this._addLayer(f,g,d,!0);this._update();return this},removeLayer:function(f){f=L.Util.stamp(f);(f=this._getLayer(f))&&delete this.layers[this.layers.indexOf(f)];this._update();return this},_getLayer:function(f){for(var g=0;g<this._layers.length;g++)if(this._layers[g]&&L.stamp(this._layers[g].layer)===f)return this._layers[g]},_initLayout:function(){var f=this._container=L.DomUtil.create("div","leaflet-control-layers");f.setAttribute("aria-haspopup",!0);if(L.Browser.touch)L.DomEvent.on(f,"click",L.DomEvent.stopPropagation);else L.DomEvent.disableClickPropagation(f),L.DomEvent.on(f,"wheel",L.DomEvent.stopPropagation);var g=this._form=L.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){if(!L.Browser.android)L.DomEvent.on(f,"mouseover",this._expand,this).on(f,"mouseout",this._collapse,this);var d=this._layersLink=L.DomUtil.create("a","leaflet-control-layers-toggle",f);d.href="#";d.title="Layers";if(L.Browser.touch)L.DomEvent.on(d,"click",L.DomEvent.stop).on(d,"click",this._expand,this);else L.DomEvent.on(d,"focus",this._expand,this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div","leaflet-control-layers-base",g);this._separator=L.DomUtil.create("div","leaflet-control-layers-separator",g);this._overlaysList=L.DomUtil.create("div","leaflet-control-layers-overlays",g);f.appendChild(g)},_addLayer:function(f,g,d,c){L.Util.stamp(f);g={layer:f,name:g,overlay:c};this._layers.push(g);d=d||"";c=this._indexOf(this._groupList,d);-1===c&&(c=this._groupList.push(d)-1);var b=-1!==this._indexOf(this.options.exclusiveGroups,d);g.group={name:d,id:c,exclusive:b};this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";this._domGroups.length=0;var f=!1,g=!1,d,c;for(d=0;d<this._layers.length;d++)c=this._layers[d],this._addItem(c),g=g||c.overlay,f=f||!c.overlay;this._separator.style.display=g&&f?"":"none"}},_onLayerChange:function(f){var g=this._getLayer(L.Util.stamp(f.layer));g&&(this._handlingClick||this._update(),(f=g.overlay?"layeradd"===f.type?"overlayadd":"overlayremove":"layeradd"===f.type?"baselayerchange":null)&&this._map.fire(f,g))},_createRadioElement:function(f,g){var d='\x3cinput type\x3d"radio" class\x3d"leaflet-control-layers-selector" name\x3d"'+f+'"';g&&(d+=' checked\x3d"checked"');var d=d+"/\x3e",c=document.createElement("div");c.innerHTML=d;return c.firstChild},_addItem:function(f){var g=document.createElement("label"),d,c=this._map.hasLayer(f.layer);f.overlay?f.group.exclusive?(d="leaflet-exclusive-group-layer-"+f.group.id,d=this._createRadioElement(d,c)):(d=document.createElement("input"),d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers",c);d.layerId=L.Util.stamp(f.layer);d.groupID=f.group.id;L.DomEvent.on(d,"click",this._onInputClick,this);c=document.createElement("span");c.innerHTML=" "+f.name;g.appendChild(d);g.appendChild(c);if(f.overlay){d=this._overlaysList;c=this._domGroups[f.group.id];if(!c){c=document.createElement("div");c.className="leaflet-control-layers-group";c.id="leaflet-control-layers-group-"+f.group.id;var b=document.createElement("label");b.className="leaflet-control-layers-group-label";if(""!==f.group.name&&!f.group.exclusive&&this.options.groupCheckboxes){var l=document.createElement("input");l.type="checkbox";l.className="leaflet-control-layers-group-selector";l.groupID=f.group.id;l.legend=this;L.DomEvent.on(l,"click",this._onGroupInputClick,l);b.appendChild(l)}l=document.createElement("span");l.className="leaflet-control-layers-group-name";l.innerHTML=f.group.name;b.appendChild(l);c.appendChild(b);d.appendChild(c);this._domGroups[f.group.id]=c}d=c}else d=this._baseLayersList;d.appendChild(g);return g},_onGroupInputClick:function(){var f,g,d,c=this.legend;c._handlingClick=!0;var b=c._form.getElementsByTagName("input"),l=b.length;for(f=0;f<l;f++)g=b[f],g.groupID===this.groupID&&"leaflet-control-layers-selector"===g.className&&(g.checked=this.checked,d=c._getLayer(g.layerId),g.checked&&!c._map.hasLayer(d.layer)?c._map.addLayer(d.layer):!g.checked&&c._map.hasLayer(d.layer)&&c._map.removeLayer(d.layer));c._handlingClick=!1},_onInputClick:function(){var f,g,d,c=this._form.getElementsByTagName("input"),b=c.length;this._handlingClick=!0;for(f=0;f<b;f++)g=c[f],"leaflet-control-layers-selector"===g.className&&(d=this._getLayer(g.layerId),g.checked&&!this._map.hasLayer(d.layer)?this._map.addLayer(d.layer):!g.checked&&this._map.hasLayer(d.layer)&&this._map.removeLayer(d.layer));this._handlingClick=!1},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");var f=this._map._size.y-4*this._container.offsetTop;f<this._form.clientHeight&&(L.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=f+"px")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")},_indexOf:function(f,g){for(var d=0,c=f.length;d<c;d++)if(f[d]===g)return d;return-1}});L.control.groupedLayers=function(f,g,d){return new L.Control.GroupedLayers(f,g,d)};(function(f,g,d){L.Control.Custom=L.Control.extend({version:"1.0.1",options:{position:"topright",id:"",title:"",classes:"",content:"",style:{},datas:{},events:{}},container:null,onAdd:function(c){this.container=L.DomUtil.create("div");this.container.id=this.options.id;this.container.title=this.options.title;this.container.className=this.options.classes;this.container.innerHTML=this.options.content;for(var b in this.options.style)this.container.style[b]=this.options.style[b];for(var d in this.options.datas)this.container.dataset[d]=this.options.datas[d];L.DomEvent.disableClickPropagation(this.container);L.DomEvent.on(this.container,"contextmenu",function(a){L.DomEvent.stopPropagation(a)});L.DomEvent.disableScrollPropagation(this.container);for(var a in this.options.events)L.DomEvent.on(this.container,a,this.options.events[a],this.container);return this.container},onRemove:function(c){for(var b in this.options.events)L.DomEvent.off(this.container,b,this.options.events[b],this.container)}});L.control.custom=function(c){return new L.Control.Custom(c)}})(window,document);L.Util.request=function(f){f=L.extend({async:!0,method:"GET",data:"",params:{},headers:{},url:window.location.href,success:function(b){console.log(b)},error:function(b){console.log("Ajax request fail");console.log(b)},complete:function(){}},f);var g=new XMLHttpRequest;g.onreadystatechange=function(){4===g.readyState&&(200===g.status?f.success(g.responseText):f.error(g.responseText),f.complete())};var d=f.url+L.Util.getParamString(f.params,f.url);g.open(f.method,d,f.async);for(var c in f.headers)g.setRequestHeader(c,f.headers[c]);g.send(f.data)};L.Control.Sidebar=L.Control.extend({includes:L.Mixin.Events,layerlist:[],options:{position:"left"},initialize:function(f,g){var d,c;L.setOptions(this,g);f?this._sidebar=L.DomUtil.get(f):(this._sidebar=L.DomUtil.create("div","sidebar collapsed"),this._sidebar.innerHTML='\x3cdiv class\x3d"sidebar-tabs"\x3e\x3cul role\x3d"tablist"\x3e\x3cli\x3e\x3ca href\x3d"#home" role\x3d"tab"\x3e\x3ci class\x3d"fa fa-bars"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e \x3c/div\x3e\x3cdiv class\x3d"sidebar-content"\x3e\x3cdiv class\x3d"sidebar-pane" id\x3d"home"\x3e\x3ch1 class\x3d"sidebar-header"\x3e\u8d44\u6e90\u76ee\u5f55 \x3cspan class\x3d"sidebar-close"\x3e\x3ci class\x3d"fa fa-caret-left"\x3e\x3c/i\x3e\x3c/span\x3e\x3c/h1\x3e\x3cdiv class\x3d"rescontainer"\x3e\x3cul id\x3d"restree" class\x3d" restree"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',document.body.appendChild(this._sidebar));g.ak&&this.renderResList(g.ak);L.DomUtil.addClass(this._sidebar,"sidebar-"+this.options.position);L.Browser.touch&&L.DomUtil.addClass(this._sidebar,"leaflet-touch");for(d=this._sidebar.children.length-1;0<=d;d--)c=this._sidebar.children[d],"DIV"==c.tagName&&L.DomUtil.hasClass(c,"sidebar-content")&&(this._container=c);this._tabitems=this._sidebar.querySelectorAll("ul.sidebar-tabs \x3e li, .sidebar-tabs \x3e ul \x3e li");for(d=this._tabitems.length-1;0<=d;d--)this._tabitems[d]._sidebar=this;this._panes=[];this._closeButtons=[];for(d=this._container.children.length-1;0<=d;d--)if(c=this._container.children[d],"DIV"==c.tagName&&L.DomUtil.hasClass(c,"sidebar-pane")){this._panes.push(c);c=c.querySelectorAll(".sidebar-close");for(var b=0,l=c.length;b<l;b++)this._closeButtons.push(c[b])}},renderResList:function(f){var g=this;L.Util.request({url:"http://172.10.0.220:9000/gateway/auth/token?ak\x3d"+f,data:{},success:function(d){d=JSON.parse(d);g.reslist=d.result;1==d.code&&d.result.forEach(function(c){g._addItem(c)})},error:function(d){}})},_addItem:function(f){var g=L.DomUtil.create("label","chbcontainer"),d;d=L.DomUtil.create("input");d.type="checkbox";d.className="leaflet-control-layers-selector";d.id=f.id;g.innerHTML=" "+f.title;L.DomEvent.on(d,"click",this._onInputClick,this);g.appendChild(d);g.appendChild(L.DomUtil.create("span","checkmark"));L.DomUtil.get("restree").appendChild(g);return g},_onInputClick:function(f){var g=f.target.id,d=this.reslist.filter(function(c){return c.id==g});f.target.checked?this.addLayer(d[0]):this.removeLayer(d[0])},addLayer:function(f){var g=L.esri.dynamicMapLayer({url:"http://172.10.0.220:9000"+f.path,opacity:.7,f:"image"}).addTo(this._map);g.id=f.id;this.layerlist.push(g)},removeLayer:function(f){var g=this.layerlist.filter(function(d){return d.id==f.id});this._map.removeLayer(g[0])},addTo:function(f){var g;this._map=f;for(f=this._tabitems.length-1;0<=f;f--){g=this._tabitems[f];var d=g.querySelector("a");if(d.hasAttribute("href")&&"#"==d.getAttribute("href").slice(0,1))L.DomEvent.on(d,"click",L.DomEvent.preventDefault).on(d,"click",this._onClick,g)}for(f=this._closeButtons.length-1;0<=f;f--)g=this._closeButtons[f],L.DomEvent.on(g,"click",this._onCloseClick,this);return this},removeFrom:function(f){console.log("removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon.");this.remove(f)},remove:function(f){var g;this._map=null;for(f=this._tabitems.length-1;0<=f;f--)g=this._tabitems[f],L.DomEvent.off(g.querySelector("a"),"click",this._onClick);for(f=this._closeButtons.length-1;0<=f;f--)g=this._closeButtons[f],L.DomEvent.off(g,"click",this._onCloseClick,this);return this},open:function(f){var g,d;for(g=this._panes.length-1;0<=g;g--)d=this._panes[g],d.id==f?L.DomUtil.addClass(d,"active"):L.DomUtil.hasClass(d,"active")&&L.DomUtil.removeClass(d,"active");for(g=this._tabitems.length-1;0<=g;g--)d=this._tabitems[g],d.querySelector("a").hash=="#"+f?L.DomUtil.addClass(d,"active"):L.DomUtil.hasClass(d,"active")&&L.DomUtil.removeClass(d,"active");this.fire("content",{id:f});L.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._sidebar,"collapsed"));return this},close:function(){for(var f=this._tabitems.length-1;0<=f;f--){var g=this._tabitems[f];L.DomUtil.hasClass(g,"active")&&L.DomUtil.removeClass(g,"active")}L.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._sidebar,"collapsed"));return this},_onClick:function(){L.DomUtil.hasClass(this,"active")?this._sidebar.close():L.DomUtil.hasClass(this,"disabled")||this._sidebar.open(this.querySelector("a").hash.slice(1))},_onCloseClick:function(){this.close()}});L.control.sidebar=function(f,g){return new L.Control.Sidebar(f,g)};L.Map.mergeOptions({sidebarControl:!1});L.Map.addInitHook(function(){this.options.sidebarControl&&this.options.ak&&(this.sidebarControl=new L.Control.Sidebar(null,{ak:this.options.ak}),this.addControl(this.sidebarControl))});L.Control.Coordinates=L.Control.extend({options:{position:"bottomright",decimals:4,decimalSeperator:".",labelTemplateLat:"\u7ecf\u5ea6: {y}",labelTemplateLng:"\u7eac\u5ea6: {x}",labelFormatterLat:void 0,labelFormatterLng:void 0,enableUserInput:!0,useDMS:!1,useLatLngOrder:!1,centerUserCoordinates:!1,markerType:L.marker,markerProps:{}},onAdd:function(f){this._map=f;var g=this._container=L.DomUtil.create("div","leaflet-control-coordinates"),d=this.options;this._labelcontainer=L.DomUtil.create("div","uiElement label",g);this._label=L.DomUtil.create("span","labelFirst",this._labelcontainer);this._inputcontainer=L.DomUtil.create("div","uiElement input uiHidden",g);var c,b;d.useLatLngOrder?(b=L.DomUtil.create("span","",this._inputcontainer),this._inputY=this._createInput("inputY",this._inputcontainer),c=L.DomUtil.create("span","",this._inputcontainer),this._inputX=this._createInput("inputX",this._inputcontainer)):(c=L.DomUtil.create("span","",this._inputcontainer),this._inputX=this._createInput("inputX",this._inputcontainer),b=L.DomUtil.create("span","",this._inputcontainer),this._inputY=this._createInput("inputY",this._inputcontainer));c.innerHTML=d.labelTemplateLng.replace("{x}","");b.innerHTML=d.labelTemplateLat.replace("{y}","");L.DomEvent.on(this._inputX,"keyup",this._handleKeypress,this);L.DomEvent.on(this._inputY,"keyup",this._handleKeypress,this);f.on("mousemove",this._update,this);f.on("dragstart",this.collapse,this);f.whenReady(this._update,this);this._showsCoordinates=!0;d.enableUserInput&&L.DomEvent.addListener(this._container,"click",this._switchUI,this);return g},_createInput:function(f,g){var d=L.DomUtil.create("input",f,g);d.type="text";L.DomEvent.disableClickPropagation(d);return d},_clearMarker:function(){this._map.removeLayer(this._marker)},_handleKeypress:function(f){switch(f.keyCode){case 27:this.collapse();break;case 13:this._handleSubmit();this.collapse();break;default:this._handleSubmit()}},_handleSubmit:function(){var f=L.NumberFormatter.createValidNumber(this._inputX.value,this.options.decimalSeperator),g=L.NumberFormatter.createValidNumber(this._inputY.value,this.options.decimalSeperator);if(void 0!==f&&void 0!==g){var d=this._marker;d||(d=this._marker=this._createNewMarker(),d.on("click",this._clearMarker,this));f=new L.LatLng(g,f);d.setLatLng(f);d.addTo(this._map);this.options.centerUserCoordinates&&this._map.setView(f,this._map.getZoom())}},expand:function(){this._showsCoordinates=!1;this._map.off("mousemove",this._update,this);L.DomEvent.addListener(this._container,"mousemove",L.DomEvent.stop);L.DomEvent.removeListener(this._container,"click",this._switchUI,this);L.DomUtil.addClass(this._labelcontainer,"uiHidden");L.DomUtil.removeClass(this._inputcontainer,"uiHidden")},_createCoordinateLabel:function(f){var g=this.options,d;if(g.customLabelFcn)return g.customLabelFcn(f,g);d=g.labelLng?g.labelFormatterLng(f.lng):L.Util.template(g.labelTemplateLng,{x:this._getNumber(f.lng,g)});f=g.labelFormatterLat?g.labelFormatterLat(f.lat):L.Util.template(g.labelTemplateLat,{y:this._getNumber(f.lat,g)});return g.useLatLngOrder?f+" "+d:d+" "+f},_getNumber:function(f,g){return g.useDMS?L.NumberFormatter.toDMS(f):L.NumberFormatter.round(f,g.decimals,g.decimalSeperator)},collapse:function(){if(!this._showsCoordinates&&(this._map.on("mousemove",this._update,this),this._showsCoordinates=!0,L.DomEvent.addListener(this._container,"click",this._switchUI,this),L.DomEvent.removeListener(this._container,"mousemove",L.DomEvent.stop),L.DomUtil.addClass(this._inputcontainer,"uiHidden"),L.DomUtil.removeClass(this._labelcontainer,"uiHidden"),this._marker)){var f=this._createNewMarker(),g=this._marker.getLatLng();f.setLatLng(g);var d=L.DomUtil.create("div","");L.DomUtil.create("div","",d).innerHTML=this._ordinateLabel(g);g=L.DomUtil.create("a","",d);g.innerHTML="Remove";g.href="#";var c=L.DomEvent.stopPropagation;L.DomEvent.on(g,"click",c).on(g,"mousedown",c).on(g,"dblclick",c).on(g,"click",L.DomEvent.preventDefault).on(g,"click",function(){this._map.removeLayer(f)},this);f.bindPopup(d);f.addTo(this._map);this._map.removeLayer(this._marker);this._marker=null}},_switchUI:function(f){L.DomEvent.stop(f);L.DomEvent.stopPropagation(f);L.DomEvent.preventDefault(f);this._showsCoordinates?this.expand():this.collapse()},onRemove:function(f){f.off("mousemove",this._update,this)},_update:function(f){f=f.latlng;var g=this.options;f&&(this._currentPos=f,this._inputY.value=L.NumberFormatter.round(f.lat,g.decimals,g.decimalSeperator),this._inputX.value=L.NumberFormatter.round(f.lng,g.decimals,g.decimalSeperator),this._label.innerHTML=this._createCoordinateLabel(f))},_createNewMarker:function(){return this.options.markerType(null,this.options.markerProps)}});L.control.coordinates=function(f){return new L.Control.Coordinates(f)};L.Map.mergeOptions({coordinateControl:!1});L.Map.addInitHook(function(){this.options.coordinateControl&&(this.coordinateControl=new L.Control.Coordinates,this.addControl(this.coordinateControl))});L.NumberFormatter={round:function(f,g,d){var c=L.Util.formatNum(f,g)+"";f=c.split(".");if(f[1]){for(g-=f[1].length;0<g;g--)f[1]+="0";c=f.join(d||".")}return c},toDMS:function(f){var g=Math.floor(Math.abs(f)),d=60*(Math.abs(f)-g),c=Math.floor(d),d=Math.round(60*(d-c));60==d&&(c++,d="00");60==c&&(g++,c="00");10>d&&(d="0"+d);10>c&&(c="0"+c);var b="";0>f&&(b="-");return""+b+g+"\x26deg; "+c+"' "+d+"''"},createValidNumber:function(f,g){if(f&&0<f.length){var d=f.split(g||".");try{var c=Number(d.join("."));return isNaN(c)?void 0:c}catch(b){}}}};(function(f){var g;if("function"===typeof define&&define.amd)define(["leaflet"],f);else if("undefined"!==typeof module)g=require("leaflet"),module.exports=f(g);else{if("undefined"===typeof window.L)throw"Leaflet must be loaded first";f(window.L)}})(function(f){f.Control.Search=f.Control.extend({options:{showResultIcons:!1,collapsed:!0,expand:"click",position:"topright",placeholder:"\u8f93\u5165\u5173\u952e\u5b57",errorMessage:"\u65e0\u7ed3\u679c",key:"",limit:5},_callbackId:0,initialize:function(g){f.Util.setOptions(this,g);this.options.geocoder||(this.options.geocoder=new f.Control.Search.Geocoder(this.options))},onAdd:function(g){var d=f.DomUtil.create("div","leaflet-control-ocd-search"),c=f.DomUtil.create("div","leaflet-control-ocd-search-icon",d),b=this._form=f.DomUtil.create("form","leaflet-control-ocd-search-form",d);this._map=g;this._container=d;g=this._input=f.DomUtil.create("input");g.type="text";g.placeholder=this.options.placeholder;f.DomEvent.addListener(g,"keydown",this._keydown,this);this._errorElement=document.createElement("div");this._errorElement.className="leaflet-control-ocd-search-form-no-error";this._errorElement.innerHTML=this.options.errorMessage;this._alts=f.DomUtil.create("ul","leaflet-control-ocd-search-alternatives leaflet-control-ocd-search-alternatives-minimized");b.appendChild(g);b.appendChild(this._errorElement);d.appendChild(this._alts);f.DomEvent.addListener(b,"submit",this._geocode,this);this.options.collapsed?"click"===this.options.expand?f.DomEvent.addListener(c,"click",function(b){0===b.button&&2!==b.detail&&this._toggle()},this):(f.DomEvent.addListener(c,"mouseover",this._expand,this),f.DomEvent.addListener(c,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):this._expand();f.DomEvent.disableClickPropagation(d);return d},_geocodeResult:function(g){f.DomUtil.removeClass(this._container,"leaflet-control-ocd-search-spinner");if(1===g.length)this._geocodeResultSelected(g[0]);else if(0<g.length){this._alts.innerHTML="";this._results=g;f.DomUtil.removeClass(this._alts,"leaflet-control-ocd-search-alternatives-minimized");for(var d=0;d<g.length;d++)this._alts.appendChild(this._createAlt(g[d],d))}else f.DomUtil.addClass(this._errorElement,"leaflet-control-ocd-search-error")},markGeocode:function(g){g.bounds?this._map.fitBounds(g.bounds):this._map.panTo([g.y,g.x]);this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker);this._geocodeMarker=(new f.Marker([g.y,g.x])).bindPopup(g.name).addTo(this._map).openPopup();return this},_geocode:function(g){f.DomEvent.preventDefault(g);f.DomUtil.addClass(this._container,"leaflet-control-ocd-search-spinner");this._clearResults();this.options.geocoder.geocode(this._input.value,this._geocodeResult,this);return!1},_geocodeResultSelected:function(f){this.options.collapsed?this._collapse():this._clearResults();this.markGeocode(f)},_toggle:function(){0<=this._container.className.indexOf("leaflet-control-ocd-search-expanded")?this._collapse():this._expand()},_expand:function(){f.DomUtil.addClass(this._container,"leaflet-control-ocd-search-expanded");this._input.select()},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-ocd-search-expanded","");f.DomUtil.addClass(this._alts,"leaflet-control-ocd-search-alternatives-minimized");f.DomUtil.removeClass(this._errorElement,"leaflet-control-ocd-search-error")},_clearResults:function(){f.DomUtil.addClass(this._alts,"leaflet-control-ocd-search-alternatives-minimized");this._selection=null;f.DomUtil.removeClass(this._errorElement,"leaflet-control-ocd-search-error")},_createAlt:function(g,d){var c=document.createElement("li");c.innerHTML='\x3ca href\x3d"#" title\x3d"'+g.name+'" data-result-index\x3d"'+d+'"\x3e'+(this.options.showResultIcons&&g.icon?'\x3cimg src\x3d"'+g.icon+'"/\x3e':"")+g.name+"\x3c/a\x3e";f.DomEvent.addListener(c,"click",function(){this._geocodeResultSelected(g)},this);return c},_keydown:function(g){var d=this,c=function(b){d._selection&&(f.DomUtil.removeClass(d._selection.firstChild,"leaflet-control-ocd-search-selected"),d._selection=d._selection[0<b?"nextSibling":"previousSibling"]);d._selection||(d._selection=d._alts[0<b?"firstChild":"lastChild"]);d._selection&&f.DomUtil.addClass(d._selection.firstChild,"leaflet-control-ocd-search-selected")};switch(g.keyCode){case 38:c(-1);f.DomEvent.preventDefault(g);break;case 40:c(1);f.DomEvent.preventDefault(g);break;case 13:this._selection&&(c=parseInt(this._selection.firstChild.getAttribute("data-result-index"),10),this._geocodeResultSelected(this._results[c]),this._clearResults(),f.DomEvent.preventDefault(g))}return!0}});f.Control.search=function(g,d){return new f.Control.Search(g,d)};f.Map.mergeOptions({searchControl:!1});f.Map.addInitHook(function(){this.options.searchControl&&(this.searchControl=new f.Control.Search,this.addControl(this.searchControl))});f.Control.Search.callbackId=0;f.Control.Search.jsonp=function(g,d,c,b,l){var a="_ocd_geocoder_"+f.Control.Search.callbackId++;d[l||"callback"]=a;window[a]=f.Util.bind(c,b);b=document.createElement("script");b.type="text/javascript";b.src=g+f.Util.getParamString(d);b.id=a;b.addEventListener("error",function(){c({results:[]})});b.addEventListener("abort",function(){c({results:[]})});document.getElementsByTagName("head")[0].appendChild(b)};f.Control.Search.Geocoder=f.Class.extend({options:{serviceUrl:"http://172.10.0.220:9000/gateway/search/solr_poi_core",geocodingQueryParams:{},reverseQueryParams:{},key:"",limit:5},initialize:function(g){f.Util.setOptions(this,g)},geocode:function(g,d,c){f.Util.request({url:this.options.serviceUrl+"?df\x3dtext\x26indent\x3don\x26start\x3d0\x26rows\x3d10\x26wt\x3djson\x26q\x3d"+g,data:{},success:function(b){d.call(c,JSON.parse(b).response.docs)},error:function(b){}})},reverse:function(f,d,c,b){this.geocode(f,c,b)}});f.Control.search.geocoder=function(g){return new f.Control.Search.Geocoder(g)};return f.Control.Search});L.Icon.Pulse=L.DivIcon.extend({options:{className:"",iconSize:[12,12],color:"red"},initialize:function(f){L.setOptions(this,f);var g="lpi-"+(new Date).getTime()+"-"+Math.round(1E5*Math.random());this.options.className=this.options.className+" leaflet-pulsing-icon "+g;var d="."+g+"{background-color:"+this.options.color+";}",d=d+("."+g+":after{box-shadow: 0 0 6px 2px "+this.options.color+";}"),g=document.createElement("style");g.styleSheet?g.styleSheet.cssText=d:g.appendChild(document.createTextNode(d));document.getElementsByTagName("head")[0].appendChild(g);L.DivIcon.prototype.initialize.call(this,f)}});L.icon.pulse=function(f){return new L.Icon.Pulse(f)};!function(){function f(g){return this instanceof f?(this._canvas=g="string"==typeof g?document.getElementById(g):g,this._ctx=g.getContext("2d"),this._width=g.width,this._height=g.height,this._max=1,void this.clear()):new f(g)}f.prototype={defaultRadius:25,defaultGradient:{"0.4":"blue","0.6":"cyan","0.7":"lime","0.8":"yellow",1:"red"},data:function(f,d){return this._data=f,this},max:function(f){return this._max=f,this},add:function(f){return this._data.push(f),this},clear:function(){return this._data=[],this},radius:function(f,d){d=d||15;var c=this._circle=document.createElement("canvas"),b=c.getContext("2d"),g=this._r=f+d;return c.width=c.height=2*g,b.shadowOffsetX=b.shadowOffsetY=200,b.shadowBlur=d,b.shadowColor="black",b.beginPath(),b.arc(g-200,g-200,f,0,2*Math.PI,!0),b.closePath(),b.fill(),this},gradient:function(f){var d=document.createElement("canvas"),c=d.getContext("2d"),b=c.createLinearGradient(0,0,0,256);d.width=1;d.height=256;for(var g in f)b.addColorStop(g,f[g]);return c.fillStyle=b,c.fillRect(0,0,1,256),this._grad=c.getImageData(0,0,1,256).data,this},draw:function(f){this._circle||this.radius(this.defaultRadius);this._grad||this.gradient(this.defaultGradient);var d=this._ctx;d.clearRect(0,0,this._width,this._height);for(var c,b=0,g=this._data.length;g>b;b++)c=this._data[b],d.globalAlpha=Math.max(c[2]/this._max,f||.05),d.drawImage(this._circle,c[0]-this._r,c[1]-this._r);f=d.getImageData(0,0,this._width,this._height);return this._colorize(f.data,this._grad),d.putImageData(f,0,0),this},_colorize:function(f,d){for(var c,b=3,g=f.length;g>b;b+=4)(c=4*f[b])&&(f[b-3]=d[c],f[b-2]=d[c+1],f[b-1]=d[c+2])}};window.simpleheat=f}();L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(f,g){this._latlngs=f;L.setOptions(this,g)},setLatLngs:function(f){return this._latlngs=f,this.redraw()},addLatLng:function(f){return this._latlngs.push(f),this.redraw()},setOptions:function(f){return L.setOptions(this,f),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(f){this._map=f;this._canvas||this._initCanvas();f._panes.overlayPane.appendChild(this._canvas);f.on("moveend",this._reset,this);f.options.zoomAnimation&&L.Browser.any3d&&f.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(f){f.getPanes().overlayPane.removeChild(this._canvas);f.off("moveend",this._reset,this);f.options.zoomAnimation&&f.off("zoomanim",this._animateZoom,this)},addTo:function(f){return f.addLayer(this),this},_initCanvas:function(){var f=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),g=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);f.style[g]="50% 50%";g=this._map.getSize();f.width=g.x;f.height=g.y;L.DomUtil.addClass(f,"leaflet-zoom-"+(this._map.options.zoomAnimation&&L.Browser.any3d?"animated":"hide"));this._heat=simpleheat(f);this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur);this.options.gradient&&this._heat.gradient(this.options.gradient);this.options.max&&this._heat.max(this.options.max)},_reset:function(){var f=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,f);f=this._map.getSize();this._heat._width!==f.x&&(this._canvas.width=this._heat._width=f.x);this._heat._height!==f.y&&(this._canvas.height=this._heat._height=f.y);this._redraw()},_redraw:function(){var f,g,d,c,b,l,a,e,h=[],k=this._heat._r,n=this._map.getSize();a=new L.Bounds(L.point([-k,-k]),n.add([k,k]));n=void 0===this.options.max?1:this.options.max;f=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom;var m=1/Math.pow(2,Math.max(0,Math.min(f-this._map.getZoom(),12))),t=k/2,k=[];f=this._map._getMapPanePos();var p=f.x%t,r=f.y%t;f=0;for(g=this._latlngs.length;g>f;f++)if(d=this._map.latLngToContainerPoint(this._latlngs[f]),a.contains(d))b=Math.floor((d.x-p)/t)+2,l=Math.floor((d.y-r)/t)+2,e=(void 0!==this._latlngs[f].alt?this._latlngs[f].alt:void 0!==this._latlngs[f][2]?+this._latlngs[f][2]:1)*m,k[l]=k[l]||[],(c=k[l][b])?(c[0]=(c[0]*c[2]+d.x*e)/(c[2]+e),c[1]=(c[1]*c[2]+d.y*e)/(c[2]+e),c[2]+=e):k[l][b]=[d.x,d.y,e];f=0;for(g=k.length;g>f;f++)if(k[f])for(d=0,a=k[f].length;a>d;d++)(c=k[f][d])&&h.push([Math.round(c[0]),Math.round(c[1]),Math.min(c[2],n)]);this._heat.data(h).draw(this.options.minOpacity);this._frame=null},_animateZoom:function(f){var g=this._map.getZoomScale(f.zoom);f=this._map._getCenterOffset(f.center)._multiplyBy(-g).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,f,g):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(f)+" scale("+g+")"}});L.heatLayer=function(f,g){return new L.HeatLayer(f,g)};(function(f){var g={calculateColor:function(a,b){if(0===a.indexOf("#")){var c=a.slice(1),d=parseInt(c.slice(0,2),16),e=parseInt(c.slice(2,4),16),c=parseInt(c.slice(4),16);return"rgba("+d+","+e+","+c+","+b+")"}return/^rgb\(/.test(a)?a.replace(/rgb/,"rgba").replace(")",",")+b+")":a.split(",").splice(0,3).join(",")+b+")"}},d={forEach:function(a,b,c){if("function"===typeof Array.prototype.forEach)a.forEach(b,c);else for(var d=0,e=a.length;d<e;d++)b.apply(c,[a[d],d,a])},map:function(a,b,c){if("function"===typeof Array.prototype.map)return a.map(b,c);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=b.apply(c,[a[e],e,a]);return d}},c=function(){var a=function(a){this.x=a.x;this.y=a.y;this.rotation=a.rotation;this.style=a.style;this.color=a.color;this.size=a.size;this.borderWidth=a.borderWidth;this.borderColor=a.borderColor};a.prototype.draw=function(a){a.save();a.translate(this.x,this.y);a.rotate(this.rotation);a.lineWidth=this.borderWidth||0;a.strokeStyle=this.borderColor||"#000";a.fillStyle=this.color||"#000";a.beginPath();"circle"===this.style?a.arc(0,0,this.size,0,2*Math.PI,!1):"arrow"===this.style&&(a.moveTo(-this.size,-this.size),a.lineTo(this.size,0),a.lineTo(-this.size,this.size),a.lineTo(-this.size/4,0),a.lineTo(-this.size,-this.size));a.closePath();a.stroke();a.fill();a.restore()};return a}(),b=function(){var a=function(a){var b=a.startX,c=a.startY,d=a.endX,e=a.endY,f=Math.sqrt(Math.pow(b-d,2)+Math.pow(c-e,2)),k=1.5*(c-e)+(b+d)/2,h=1.5*(d-b)+(c+e)/2,f=Math.sqrt(Math.pow(f/2,2)+Math.pow(1.5*f,2)),g=Math.atan2(c-h,b-k),l=Math.atan2(e-h,d-k);this.startX=b;this.startY=c;this.endX=d;this.endY=e;this.centerX=k;this.centerY=h;this.startAngle=g;this.endAngle=l;this.startLabel=a&&a.labels&&a.labels[0];this.endLabel=a&&a.labels&&a.labels[1];this.radius=f;this.lineWidth=a.width||1;this.strokeStyle=a.color||"#000";this.label=a.label;this.font=a.font;this.shadowBlur=a.shadowBlur};a.prototype.draw=function(a){a.save();a.lineWidth=this.lineWidth;a.strokeStyle=this.strokeStyle;a.shadowColor=this.strokeStyle;a.shadowBlur=this.shadowBlur||2;a.beginPath();a.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,!1);a.stroke();a.restore();a.save();a.fillStyle=this.strokeStyle;if(this.label){a.font=this.label;if(this.startLabel){var b=this.startX-15,c=this.startY+5;a.fillText(this.startLabel,b,c)}this.endLabel&&(b=this.endX-15,c=this.endY-5,a.fillText(this.endLabel,b,c))}a.restore()};return a}(),l=function(){function a(a){this.x=a.x;this.y=a.y;this.maxRadius=a.radius;this.color=a.color;this.shadowBlur=5;this.lineWidth=a.borderWidth;this.r=0;this.factor=2/a.radius}a.prototype.draw=function(a){this.r+=.5;a.save();a.translate(this.x,this.y);var b=this.color,b=g.calculateColor(b,1-this.r/this.maxRadius);a.strokeStyle=b;a.shadowBlur=this.shadowBlur;a.shadowColor=b;a.lineWidth=this.lineWidth;a.beginPath();a.arc(0,0,this.r,0,2*Math.PI,!1);a.stroke();a.restore();.8>Math.abs(this.maxRadius-this.r)&&(this.r=0)};return a}(),a=function(){var a=function(a){var b=a.startX,d=a.startY,e=a.endX,f=a.endY,k=Math.sqrt(Math.pow(b-e,2)+Math.pow(d-f,2)),h=1.5*(d-f)+(b+e)/2,g=1.5*(e-b)+(d+f)/2,k=Math.sqrt(Math.pow(k/2,2)+Math.pow(1.5*k,2)),b=Math.atan2(d-g,b-h),e=Math.atan2(f-g,e-h);0>b*e&&(0>b&&(b+=2*Math.PI),e+=2*Math.PI);this.tailPointsCount=50;this.centerX=h;this.centerY=g;this.startAngle=b;this.endAngle=e;this.radius=k;this.lineWidth=a.width||1;this.strokeStyle=a.color||"#fff";this.factor=2/this.radius;this.deltaAngle=80/Math.min(this.radius,400)/this.tailPointsCount;this.arcAngle=this.trailAngle=this.startAngle;this.animateBlur=!0;this.marker=new c({x:50,y:80,rotation:50*Math.PI/180,style:"arrow",color:"rgb(255, 255, 255)",size:3,borderWidth:0,borderColor:this.strokeStyle})};a.prototype.drawArc=function(a,b,c,d,e){a.save();a.lineWidth=c;a.strokeStyle=b;a.shadowColor=this.strokeStyle;a.lineCap="round";a.beginPath();a.arc(this.centerX,this.centerY,this.radius,d,e,!1);a.stroke();a.restore()};a.prototype.draw=function(a){var b=this.endAngle,c=this.trailAngle+this.factor,d=this.strokeStyle;this.animateBlur&&(this.arcAngle=c);this.trailAngle=c;d=g.calculateColor(d,.1);this.drawArc(a,d,this.lineWidth,this.startAngle,this.arcAngle);c=this.tailPointsCount;for(d=0;d<c;d++){var e=g.calculateColor(this.strokeStyle,.3-.3/c*d);this.trailAngle-this.deltaAngle*d>this.startAngle&&this.drawArc(a,e,5-5/c*d,this.trailAngle-this.deltaAngle*d,this.trailAngle)}a.save();a.translate(this.centerX,this.centerY);this.marker.x=Math.cos(this.trailAngle)*this.radius;this.marker.y=Math.sin(this.trailAngle)*this.radius;this.marker.rotation=this.trailAngle+Math.PI/2;this.marker.draw(a);a.restore();.5>180*(b-this.trailAngle)/Math.PI&&(this.trailAngle=this.startAngle,this.animateBlur=!1)};return a}(),e=function(){var e=function(a){this.data=a.data;this.store={arcs:[],markers:[],pulses:[],sparks:[]};this.playAnimation=!0;this.started=!1;this.context=a.context;this.style=a.style;this.init()};e.prototype.init=function(){this.updateData(this.data)};e.prototype.add=function(a){};e.prototype.remove=function(){};e.prototype.clear=function(){this.store={arcs:[],markers:[],pulses:[],sparks:[]};this.playAnimation=!0;this.started=!1;f.cancelAnimationFrame(this.requestAnimationId)};e.prototype.updateData=function(e){e&&0!==e.length&&(this.clear(),(this.data=e)&&0<this.data.length&&d.forEach(this.data,function(d){var e=new b({startX:d.from[0],startY:d.from[1],endX:d.to[0],endY:d.to[1],labels:d.labels,label:this.style.arc.label,font:this.style.arc.font,width:this.style.arc.width,color:d.color}),f=new c({x:d.to[0],y:d.to[1],rotation:e.endAngle+Math.PI/2,style:"arrow",color:d.color,size:4,borderWidth:0,borderColor:d.color}),k=new l({x:d.to[0],y:d.to[1],radius:this.style.pulse.radius,color:d.color,borderWidth:this.style.pulse.borderWidth});d=new a({startX:d.from[0],startY:d.from[1],endX:d.to[0],endY:d.to[1],width:15,color:d.color});this.store.arcs.push(e);this.store.markers.push(f);this.store.pulses.push(k);this.store.sparks.push(d)},this))};e.prototype.start=function(a){var b=this;this.started||(function p(){b.requestAnimationId=f.requestAnimationFrame(p,a);if(b.playAnimation){a.width+=1;--a.width;for(var c in b.store)for(var d=b.store[c],e=0,k=d.length;e<k;e++)d[e].draw(b.context)}}(),this.started=!0)};e.prototype.play=function(){this.playAnimation=!0};e.prototype.pause=function(){this.playAnimation=!1};return e}();L.MigrationLayer=L.Class.extend({options:{map:{},data:{},pulseRadius:25,pulseBorderWidth:3,arcWidth:1,arcLabel:!0,arcLabelFont:"15px sans-serif",Marker:{},Spark:{}},_setOptions:function(a,b){a.hasOwnProperty("options")||(a.options=a.options?L.Util.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},initialize:function(a){this._setOptions(this,a);this._map=this.options.map||{};this._data=this.options.data||{};this._style={pulse:{radius:this.options.pulseRadius,borderWidth:this.options.pulseBorderWidth},arc:{width:this.options.arcWidth,label:this.options.arcLabel,font:this.options.arcLabelFont}};this._show=!0;this._init()},_init:function(){var a=L.DomUtil.create("div","leaflet-ODLayer-container");a.style.position="absolute";a.style.width=this._map.getSize().x+"px";a.style.height=this._map.getSize().y+"px";this.container=a;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");a.appendChild(this.canvas);this._map.getPanes().overlayPane.appendChild(a);this.migration||(a=this._convertData(),this.migration=new e({data:a,context:this.context,style:this._style}))},_resize:function(){var a=this._map.getBounds().getNorthWest(),a=this._map.latLngToContainerPoint(a);this.container.style.top=0<a.y?-a.y+"px":"0px";a=f.getComputedStyle(this._map.getContainer());this.canvas.setAttribute("width",parseInt(a.width,10));this.canvas.setAttribute("height",parseInt(a.height,10))},_convertData:function(){var a=this._map.getBounds();if(this._data&&a)return d.map(this._data,function(a){var b=this._map.latLngToContainerPoint(new L.LatLng(a.from[1],a.from[0])),c=this._map.latLngToContainerPoint(new L.LatLng(a.to[1],a.to[0]));return{from:[b.x,b.y],to:[c.x,c.y],labels:a.labels,value:a.value,color:a.color}},this)},_bindMapEvents:function(){var a=this;this._map.on("moveend",function(){a.migration.play();a._draw()});this._map.on("zoomstart ",function(){a.container.style.display="none"});this._map.on("zoomend",function(){a._show&&(a.container.style.display="",a._draw())})},_draw:function(){if(this._map.getBounds()&&this.migration.playAnimation){this._resize();this._transform();var a=this._convertData();this.migration.updateData(a);this.migration.start(this.canvas)}},_transform:function(){var a=this._map.getBounds(),a=this._map.latLngToLayerPoint(a.getNorthWest());L.DomUtil.setPosition(this.container,a)},addTo:function(){this._bindMapEvents();if(this._map.getBounds()&&this.migration.playAnimation){this._resize();this._transform();var a=this._convertData();this.migration.updateData(a);this.migration.start(this.canvas)}},setData:function(a){this._data=a;this._draw()},hide:function(){this.container.style.display="none";this._show=!1},show:function(){this.container.style.display="";this._show=!0},play:function(){this.migration.play()},pause:function(){this.migration.pause()},destroy:function(){this.migration.clear();this.container.parentNode.removeChild(this.container);this._map.clearAllEventListeners();this.mapHandles=[]}});L.migrationLayer=function(a){return new L.MigrationLayer(a)};var h=function(){var a=function(a){this.data=a.data;this.store={pulses:[]};this.playAnimation=!0;this.started=!1;this.context=a.context;this.style=a.style;this.init()};a.prototype.init=function(){this.updateData(this.data)};a.prototype.add=function(a){};a.prototype.remove=function(){};a.prototype.clear=function(){this.store={pulses:[]};this.playAnimation=!0;this.started=!1;f.cancelAnimationFrame(this.requestAnimationId)};a.prototype.updateData=function(a){a&&0!==a.length&&(this.clear(),(this.data=a)&&0<this.data.length&&d.forEach(this.data,function(a){a=new l({x:a.x,y:a.y,radius:this.style.pulse.radius,color:a.color,borderWidth:this.style.pulse.borderWidth});this.store.pulses.push(a)},this))};a.prototype.start=function(a){var b=this;this.started||(function p(){b.requestAnimationId=f.requestAnimationFrame(p,a);if(b.playAnimation){a.width+=1;--a.width;for(var c in b.store)for(var d=b.store[c],e=0,k=d.length;e<k;e++)d[e].draw(b.context)}}(),this.started=!0)};a.prototype.play=function(){this.playAnimation=!0};a.prototype.pause=function(){this.playAnimation=!1};return a}();L.PulseMarkLayer=L.Class.extend({options:{map:{},data:{},pulseRadius:25,pulseBorderWidth:3,Marker:{},Spark:{}},_setOptions:function(a,b){a.hasOwnProperty("options")||(a.options=a.options?L.Util.create(a.options):{});for(var c in b)a.options[c]=b[c];return a.options},initialize:function(a){this._setOptions(this,a);this._map=this.options.map||{};this._data=this.options.data||{};this._style={pulse:{radius:this.options.pulseRadius,borderWidth:this.options.pulseBorderWidth}};this._show=!0;this._init()},_init:function(){var a=L.DomUtil.create("div","leaflet-MMLayer-container");a.style.position="absolute";a.style.width=this._map.getSize().x+"px";a.style.height=this._map.getSize().y+"px";this.container=a;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");a.appendChild(this.canvas);this._map.getPanes().overlayPane.appendChild(a);this.pulsemark||(a=this._convertData(),this.pulsemark=new h({data:a,context:this.context,style:this._style}))},_resize:function(){var a=this._map.getBounds().getNorthWest(),a=this._map.latLngToContainerPoint(a);this.container.style.top=0<a.y?-a.y+"px":"0px";a=f.getComputedStyle(this._map.getContainer());this.canvas.setAttribute("width",parseInt(a.width,10));this.canvas.setAttribute("height",parseInt(a.height,10))},_convertData:function(){var a=this._map.getBounds();if(this._data&&a)return d.map(this._data,function(a){var b=this._map.latLngToContainerPoint(a.latlng),c={};L.extend(c,a);c.x=b.x;c.y=b.y;return c},this)},_bindMapEvents:function(){var a=this;this._map.on("moveend",function(){a.pulsemark.play();a._draw()});this._map.on("zoomstart ",function(){a.container.style.display="none"});this._map.on("zoomend",function(){a._show&&(a.container.style.display="",a._draw())})},_draw:function(){if(this._map.getBounds()&&this.pulsemark.playAnimation){this._resize();this._transform();var a=this._convertData();this.pulsemark.updateData(a);this.pulsemark.start(this.canvas)}},_transform:function(){var a=this._map.getBounds(),a=this._map.latLngToLayerPoint(a.getNorthWest());L.DomUtil.setPosition(this.container,a)},addTo:function(){this._bindMapEvents();if(this._map.getBounds()&&this.pulsemark.playAnimation){this._resize();this._transform();var a=this._convertData();this.pulsemark.updateData(a);this.pulsemark.start(this.canvas)}},setData:function(a){this._data=a;this._draw()},hide:function(){this.container.style.display="none";this._show=!1},show:function(){this.container.style.display="";this._show=!0},play:function(){this.pulsemark.play()},pause:function(){this.pulsemark.pause()},destroy:function(){this.pulsemark.clear();this.container.parentNode.removeChild(this.container);this._map.clearAllEventListeners();this.mapHandles=[]}});L.pulseMarkLayer=function(a){return new L.PulseMarkLayer(a)}})(window);L.GeoWMTSLayer=L.TileLayer.extend({defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"default",tileMatrixSet:"c",format:"tiles"},layerType:"WMTSLayer",initialize:function(f,g){this._url=f instanceof Array?f:[f];var d=L.extend({},this.defaultWmtsParams),c=g.tileSize||this.options.tileSize;d.width=g.detectRetina&&L.Browser.retina?d.height=2*c:d.height=c;for(var b in g)this.options.hasOwnProperty(b)||"matrixIds"==b||(d[b]=g[b]);this.wmtsParams=d;L.setOptions(this,g)},onAdd:function(f){L.TileLayer.prototype.onAdd.call(this,f)},getTileUrl:function(f){var g=this._url[(f.x+f.y)%this._url.length];g||(g=this._url[0]);return g+L.Util.getParamString(this.wmtsParams,g)+"\x26tilematrix\x3d"+f.z+"\x26tilerow\x3d"+f.y+"\x26tilecol\x3d"+f.x},setParams:function(f,g){L.extend(this.wmtsParams,f);g||this.redraw();return this}});L.geowmtslayer=function(f,g){return new L.GeoWMTSLayer(f,g)};L.GeoTDTLayer=L.GeoWMTSLayer.extend({urlArray:[],tdtOptions:{},initialize:function(f,g){this._url=this.urlArray;g=this.tdtOptions;var d=L.extend({},this.defaultWmtsParams),c=g.tileSize||this.options.tileSize;d.width=g.detectRetina&&L.Browser.retina?d.height=2*c:d.height=c;for(var b in g)this.options.hasOwnProperty(b)||"matrixIds"==b||(d[b]=g[b]);this.wmtsParams=d;L.setOptions(this,g)}});L.GeoTDTLayer.Vector=L.GeoTDTLayer.extend({urlArray:["http://2.20.101.190:9001/vec_c/wmts","http://2.20.101.190:9001/vec_c/wmts","http://2.20.101.190:9001/vec_c/wmts","http://2.20.101.190:9001/vec_c/wmts"],tdtOptions:{layer:"vec",style:"default",format:"tiles",tileMatrixSet:"c",tk:"56e2ef8967b3a0dbb746b7a40b7faa94",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTLayer.VectorAnno=L.GeoTDTLayer.extend({urlArray:["http://2.20.101.190:9001/cva_c/wmts","http://2.20.101.190:9001/cva_c/wmts","http://2.20.101.190:9001/cva_c/wmts","http://2.20.101.190:9001/cva_c/wmts"],tdtOptions:{layer:"cva",style:"default",format:"tiles",tileMatrixSet:"c",tk:"56e2ef8967b3a0dbb746b7a40b7faa94",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTLayer.Raster=L.GeoTDTLayer.extend({urlArray:["http://2.20.101.190:9001/img_c/wmts","http://2.20.101.190:9001/img_c/wmts","http://2.20.101.190:9001/img_c/wmts","http://2.20.101.190:9001/img_c/wmts"],tdtOptions:{layer:"img",style:"default",format:"tiles",tileMatrixSet:"c",tk:"56e2ef8967b3a0dbb746b7a40b7faa94",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTLayer.RasterAnno=L.GeoTDTLayer.extend({urlArray:["http://2.20.101.190:9001/cia_c/wmts","http://2.20.101.190:9001/cia_c/wmts","http://2.20.101.190:9001/cia_c/wmts","http://2.20.101.190:9001/cia_c/wmts"],tdtOptions:{layer:"cia",style:"default",format:"tiles",tileMatrixSet:"c",tk:"56e2ef8967b3a0dbb746b7a40b7faa94",attribution:"\u5929\u5730\u56fe"}});L.GeoTDTCRS=L.extend({},L.CRS,{projection:L.Projection.SphericalMercator,transformation:function(){var f=.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(f,.5,-f,.5)}(),code:"EPSG:0",levelDefine:[{level:0,resolution:1.40782880508533,scale:5.916587109E8},{level:1,resolution:.7031250000001188,scale:2.954975930588E8},{level:2,resolution:.3515625000000594,scale:1.477487965294E8},{level:3,resolution:.1757812500000297,scale:7.38743982647E7},{level:4,resolution:.08789062500001485,scale:3.693719913235E7},{level:5,resolution:.043945312500007425,scale:1.8468599566175E7},{level:6,resolution:.021972656250003712,scale:9234299.7830875},{level:7,resolution:.010986328125001856,scale:4617149.89154375},{level:8,resolution:.005493164062500928,scale:2308574.945771875},{level:9,resolution:.002746582031250464,scale:1154287.4728859374},{level:10,resolution:.001373291015625232,scale:577143.7364429687},{level:11,resolution:6.86645507812616E-4,scale:288571.86822148436},{level:12,resolution:3.43322753906308E-4,scale:144285.93411074218},{level:13,resolution:1.71661376953154E-4,scale:72142.96705537109},{level:14,resolution:8.5830688476577E-5,scale:36071.483527685545},{level:15,resolution:4.29153442382885E-5,scale:18035.741763842772},{level:16,resolution:2.145767211914425E-5,scale:9017.870881921386},{level:17,resolution:1.0728836059572125E-5,scale:4508.935440960693},{level:18,resolution:5.3644180297860626E-6,scale:2254.4677204803465},{level:19,resolution:2.6822090148930313E-6,scale:1127.2338602401733},{level:20,resolution:1.3411045074465156E-6,scale:563.6169301200866}],origin:new L.LatLng(90,-180),latLngToPoint:function(f,g){for(var d=this.levelDefine,c=this.origin,b=0;b<d.length;b++)if(d[b].level==g)return new L.Point(Math.floor((f.lng-c.lng)/d[b].resolution),Math.floor((c.lat-f.lat)/d[b].resolution))},pointToLatLng:function(f,g){for(var d=this.levelDefine,c=this.origin,b=0;b<d.length;b++)if(d[b].level==g)return new L.LatLng(c.lat-f.y*d[b].resolution,f.x*d[b].resolution+c.lng)},project:function(f){return new L.Point(f.lng,f.lat)},scale:function(f){for(var g=this.levelDefine,d=this.origin,c,d=Math.max(Math.abs(d.lat),Math.abs(d.lng)),b=0;b<g.length;b++)if(g[b].level==f){c=2*d/g[b].resolution;break}return c},_scaleByOrigin:function(f,g){for(var d,c=this.levelDefine,b=0;b<c.length;b++)c[b].level==f&&(d=2*Math.abs(g)/c[b].resolution);return d},getSize:function(f){var g=this.origin,d=this._scaleByOrigin(f,g.lat);f=this._scaleByOrigin(f,g.lng);return L.point(f,d)}});
!function(f){function g(c){if(d[c])return d[c].exports;var b=d[c]={exports:{},id:c,loaded:!1};return f[c].call(b.exports,b,b.exports,g),b.loaded=!0,b.exports}var d={};return g.m=f,g.c=d,g.p="",g(0)}([function(f,g,d){var c=d(111),b=d(51),l=d(85);c.choropleth=f.exports=function(a,d){d=d||{};l.defaults(d,{valueProperty:"value",scale:["white","red"],steps:5,mode:"q"});var e=d.style,f=a.features.map("function"==typeof d.valueProperty?d.valueProperty:function(a){return a.properties[d.valueProperty]}),g=b.limits(f,d.mode,d.steps-1),m=d.colors&&d.colors.length===g.length?d.colors:b.scale(d.scale).colors(g.length);return c.geoJson(a,l.extend(d,{limits:g,colors:m,style:function(a){var b,c={};if(b="function"==typeof d.valueProperty?d.valueProperty(a):a.properties[d.valueProperty],!isNaN(b))for(var f=0;f<g.length;f++)if(b<=g[f]){c.fillColor=m[f];break}switch(typeof e){case "function":return l.defaults(c,e(a));case "object":return l.defaults(c,e);default:return c}}}))}},function(f,g){f.exports=function(d){var c=typeof d;return!!d&&("object"==c||"function"==c)}},function(f,g,d){g=d(17);var c=d(9),b=d(4),l=Object.prototype.toString;d=g(Array,"isArray")||function(a){return b(a)&&c(a.length)&&"[object Array]"==l.call(a)};f.exports=d},function(f,g,d){g=d(17);var c=d(8),b=d(1),l=d(81),a=g(Object,"keys");f.exports=a?function(d){var e=null==d?void 0:d.constructor;return"function"==typeof e&&e.prototype===d||"function"!=typeof d&&c(d)?l(d):b(d)?a(d):[]}:l},function(f,g){f.exports=function(d){return!!d&&"object"==typeof d}},function(f,g,d){var c=d(1);f.exports=function(b){return c(b)?b:Object(b)}},function(f,g,d){var c=d(11),b=d(2),l=d(13),a=d(9),e=d(1),h=Object.prototype.hasOwnProperty;f.exports=function(d){if(null==d)return[];e(d)||(d=Object(d));for(var f=d.length,f=f&&a(f)&&(b(d)||c(d))&&f||0,g=d.constructor,k=-1,g="function"==typeof g&&g.prototype===d,p=Array(f),r=0<f;++k<f;)p[k]=k+"";for(var q in d)r&&l(q,f)||"constructor"==q&&(g||!h.call(d,q))||p.push(q);return p}},function(f,g,d){var c=d(50);f.exports=function(b,d,a){if("function"!=typeof b)return c;if(void 0===d)return b;switch(a){case 1:return function(a){return b.call(d,a)};case 3:return function(a,c,f){return b.call(d,a,c,f)};case 4:return function(a,c,f,g){return b.call(d,a,c,f,g)};case 5:return function(a,c,f,g,l){return b.call(d,a,c,f,g,l)}}return function(){return b.apply(d,arguments)}}},function(f,g,d){var c=d(77),b=d(9);f.exports=function(d){return null!=d&&b(c(d))}},function(f,g){f.exports=function(d){return"number"==typeof d&&-1<d&&0==d%1&&9007199254740991>=d}},function(f,g,d){var c=d(70),b=d(2),l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,a=/\\(\\)?/g;f.exports=function(d){if(b(d))return d;var e=[];return c(d).replace(l,function(b,c,d,f){e.push(d?f.replace(a,"$1"):c||b)}),e}},function(f,g,d){var c=d(8),b=d(4);g=Object.prototype;var l=g.hasOwnProperty,a=g.propertyIsEnumerable;f.exports=function(d){return b(d)&&c(d)&&l.call(d,"callee")&&!a.call(d,"callee")}},function(f,g,d){var c=d(5);f.exports=function(b,d,a){if(null!=b){void 0!==a&&a in c(b)&&(d=[a]);a=0;for(var e=d.length;null!=b&&a<e;)b=b[d[a++]];return a&&a==e?b:void 0}}},function(f,g){var d=/^\d+$/;f.exports=function(c,b){return c="number"==typeof c||d.test(c)?+c:-1,b=null==b?9007199254740991:b,-1<c&&0==c%1&&c<b}},function(f,g,d){var c=d(2),b=d(5),l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,a=/^\w*$/;f.exports=function(d,f){var e=typeof d;return"string"==e&&a.test(d)||"number"==e?!0:c(d)?!1:!l.test(d)||null!=f&&d in b(f)}},function(f,g){var d=Math.max;f.exports=function(c,b){if("function"!=typeof c)throw new TypeError("Expected a function");return b=d(void 0===b?c.length-1:+b||0,0),function(){for(var f=arguments,a=-1,e=d(f.length-b,0),g=Array(e);++a<e;)g[a]=f[b+a];switch(b){case 0:return c.call(this,g);case 1:return c.call(this,f[0],g);case 2:return c.call(this,f[0],f[1],g)}e=Array(b+1);for(a=-1;++a<b;)e[a]=f[a];return e[b]=g,c.apply(this,e)}}},function(f,g,d){var c=d(22),b=d(3);f.exports=function(d,a){return c(d,a,b)}},function(f,g,d){var c=d(82);f.exports=function(b,d){var a=null==b?void 0:b[d];return c(a)?a:void 0}},function(f,g,d){var c=d(1),b=Object.prototype.toString;f.exports=function(d){return c(d)&&"[object Function]"==b.call(d)}},function(f,g,d){var c=d(9),b=d(4),l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0;l["[object Arguments]"]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l["[object Map]"]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var a=Object.prototype.toString;f.exports=function(d){return b(d)&&c(d.length)&&!!l[a.call(d)]}},function(f,g){f.exports=function(d){var c=d?d.length:0;return c?d[c-1]:void 0}},function(f,g,d){var c=d(65),b=d(66),l=d(7),a=d(50),e=d(109);f.exports=function(d,f,g){var h=typeof d;return"function"==h?void 0===f?d:l(d,f,g):null==d?a:"object"==h?c(d):void 0===f?e(d):b(d,f)}},function(f,g,d){g=d(39)();f.exports=g},function(f,g){f.exports=function(d,c,b){var f=-1,a=d.length;c=null==c?0:+c||0;0>c&&(c=-c>a?0:a+c);b=void 0===b||b>a?a:+b||0;0>b&&(b+=a);a=c>b?0:b-c>>>0;c>>>=0;for(b=Array(a);++f<a;)b[f]=d[f+c];return b}},function(f,g,d){var c=d(8),b=d(13),l=d(1);f.exports=function(a,d,f){if(!l(f))return!1;var e=typeof d;return("number"==e?c(f)&&b(d,f.length):"string"==e&&d in f)?(d=f[d],a===a?a===d:d!==d):!1}},function(f,g,d){var c=d(58),b=d(28);g=d(38)(function(d,a,e){return e?c(d,a,e):b(d,a)});f.exports=g},function(f,g,d){g=d(67);d=d(38)(g);f.exports=d},function(f,g){f.exports=function(d,c){for(var b=-1,f=d.length;++b<f&&!1!==c(d[b],b,d););return d}},function(f,g,d){var c=d(29),b=d(3);f.exports=function(d,a){return null==a?d:c(a,b(a),d)}},function(f,g){f.exports=function(d,c,b){b||(b={});for(var f=-1,a=c.length;++f<a;){var e=c[f];b[e]=d[e]}return b}},function(f,g,d){var c=d(1);g=function(){function b(){}return function(d){if(c(d)){b.prototype=d;var a=new b;b.prototype=void 0}return a||{}}}();f.exports=g},function(f,g,d){function c(d,f,g,t){t||(t=[]);for(var k=-1,n=d.length;++k<n;){var m=d[k];h(m)&&e(m)&&(g||a(m)||l(m))?f?c(m,f,g,t):b(t,m):g||(t[t.length]=m)}return t}var b=d(55),l=d(11),a=d(2),e=d(8),h=d(4);f.exports=c},function(f,g,d){var c=d(22),b=d(6);f.exports=function(d,a){return c(d,a,b)}},function(f,g,d){var c=d(34),b=d(3);f.exports=function(d,a){return c(d,a,b)}},function(f,g,d){g=d(39)(!0);f.exports=g},function(f,g,d){function c(d,f,g,n,m,t){return d===f||(null==d||null==f||!l(d)&&!a(f)?d!==d&&f!==f:b(d,f,c,g,n,m,t))}var b=d(63),l=d(1),a=d(4);f.exports=c},function(f,g){f.exports=function(d){return function(c){return null==c?void 0:c[d]}}},function(f,g){f.exports=function(d,c){for(var b=-1,f=c.length,a=Array(f);++b<f;)a[b]=d[c[b]];return a}},function(f,g,d){var c=d(7),b=d(24),l=d(15);f.exports=function(a){return l(function(d,f){var e=-1,g=null==d?0:f.length,h=2<g?f[g-2]:void 0,l=2<g?f[2]:void 0,p=1<g?f[g-1]:void 0;"function"==typeof h?(h=c(h,p,5),g-=2):(h="function"==typeof p?p:void 0,g-=h?1:0);for(l&&b(f[0],f[1],l)&&(h=3>g?void 0:h,g=1);++e<g;)(l=f[e])&&a(d,l,h);return d})}},function(f,g,d){var c=d(5);f.exports=function(b){return function(d,a,e){var f=c(d);e=e(d);for(var g=e.length,l=b?g:-1;b?l--:++l<g;){var m=e[l];if(!1===a(f[m],m,f))break}return d}}},function(f,g,d){var c=d(15);f.exports=function(b,d){return c(function(a){var c=a[0];return null==c?c:(a.push(d),b.apply(void 0,a))})}},function(f,g,d){var c=d(21),b=d(60);f.exports=function(d){return function(a,e,f){return e=c(e,f,3),b(a,e,d,!0)}}},function(f,g,d){var c=d(7),b=d(6);f.exports=function(d){return function(a,e,f){return"function"==typeof e&&void 0===f||(e=c(e,f,3)),d(a,e,b)}}},function(f,g,d){var c=d(7);f.exports=function(b){return function(d,a,e){return"function"==typeof a&&void 0===e||(a=c(a,e,3)),b(d,a)}}},function(f,g,d){var c=d(21),b=d(16);f.exports=function(d){return function(a,e,f){var g={};return e=c(e,f,3),b(a,function(a,b,c){c=e(a,b,c);b=d?c:b;a=d?a:c;g[b]=a}),g}}},function(f,g,d){var c=d(1);f.exports=function(b){return b===b&&!c(b)}},function(f,g,d){var c=d(5);f.exports=function(b,d){b=c(b);for(var a=-1,e=d.length,f={};++a<e;){var g=d[a];g in b&&(f[g]=b[g])}return f}},function(f,g,d){var c=d(32);f.exports=function(b,d){var a={};return c(b,function(b,c,f){d(b,c,f)&&(a[c]=b)}),a}},function(f,g,d){var c=d(61),b=d(6);f.exports=function(d){return c(d,b(d))}},function(f,g,d){var c=d(3),b=d(5);f.exports=function(d){d=b(d);for(var a=-1,e=c(d),f=e.length,g=Array(f);++a<f;){var l=e[a];g[a]=[l,d[l]]}return g}},function(f,g){f.exports=function(d){return d}},function(f,g,d){var c,b;(function(d){(function(){var a,e,f,k,l,m,t,p,r,q,x,A,F,D,E,H,U,u,I,N,G,z,v,O,V,ba,Y,T,M,C,Z,aa,Q,ua,la,da,ta,W,w,R,ia,Ca,qa,ha,Da,sa,Aa,P,na,ra,Ba,Ea,va,ea,ma,X,S,fa,Fa,J,K,oa,wa,Ga,ja=[].slice;J=function(){var a,b,c,d,e;a={};e="Boolean Number String Function Array Date RegExp Undefined Null".split(" ");d=0;for(b=e.length;d<b;d++)c=e[d],a["[object "+c+"]"]=c.toLowerCase();return function(b){var c;return c=Object.prototype.toString.call(b),a[c]||"object"}}();la=function(a,b,c){return null==b&&(b=0),null==c&&(c=1),a<b&&(a=b),a>c&&(a=c),a};K=function(a){return 3<=a.length?[].slice.call(a):a[0]};I=function(a){var b,c;a._clipped=!1;a._unclipped=a.slice(0);for(b=c=0;3>c;b=++c)3>b?((0>a[b]||255<a[b])&&(a._clipped=!0),0>a[b]&&(a[b]=0),255<a[b]&&(a[b]=255)):3===b&&(0>a[b]&&(a[b]=0),1<a[b]&&(a[b]=1));return a._clipped||delete a._unclipped,a};k=Math.PI;X=Math.round;G=Math.cos;O=Math.floor;R=Math.pow;da=Math.log;S=Math.sin;fa=Math.sqrt;F=Math.atan2;w=Math.max;A=Math.abs;t=2*k;l=k/3;e=k/180;m=180/k;u=function(){return arguments[0]instanceof a?arguments[0]:function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,arguments,function(){})};x=[];"undefined"!=typeof d&&null!==d&&null!=d.exports&&(d.exports=u);c=[];b=function(){return u}.apply(g,c);!(void 0!==b&&(d.exports=b));u.version="1.3.4";q={};p=[];r=!1;a=function(){function a(){var a,b,c,d,e,f;b=[];f=0;for(d=arguments.length;f<d;f++)a=arguments[f],null!=a&&b.push(a);if(e=b[b.length-1],null!=q[e])this._rgb=I(q[e](K(b.slice(0,-1))));else{r||(p=p.sort(function(a,b){return b.p-a.p}),r=!0);d=0;for(a=p.length;d<a&&(c=p[d],!(e=c.test.apply(c,b)));d++);e&&(this._rgb=I(q[e].apply(q,b)))}null==this._rgb&&console.warn("unknown format: "+b);null==this._rgb&&(this._rgb=[0,0,0]);3===this._rgb.length&&this._rgb.push(1)}return a.prototype.toString=function(){return this.hex()},a.prototype.clone=function(){return u(me._rgb)},a}();u._input=q;u.brewer=U={OrRd:"#fff7ec #fee8c8 #fdd49e #fdbb84 #fc8d59 #ef6548 #d7301f #b30000 #7f0000".split(" "),PuBu:"#fff7fb #ece7f2 #d0d1e6 #a6bddb #74a9cf #3690c0 #0570b0 #045a8d #023858".split(" "),BuPu:"#f7fcfd #e0ecf4 #bfd3e6 #9ebcda #8c96c6 #8c6bb1 #88419d #810f7c #4d004b".split(" "),Oranges:"#fff5eb #fee6ce #fdd0a2 #fdae6b #fd8d3c #f16913 #d94801 #a63603 #7f2704".split(" "),BuGn:"#f7fcfd #e5f5f9 #ccece6 #99d8c9 #66c2a4 #41ae76 #238b45 #006d2c #00441b".split(" "),YlOrBr:"#ffffe5 #fff7bc #fee391 #fec44f #fe9929 #ec7014 #cc4c02 #993404 #662506".split(" "),YlGn:"#ffffe5 #f7fcb9 #d9f0a3 #addd8e #78c679 #41ab5d #238443 #006837 #004529".split(" "),Reds:"#fff5f0 #fee0d2 #fcbba1 #fc9272 #fb6a4a #ef3b2c #cb181d #a50f15 #67000d".split(" "),RdPu:"#fff7f3 #fde0dd #fcc5c0 #fa9fb5 #f768a1 #dd3497 #ae017e #7a0177 #49006a".split(" "),Greens:"#f7fcf5 #e5f5e0 #c7e9c0 #a1d99b #74c476 #41ab5d #238b45 #006d2c #00441b".split(" "),YlGnBu:"#ffffd9 #edf8b1 #c7e9b4 #7fcdbb #41b6c4 #1d91c0 #225ea8 #253494 #081d58".split(" "),Purples:"#fcfbfd #efedf5 #dadaeb #bcbddc #9e9ac8 #807dba #6a51a3 #54278f #3f007d".split(" "),GnBu:"#f7fcf0 #e0f3db #ccebc5 #a8ddb5 #7bccc4 #4eb3d3 #2b8cbe #0868ac #084081".split(" "),Greys:"#ffffff #f0f0f0 #d9d9d9 #bdbdbd #969696 #737373 #525252 #252525 #000000".split(" "),YlOrRd:"#ffffcc #ffeda0 #fed976 #feb24c #fd8d3c #fc4e2a #e31a1c #bd0026 #800026".split(" "),PuRd:"#f7f4f9 #e7e1ef #d4b9da #c994c7 #df65b0 #e7298a #ce1256 #980043 #67001f".split(" "),Blues:"#f7fbff #deebf7 #c6dbef #9ecae1 #6baed6 #4292c6 #2171b5 #08519c #08306b".split(" "),PuBuGn:"#fff7fb #ece2f0 #d0d1e6 #a6bddb #67a9cf #3690c0 #02818a #016c59 #014636".split(" "),Viridis:"#440154 #482777 #3f4a8a #31678e #26838f #1f9d8a #6cce5a #b6de2b #fee825".split(" "),Spectral:"#9e0142 #d53e4f #f46d43 #fdae61 #fee08b #ffffbf #e6f598 #abdda4 #66c2a5 #3288bd #5e4fa2".split(" "),RdYlGn:"#a50026 #d73027 #f46d43 #fdae61 #fee08b #ffffbf #d9ef8b #a6d96a #66bd63 #1a9850 #006837".split(" "),RdBu:"#67001f #b2182b #d6604d #f4a582 #fddbc7 #f7f7f7 #d1e5f0 #92c5de #4393c3 #2166ac #053061".split(" "),PiYG:"#8e0152 #c51b7d #de77ae #f1b6da #fde0ef #f7f7f7 #e6f5d0 #b8e186 #7fbc41 #4d9221 #276419".split(" "),PRGn:"#40004b #762a83 #9970ab #c2a5cf #e7d4e8 #f7f7f7 #d9f0d3 #a6dba0 #5aae61 #1b7837 #00441b".split(" "),RdYlBu:"#a50026 #d73027 #f46d43 #fdae61 #fee090 #ffffbf #e0f3f8 #abd9e9 #74add1 #4575b4 #313695".split(" "),BrBG:"#543005 #8c510a #bf812d #dfc27d #f6e8c3 #f5f5f5 #c7eae5 #80cdc1 #35978f #01665e #003c30".split(" "),RdGy:"#67001f #b2182b #d6604d #f4a582 #fddbc7 #ffffff #e0e0e0 #bababa #878787 #4d4d4d #1a1a1a".split(" "),PuOr:"#7f3b08 #b35806 #e08214 #fdb863 #fee0b6 #f7f7f7 #d8daeb #b2abd2 #8073ac #542788 #2d004b".split(" "),Set2:"#66c2a5 #fc8d62 #8da0cb #e78ac3 #a6d854 #ffd92f #e5c494 #b3b3b3".split(" "),Accent:"#7fc97f #beaed4 #fdc086 #ffff99 #386cb0 #f0027f #bf5b17 #666666".split(" "),Set1:"#e41a1c #377eb8 #4daf4a #984ea3 #ff7f00 #ffff33 #a65628 #f781bf #999999".split(" "),Set3:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69 #fccde5 #d9d9d9 #bc80bd #ccebc5 #ffed6f".split(" "),Dark2:"#1b9e77 #d95f02 #7570b3 #e7298a #66a61e #e6ab02 #a6761d #666666".split(" "),Paired:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f #ff7f00 #cab2d6 #6a3d9a #ffff99 #b15928".split(" "),Pastel2:"#b3e2cd #fdcdac #cbd5e8 #f4cae4 #e6f5c9 #fff2ae #f1e2cc #cccccc".split(" "),Pastel1:"#fbb4ae #b3cde3 #ccebc5 #decbe4 #fed9a6 #ffffcc #e5d8bd #fddaec #f2f2f2".split(" ")};(function(){var a,b;b=[];for(a in U)b.push(U[a.toLowerCase()]=U[a]);return b})();oa={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};u.colors=oa;Z=function(){var a,b,c,d,e,g,h,k,l;return b=K(arguments),e=b[0],a=b[1],c=b[2],k=(e+16)/116,h=isNaN(a)?k:k+a/500,l=isNaN(c)?k:k-c/200,k=f.Yn*aa(k),h=f.Xn*aa(h),l=f.Zn*aa(l),g=Ga(3.2404542*h-1.5371385*k-.4985314*l),d=Ga(-.969266*h+1.8760108*k+.041556*l),c=Ga(.0556434*h-.2040259*k+1.0572252*l),[g,d,c,3<b.length?b[3]:1]};Ga=function(a){return 255*(.00304>=a?12.92*a:1.055*R(a,1/2.4)-.055)};aa=function(a){return a>f.t1?a*a*a:f.t2*(a-f.t0)};f={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452};P=function(){var a,b,c,d,e,f,g,h;return d=K(arguments),c=d[0],b=d[1],a=d[2],e=va(c,b,a),f=e[0],g=e[1],h=e[2],[116*g-16,500*(f-g),200*(g-h)]};ea=function(a){return.04045>=(a/=255)?a/12.92:R((a+.055)/1.055,2.4)};wa=function(a){return a>f.t3?R(a,1/3):a/f.t2+f.t0};va=function(){var a,b,c,d,e,g,h;return d=K(arguments),c=d[0],b=d[1],a=d[2],c=ea(c),b=ea(b),a=ea(a),e=wa((.4124564*c+.3575761*b+.1804375*a)/f.Xn),g=wa((.2126729*c+.7151522*b+.072175*a)/f.Yn),h=wa((.0193339*c+.119192*b+.9503041*a)/f.Zn),[e,g,h]};u.lab=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["lab"]),function(){})};q.lab=Z;a.prototype.lab=function(){return P(this._rgb)};D=function(a){var b,c,d,e,f,g,h,k,l,B,n;return a=function(){var b,c,d;d=[];c=0;for(b=a.length;c<b;c++)e=a[c],d.push(u(e));return d}(),2===a.length?(l=function(){var b,c,d;d=[];c=0;for(b=a.length;c<b;c++)e=a[c],d.push(e.lab());return d}(),f=l[0],g=l[1],b=function(a){var b,c,d;d=[];for(b=c=0;2>=c;b=++c)d.push(f[b]+a*(g[b]-f[b]));return u.lab.apply(u,d)}):3===a.length?(B=function(){var b,c,d;d=[];c=0;for(b=a.length;c<b;c++)e=a[c],d.push(e.lab());return d}(),f=B[0],g=B[1],h=B[2],b=function(a){var b,c,d;d=[];for(b=c=0;2>=c;b=++c)d.push((1-a)*(1-a)*f[b]+2*(1-a)*a*g[b]+a*a*h[b]);return u.lab.apply(u,d)}):4===a.length?(n=function(){var b,c,d;d=[];c=0;for(b=a.length;c<b;c++)e=a[c],d.push(e.lab());return d}(),f=n[0],g=n[1],h=n[2],k=n[3],b=function(a){var b,c,d;d=[];for(b=c=0;2>=c;b=++c)d.push((1-a)*(1-a)*(1-a)*f[b]+3*(1-a)*(1-a)*a*g[b]+3*(1-a)*a*a*h[b]+a*a*a*k[b]);return u.lab.apply(u,d)}):5===a.length&&(c=D(a.slice(0,3)),d=D(a.slice(2,5)),b=function(a){return.5>a?c(2*a):d(2*(a-.5))}),b};u.bezier=function(a){var b;return b=D(a),b.scale=function(){return u.scale(b)},b};u.cubehelix=function(a,b,c,d,e){var f,g,h;return null==a&&(a=300),null==b&&(b=-1.5),null==c&&(c=1),null==d&&(d=1),null==e&&(e=[0,1]),f=0,"array"===J(e)?g=e[1]-e[0]:(g=0,e=[e,e]),h=function(h){var k,l,B,ka,xa,ga,pa,n,m;return k=t*((a+120)/360+b*h),pa=R(e[0]+g*h,d),ga=0!==f?c[0]+h*f:c,l=ga*pa*(1-pa)/2,ka=G(k),m=S(k),n=pa+l*(-.14861*ka+1.78277*m),xa=pa+l*(-.29227*ka-.90649*m),B=pa+1.97294*l*ka,u(I([255*n,255*xa,255*B]))},h.start=function(b){return null==b?a:(a=b,h)},h.rotations=function(a){return null==a?b:(b=a,h)},h.gamma=function(a){return null==a?d:(d=a,h)},h.hue=function(a){return null==a?c:(c=a,"array"===J(c)?(f=c[1]-c[0],0===f&&(c=c[1])):f=0,h)},h.lightness=function(a){return null==a?e:("array"===J(a)?(e=a,g=a[1]-a[0]):(e=[a,a],g=0),h)},h.scale=function(){return u.scale(h)},h.hue(c),h};u.random=function(){var b,c;b="#";for(c=0;6>c;++c)b+="0123456789abcdef".charAt(O(16*Math.random()));return new a(b)};u.average=function(a,b){var c,d,e,f,g,h,l,B,ka,n,m,p;null==b&&(b="rgb");B=a.length;a=a.map(function(a){return u(a)});d=a.splice(0,1)[0];m=d.get(b);f=[];h=g=0;for(l in m)m[l]=m[l]||0,f.push(isNaN(m[l])?0:1),"h"!==b.charAt(l)||isNaN(m[l])||(c=m[l]/180*k,g+=G(c),h+=S(c));d=d.alpha();n=0;for(ka=a.length;n<ka;n++)for(l in e=a[n],p=e.get(b),d+=e.alpha(),m)isNaN(p[l])||(m[l]+=p[l],f[l]+=1,"h"===b.charAt(l)&&(c=m[l]/180*k,g+=G(c),h+=S(c)));for(l in m)if(m[l]/=f[l],"h"===b.charAt(l)){for(c=F(h/f[l],g/f[l])/k*180;0>c;)c+=360;for(;360<=c;)c-=360;m[l]=c}return u(m,b).alpha(d/B)};q.rgb=function(){var a,b,c,d;b=K(arguments);c=[];for(a in b)d=b[a],c.push(d);return c};u.rgb=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["rgb"]),function(){})};a.prototype.rgb=function(a){return null==a&&(a=!0),a?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)};a.prototype.rgba=function(a){return null==a&&(a=!0),a?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)};p.push({p:3,test:function(a){var b;return b=K(arguments),"array"===J(b)&&3===b.length?"rgb":4===b.length&&"number"===J(b[3])&&0<=b[3]&&1>=b[3]?"rgb":void 0}});V=function(a){var b,c,d,e,f,g;if(a.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return 4!==a.length&&7!==a.length||(a=a.substr(1)),3===a.length&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),g=parseInt(a,16),e=g>>16,d=g>>8&255,c=255&g,[e,d,c,1];if(a.match(/^#?([A-Fa-f0-9]{8})$/))return 9===a.length&&(a=a.substr(1)),g=parseInt(a,16),e=g>>24&255,d=g>>16&255,c=g>>8&255,b=X((255&g)/255*100)/100,[e,d,c,b];if(null!=q.css&&(f=q.css(a)))return f;throw"unknown color: "+a;};ha=function(a,b){var c,d,e,f,g,h,k;return null==b&&(b="rgb"),g=a[0],e=a[1],d=a[2],c=a[3],g=Math.round(g),e=Math.round(e),d=Math.round(d),k=g<<16|e<<8|d,h="000000"+k.toString(16),h=h.substr(h.length-6),f="0"+X(255*c).toString(16),f=f.substr(f.length-2),"#"+function(){switch(b.toLowerCase()){case "rgba":return h+f;case "argb":return f+h;default:return h}}()};q.hex=function(a){return V(a)};u.hex=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["hex"]),function(){})};a.prototype.hex=function(a){return null==a&&(a="rgb"),ha(this._rgb,a)};p.push({p:4,test:function(a){if(1===arguments.length&&"string"===J(a))return"hex"}});Y=function(){var a,b,c,d,e,f,g;if(a=K(arguments),d=a[0],b=a[1],e=a[2],0===b)g=c=b=255*e;else{g=[0,0,0];c=[0,0,0];b=.5>e?e*(1+b):e+b-e*b;e=2*e-b;d/=360;g[0]=d+1/3;g[1]=d;g[2]=d-1/3;for(d=f=0;2>=f;d=++f)0>g[d]&&(g[d]+=1),1<g[d]&&--g[d],1>6*g[d]?c[d]=e+6*(b-e)*g[d]:1>2*g[d]?c[d]=b:2>3*g[d]?c[d]=e+(b-e)*(2/3-g[d])*6:c[d]=e;b=[X(255*c[0]),X(255*c[1]),X(255*c[2])];g=b[0];c=b[1];b=b[2]}return 3<a.length?[g,c,b,a[3]]:[g,c,b]};sa=function(a,b,c){var d,e,f,g,h;return void 0!==a&&3<=a.length&&(g=a,a=g[0],b=g[1],c=g[2]),a/=255,b/=255,c/=255,f=Math.min(a,b,c),w=Math.max(a,b,c),e=(w+f)/2,w===f?(h=0,d=Number.NaN):h=.5>e?(w-f)/(w+f):(w-f)/(2-w-f),a===w?d=(b-c)/(w-f):b===w?d=2+(c-a)/(w-f):c===w&&(d=4+(a-b)/(w-f)),d*=60,0>d&&(d+=360),[d,h,e]};u.hsl=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["hsl"]),function(){})};q.hsl=Y;a.prototype.hsl=function(){return sa(this._rgb)};Aa=function(){var a,b,c,d,e,f,g,h,k;return g=K(arguments),f=g[0],c=g[1],a=g[2],e=Math.min(f,c,a),w=Math.max(f,c,a),b=w-e,k=w/255,0===w?(d=Number.NaN,h=0):(h=b/w,f===w&&(d=(c-a)/b),c===w&&(d=2+(a-f)/b),a===w&&(d=4+(f-c)/b),d*=60,0>d&&(d+=360)),[d,h,k]};u.hsv=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["hsv"]),function(){})};q.hsv=function(){var a,b,c,d,e,f,g,h,k,l,m;if(a=K(arguments),e=a[0],l=a[1],m=a[2],m*=255,0===l)k=d=b=m;else switch(360===e&&(e=0),360<e&&(e-=360),0>e&&(e+=360),e/=60,f=O(e),c=e-f,g=m*(1-l),h=m*(1-l*c),l=m*(1-l*(1-c)),f){case 0:b=[m,l,g];k=b[0];d=b[1];b=b[2];break;case 1:b=[h,m,g];k=b[0];d=b[1];b=b[2];break;case 2:b=[g,m,l];k=b[0];d=b[1];b=b[2];break;case 3:b=[g,h,m];k=b[0];d=b[1];b=b[2];break;case 4:b=[l,g,m];k=b[0];d=b[1];b=b[2];break;case 5:b=[m,g,h],k=b[0],d=b[1],b=b[2]}return[k,d,b,3<a.length?a[3]:1]};a.prototype.hsv=function(){return Aa(this._rgb)};Ba=function(){var a,b,c,d;return d=K(arguments),c=d[0],b=d[1],a=d[2],(c<<16)+(b<<8)+a};u.num=function(b){return new a(b,"num")};a.prototype.num=function(a){return null==a&&(a="rgb"),Ba(this._rgb,a)};q.num=function(a){var b,c,d;return"number"===J(a)&&0<=a&&16777215>=a?(d=a>>16,c=a>>8&255,b=255&a,[d,c,b,1]):(console.warn("unknown num color: "+a),[0,0,0,1])};p.push({p:1,test:function(a){if(1===arguments.length&&"number"===J(a)&&0<=a&&16777215>=a)return"num"}});qa=function(){var a,b,c,d,e,f,g,h,k;return k=K(arguments),h=k[0],e=k[1],b=k[2],g=Math.min(h,e,b),w=Math.max(h,e,b),d=w-g,c=100*d/255,a=g/(255-d)*100,0===d?f=Number.NaN:(h===w&&(f=(e-b)/d),e===w&&(f=2+(b-h)/d),b===w&&(f=4+(h-e)/d),f*=60,0>f&&(f+=360)),[f,c,a]};u.hcg=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["hcg"]),function(){})};q.hcg=function(){var a,b,c,d,e,f,g,h,k,l,m;if(c=K(arguments),h=c[0],e=c[1],b=c[2],e/=100,g=g/100*255,a=255*e,0===e)m=g=d=b;else switch(360===h&&(h=0),360<h&&(h-=360),0>h&&(h+=360),h/=60,k=O(h),f=h-k,l=b*(1-e),b=l+a*(1-f),e=l+a*f,a=l+a,k){case 0:d=[a,e,l];m=d[0];g=d[1];d=d[2];break;case 1:d=[b,a,l];m=d[0];g=d[1];d=d[2];break;case 2:d=[l,a,e];m=d[0];g=d[1];d=d[2];break;case 3:d=[l,b,a];m=d[0];g=d[1];d=d[2];break;case 4:d=[e,l,a];m=d[0];g=d[1];d=d[2];break;case 5:d=[a,l,b],m=d[0],g=d[1],d=d[2]}return[m,g,d,3<c.length?c[3]:1]};a.prototype.hcg=function(){return qa(this._rgb)};z=function(a){var b,c,d;if(a=a.toLowerCase(),null!=u.colors&&u.colors[a])return V(u.colors[a]);if(c=a.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){d=c.slice(1,4);for(a=b=0;2>=b;a=++b)d[a]=+d[a];d[3]=1}else if(c=a.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(d=c.slice(1,5),a=b=0;3>=b;a=++b)d[a]=+d[a];else if(c=a.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){d=c.slice(1,4);for(a=b=0;2>=b;a=++b)d[a]=X(2.55*d[a]);d[3]=1}else if(c=a.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){d=c.slice(1,5);for(a=b=0;2>=b;a=++b)d[a]=X(2.55*d[a]);d[3]=+d[3]}else(c=a.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?(b=c.slice(1,4),b[1]*=.01,b[2]*=.01,d=Y(b),d[3]=1):(c=a.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&(b=c.slice(1,4),b[1]*=.01,b[2]*=.01,d=Y(b),d[3]=+c[4]);return d};Ca=function(a){var b;return b=1>a[3]?"rgba":"rgb","rgb"===b?b+"("+a.slice(0,3).map(X).join(",")+")":"rgba"===b?b+"("+a.slice(0,3).map(X).join(",")+","+a[3]+")":void 0};ma=function(a){return X(100*a)/100};ba=function(a,b){var c;return c=1>b?"hsla":"hsl",a[0]=ma(a[0]||0),a[1]=ma(100*a[1])+"%",a[2]=ma(100*a[2])+"%","hsla"===c&&(a[3]=b),c+"("+a.join(",")+")"};q.css=function(a){return z(a)};u.css=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["css"]),function(){})};a.prototype.css=function(a){return null==a&&(a="rgb"),"rgb"===a.slice(0,3)?Ca(this._rgb):"hsl"===a.slice(0,3)?ba(this.hsl(),this.alpha()):void 0};q.named=function(a){return V(oa[a])};p.push({p:5,test:function(a){if(1===arguments.length&&null!=oa[a])return"named"}});a.prototype.name=function(a){var b,c;arguments.length&&(oa[a]&&(this._rgb=V(oa[a])),this._rgb[3]=1);b=this.hex();for(c in oa)if(b===oa[c])return c;return b};Q=function(){var a,b,c,d;return d=K(arguments),c=d[0],a=d[1],b=d[2],b*=e,[c,G(b)*a,S(b)*a]};ua=function(){var a,b,c,d,e,f,g,h,k,l,m;return c=K(arguments),h=c[0],e=c[1],g=c[2],l=Q(h,e,g),a=l[0],b=l[1],d=l[2],m=Z(a,b,d),k=m[0],f=m[1],d=m[2],[k,f,d,3<c.length?c[3]:1]};C=function(){var a,b,c,d,e,f;return f=K(arguments),e=f[0],a=f[1],b=f[2],c=fa(a*a+b*b),d=(F(b,a)*m+360)%360,0===X(1E4*c)&&(d=Number.NaN),[e,c,d]};na=function(){var a,b,c,d,e,f,g;return f=K(arguments),e=f[0],c=f[1],b=f[2],g=P(e,c,b),d=g[0],a=g[1],b=g[2],C(d,a,b)};u.lch=function(){var b;return b=K(arguments),new a(b,"lch")};u.hcl=function(){var b;return b=K(arguments),new a(b,"hcl")};q.lch=ua;q.hcl=function(){var a,b,c,d;return d=K(arguments),b=d[0],a=d[1],c=d[2],ua([c,a,b])};a.prototype.lch=function(){return na(this._rgb)};a.prototype.hcl=function(){return na(this._rgb).reverse()};ia=function(a){var b,c,d,e,f,g,h,k,l;return null==a&&(a="rgb"),k=K(arguments),h=k[0],e=k[1],b=k[2],h/=255,e/=255,b/=255,f=1-Math.max(h,Math.max(e,b)),d=1>f?1/(1-f):0,c=(1-h-f)*d,g=(1-e-f)*d,l=(1-b-f)*d,[c,g,l,f]};N=function(){var a,b,c,d,e,f,g,h,k;return b=K(arguments),d=b[0],g=b[1],k=b[2],f=b[3],a=4<b.length?b[4]:1,1===f?[0,0,0,a]:(h=1<=d?0:255*(1-d)*(1-f),e=1<=g?0:255*(1-g)*(1-f),c=1<=k?0:255*(1-k)*(1-f),[h,e,c,a])};q.cmyk=function(){return N(K(arguments))};u.cmyk=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["cmyk"]),function(){})};a.prototype.cmyk=function(){return ia(this._rgb)};q.gl=function(){var a,b,c,d,e;d=function(){var a,c;a=K(arguments);c=[];for(b in a)e=a[b],c.push(e);return c}.apply(this,arguments);for(a=c=0;2>=c;a=++c)d[a]*=255;return d};u.gl=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["gl"]),function(){})};a.prototype.gl=function(){var a;return a=this._rgb,[a[0]/255,a[1]/255,a[2]/255,a[3]]};ra=function(a,b,c){var d;return d=K(arguments),a=d[0],b=d[1],c=d[2],a=ta(a),b=ta(b),c=ta(c),.2126*a+.7152*b+.0722*c};ta=function(a){return a/=255,.03928>=a?a/12.92:R((a+.055)/1.055,2.4)};x=[];T=function(a,b,c,d){var e,f,g,h;null==c&&(c=.5);null==d&&(d="rgb");"object"!==J(a)&&(a=u(a));"object"!==J(b)&&(b=u(b));g=0;for(f=x.length;g<f;g++)if(e=x[g],d===e[0]){h=e[1](a,b,c,d);break}if(null==h)throw"color mode "+d+" is not supported";return h.alpha(a.alpha()+c*(b.alpha()-a.alpha()))};u.interpolate=T;a.prototype.interpolate=function(a,b,c){return T(this,a,b,c)};u.mix=T;a.prototype.mix=a.prototype.interpolate;x.push(["rgb",function(b,c,d,e){var f,g;return f=b._rgb,g=c._rgb,new a(f[0]+d*(g[0]-f[0]),f[1]+d*(g[1]-f[1]),f[2]+d*(g[2]-f[2]),e)}]);a.prototype.luminance=function(a,b){var c,d,e;return null==b&&(b="rgb"),arguments.length?(0===a?this._rgb=[0,0,0,this._rgb[3]]:1===a?this._rgb=[255,255,255,this._rgb[3]]:(d=20,e=function(c,f){var g,h;return h=c.interpolate(f,.5,b),g=h.luminance(),1E-7>Math.abs(a-g)||!d--?h:g>a?e(c,h):e(h,f)},c=ra(this._rgb),this._rgb=(c>a?e(u("black"),this):e(this,u("white"))).rgba()),this):ra(this._rgb)};Fa=function(a){var b,c,d,e;return e=a/100,66>e?(d=255,c=-155.25485562709179-.44596950469579133*(c=e-2)+104.49216199393888*da(c),b=20>e?0:-254.76935184120902+.8274096064007395*(b=e-10)+115.67994401066147*da(b)):(d=351.97690566805693+.114206453784165*(d=e-55)-40.25366309332127*da(d),c=325.4494125711974+.07943456536662342*(c=e-50)-28.0852963507957*da(c),b=255),[d,c,b]};Ea=function(){var a,b,c,d,e,f;a=K(arguments);d=a[0];a=a[2];c=1E3;for(b=4E4;.4<b-c;)f=.5*(b+c),e=Fa(f),e[2]/e[0]>=a/d?b=f:c=f;return X(f)};u.temperature=u.kelvin=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["temperature"]),function(){})};q.temperature=q.kelvin=q.K=Fa;a.prototype.temperature=function(){return Ea(this._rgb)};a.prototype.kelvin=a.prototype.temperature;u.contrast=function(b,c){var d,e,f,g;return"string"!==(f=J(b))&&"number"!==f||(b=new a(b)),"string"!==(g=J(c))&&"number"!==g||(c=new a(c)),d=b.luminance(),e=c.luminance(),d>e?(d+.05)/(e+.05):(e+.05)/(d+.05)};u.distance=function(b,c,d){var e,f,g;null==d&&(d="lab");"string"!==(f=J(b))&&"number"!==f||(b=new a(b));"string"!==(g=J(c))&&"number"!==g||(c=new a(c));b=b.get(d);d=c.get(d);f=0;for(e in b)c=(b[e]||0)-(d[e]||0),f+=c*c;return Math.sqrt(f)};u.deltaE=function(b,c,d,e){var f,g,h,l,m,n,B,p,t,r,q,u,ka,ga,xa,w,x,v,Na,z;null==d&&(d=1);null==e&&(e=1);"string"!==(f=J(b))&&"number"!==f||(b=new a(b));"string"!==(h=J(c))&&"number"!==h||(c=new a(c));h=b.lab();b=h[0];f=h[1];h=h[2];l=c.lab();c=l[0];g=l[1];l=l[2];m=fa(f*f+h*h);n=fa(g*g+l*l);x=16>b?.511:.040975*b/(1+.01765*b);xa=.0638*m/(1+.0131*m)+.638;for(ga=1E-6>m?0:180*F(h,f)/k;0>ga;)ga+=360;for(;360<=ga;)ga-=360;return v=164<=ga&&345>=ga?.56+A(.2*G(k*(ga+168)/180)):.36+A(.4*G(k*(ga+35)/180)),B=m*m*m*m,ka=fa(B/(B+1900)),w=xa*(ka*v+1-ka),u=b-c,q=m-n,t=f-g,r=h-l,p=t*t+r*r-q*q,Na=u/(d*x),z=q/(e*xa),fa(Na*Na+z*z+p/(w*w))};a.prototype.get=function(a){var b,c,d,e,f;return e=a.split("."),d=e[0],b=e[1],f=this[d](),b?(c=d.indexOf(b),-1<c?f[c]:console.warn("unknown channel "+b+" in mode "+d)):f};a.prototype.set=function(a,b){var c,d,e,f;if(f=a.split("."),e=f[0],c=f[1],c)if(f=this[e](),d=e.indexOf(c),-1<d)if("string"===J(b))switch(b.charAt(0)){case "+":f[d]+=+b;break;case "-":f[d]+=+b;break;case "*":f[d]*=+b.substr(1);break;case "/":f[d]/=+b.substr(1);break;default:f[d]=+b}else f[d]=b;else console.warn("unknown channel "+c+" in mode "+e);else f=b;return u(f,e).alpha(this.alpha())};a.prototype.clipped=function(){return this._rgb._clipped||!1};a.prototype.alpha=function(a){return arguments.length?u.rgb([this._rgb[0],this._rgb[1],this._rgb[2],a]):this._rgb[3]};a.prototype.darken=function(a){var b;return null==a&&(a=1),b=this.lab(),b[0]-=f.Kn*a,u.lab(b).alpha(this.alpha())};a.prototype.brighten=function(a){return null==a&&(a=1),this.darken(-a)};a.prototype.darker=a.prototype.darken;a.prototype.brighter=a.prototype.brighten;a.prototype.saturate=function(a){var b;return null==a&&(a=1),b=this.lch(),b[1]+=a*f.Kn,0>b[1]&&(b[1]=0),u.lch(b).alpha(this.alpha())};a.prototype.desaturate=function(a){return null==a&&(a=1),this.saturate(-a)};a.prototype.premultiply=function(){var a,b;return b=this.rgb(),a=this.alpha(),u(b[0]*a,b[1]*a,b[2]*a,a)};E=function(a,b,c){if(!E[c])throw"unknown blend mode "+c;return E[c](a,b)};H=function(a){return function(b,c){var d,e;return d=u(c).rgb(),e=u(b).rgb(),u(a(d,e),"rgb")}};v=function(a){return function(b,c){var d,e,f;f=[];for(d=e=0;3>=e;d=++e)f[d]=a(b[d],c[d]);return f}};E.normal=H(v(function(a,b){return a}));E.multiply=H(v(function(a,b){return a*b/255}));E.screen=H(v(function(a,b){return 255*(1-(1-a/255)*(1-b/255))}));E.overlay=H(v(function(a,b){return 128>b?2*a*b/255:255*(1-2*(1-a/255)*(1-b/255))}));E.darken=H(v(function(a,b){return a>b?b:a}));E.lighten=H(v(function(a,b){return a>b?a:b}));E.dodge=H(v(function(a,b){return 255===a?255:(a=b/255*255/(1-a/255),255<a?255:a)}));E.burn=H(v(function(a,b){return 255*(1-(1-b/255)/(a/255))}));u.blend=E;u.analyze=function(a){var b,c,d,e;d={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};c=0;for(b=a.length;c<b;c++)e=a[c],null==e||isNaN(e)||(d.values.push(e),d.sum+=e,e<d.min&&(d.min=e),e>d.max&&(d.max=e),d.count+=1);return d.domain=[d.min,d.max],d.limits=function(a,b){return u.limits(d,a,b)},d};u.scale=function(a,b){var c,d,e,f,g,h,k,l,m,n,p,t,r,B,q,w,x,v,A,z;return l="rgb",m=u("#ccc"),r=0,g=[0,1],t=[],p=[0,0],c=!1,e=[],n=!1,k=0,h=1,f=!1,d={},B=!0,A=function(a){var b,c,d,f;if(null==a&&(a=["#fff","#000"]),null!=a&&"string"===J(a)&&null!=u.brewer&&(a=u.brewer[a]||u.brewer[a.toLowerCase()]||a),"array"===J(a)){a=a.slice(0);b=d=0;for(f=a.length-1;0<=f?d<=f:d>=f;b=0<=f?++d:--d)c=a[b],"string"===J(c)&&(a[b]=u(c));b=d=t.length=0;for(c=a.length-1;0<=c?d<=c:d>=c;b=0<=c?++d:--d)t.push(b/(a.length-1))}return v(),e=a},w=function(a){var b,d;if(null!=c){d=c.length-1;for(b=0;b<d&&a>=c[b];)b++;return b-1}return 0},z=function(a){return a},x=function(a,b){var f,g,n,r,q,x,v;if(null==b&&(b=!1),isNaN(a))return m;if(b?v=a:c&&2<c.length?(f=w(a),v=f/(c.length-2),v=p[0]+v*(1-p[0]-p[1])):h!==k?(v=(a-k)/(h-k),v=p[0]+v*(1-p[0]-p[1]),v=Math.min(1,Math.max(0,v))):v=1,b||(v=z(v)),n=Math.floor(1E4*v),B&&d[n])g=d[n];else{if("array"===J(e))for(f=r=0,x=t.length-1;0<=x?r<=x:r>=x;f=0<=x?++r:--r){if(q=t[f],v<=q){g=e[f];break}if(v>=q&&f===t.length-1){g=e[f];break}if(v>q&&v<t[f+1]){v=(v-q)/(t[f+1]-q);g=u.interpolate(e[f],e[f+1],v,l);break}}else"function"===J(e)&&(g=e(v));B&&(d[n]=g)}return g},v=function(){return d={}},A(a),q=function(a){var b;return b=u(x(a)),n&&b[n]?b[n]():b},q.classes=function(a){var b;return null!=a?("array"===J(a)?(c=a,g=[a[0],a[a.length-1]]):(b=u.analyze(g),c=0===a?[b.min,b.max]:u.limits(b,"e",a)),q):c},q.domain=function(a){var b,c,d,f;if(!arguments.length)return g;if(k=a[0],h=a[a.length-1],t=[],c=e.length,a.length===c&&k!==h)for(d=0,c=a.length;d<c;d++)b=a[d],t.push((b-k)/(h-k));else for(b=f=0,d=c-1;0<=d?f<=d:f>=d;b=0<=d?++f:--f)t.push(b/(c-1));return g=[k,h],q},q.mode=function(a){return arguments.length?(l=a,v(),q):l},q.range=function(a,b){return A(a,b),q},q.out=function(a){return n=a,q},q.spread=function(a){return arguments.length?(r=a,q):r},q.correctLightness=function(a){return null==a&&(a=!0),f=a,v(),z=f?function(a){var b,c,d,e,f,g,h;b=x(0,!0).lab()[0];c=x(1,!0).lab()[0];f=b>c;d=x(a,!0).lab()[0];c=b+(c-b)*a;b=d-c;g=0;h=1;for(e=20;.01<Math.abs(b)&&0<e--;)!(f&&(b*=-1),0>b?(g=a,a+=.5*(h-a)):(h=a,a+=.5*(g-a)),d=x(a,!0).lab()[0],b=d-c);return a}:function(a){return a},q},q.padding=function(a){return null!=a?("number"===J(a)&&(a=[a,a]),p=a,q):p},q.colors=function(b,d){var f,h,k,l,m,n,p;if(2>arguments.length&&(d="hex"),k=[],0===arguments.length)k=e.slice(0);else if(1===b)k=[q(.5)];else if(1<b)h=g[0],f=g[1]-h,k=function(){m=[];for(var a=0;0<=b?a<b:a>b;0<=b?a++:a--)m.push(a);return m}.apply(this).map(function(a){return q(h+a/(b-1)*f)});else{if(a=[],n=[],c&&2<c.length)for(k=p=1,l=c.length;1<=l?p<l:p>l;k=1<=l?++p:--p)n.push(.5*(c[k-1]+c[k]));else n=g;k=n.map(function(a){return q(a)})}return u[d]&&(k=k.map(function(a){return a[d]()})),k},q.cache=function(a){return null!=a?B=a:B},q};null==u.scales&&(u.scales={});u.scales.cool=function(){return u.scale([u.hsl(180,1,.9),u.hsl(250,.7,.4)])};u.scales.hot=function(){return u.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")};u.analyze=function(a,b,c){var d,e,f,g,h,k;if(g={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==c&&(c=function(){return!0}),d=function(a){null==a||isNaN(a)||(g.values.push(a),g.sum+=a,a<g.min&&(g.min=a),a>g.max&&(g.max=a),g.count+=1)},k=function(a,e){if(c(a,e))return d(null!=b&&"function"===J(b)?b(a):null!=b&&"string"===J(b)||"number"===J(b)?a[b]:a)},"array"===J(a))for(f=0,e=a.length;f<e;f++)h=a[f],k(h);else for(e in a)h=a[e],k(h,e);return g.domain=[g.min,g.max],g.limits=function(a,b){return u.limits(g,a,b)},g};u.limits=function(a,b,c){var d,e,f,g,h,k,l,m,n,p,t,r,q,v,x;if(null==b&&(b="equal"),null==c&&(c=7),"array"===J(a)&&(a=u.analyze(a)),l=a.min,w=a.max,p=a.values.sort(function(a,b){return a-b}),1===c)return[l,w];if(n=[],"c"===b.substr(0,1)&&(n.push(l),n.push(w)),"e"===b.substr(0,1)){n.push(l);a=p=1;for(h=c-1;1<=h?p<=h:p>=h;a=1<=h?++p:--p)n.push(l+a/c*(w-l));n.push(w)}else if("l"===b.substr(0,1)){if(0>=l)throw"Logarithmic scales are only possible for values \x3e 0";h=Math.LOG10E*da(l);p=Math.LOG10E*da(w);n.push(l);a=k=1;for(b=c-1;1<=b?k<=b:k>=b;a=1<=b?++k:--k)n.push(R(10,h+a/c*(p-h)));n.push(w)}else if("q"===b.substr(0,1)){n.push(l);a=b=1;for(k=c-1;1<=k?b<=k:b>=k;a=1<=k?++b:--b)a=(p.length-1)*a/c,g=O(a),g===a?n.push(p[g]):(h=a-g,n.push(p[g]*(1-h)+p[g+1]*h));n.push(w)}else if("k"===b.substr(0,1)){b=p.length;h=Array(b);m=Array(c);e=!0;r=0;g=null;g=[];g.push(l);a=d=1;for(f=c-1;1<=f?d<=f:d>=f;a=1<=f?++d:--d)g.push(l+a/c*(w-l));for(g.push(w);e;){l=a=0;for(d=c-1;0<=d?a<=d:a>=d;l=0<=d?++a:--a)m[l]=0;a=d=0;for(q=b-1;0<=q?d<=q:d>=q;a=0<=q?++d:--d){x=p[a];t=Number.MAX_VALUE;l=e=0;for(v=c-1;0<=v?e<=v:e>=v;l=0<=v?++e:--e)f=A(g[l]-x),f<t&&(t=f,k=l);m[k]++;h[a]=k}d=Array(c);l=a=0;for(e=c-1;0<=e?a<=e:a>=e;l=0<=e?++a:--a)d[l]=null;a=e=0;for(f=b-1;0<=f?e<=f:e>=f;a=0<=f?++e:--e)l=h[a],null===d[l]?d[l]=p[a]:d[l]+=p[a];l=e=0;for(f=c-1;0<=f?e<=f:e>=f;l=0<=f?++e:--e)d[l]*=1/m[l];e=!1;l=f=0;for(t=c-1;0<=t?f<=t:f>=t;l=0<=t?++f:--f)if(d[l]!==g[a]){e=!0;break}g=d;r++;200<r&&(e=!1)}k={};l=a=0;for(g=c-1;0<=g?a<=g:a>=g;l=0<=g?++a:--a)k[l]=[];a=g=0;for(--b;0<=b?g<=b:g>=b;a=0<=b?++g:--g)l=h[a],k[l].push(p[a]);p=[];l=a=0;for(--c;0<=c?a<=c:a>=c;l=0<=c?++a:--a)p.push(k[l][0]),p.push(k[l][k[l].length-1]);p=p.sort(function(a,b){return a-b});n.push(p[0]);a=c=1;for(h=p.length-1;c<=h;a=c+=2)a=p[a],isNaN(a)||-1!==n.indexOf(a)||n.push(a)}return n};Da=function(){var a,b,c,d,e,f,g,h;return g=K(arguments),f=g[0],b=g[1],a=g[2],t=2*Math.PI,f/=255,b/=255,a/=255,e=Math.min(f,b,a),d=(f+b+a)/3,h=1-e/d,0===h?c=0:(c=(f-b+(f-a))/2,c/=Math.sqrt((f-b)*(f-b)+(f-a)*(b-a)),c=Math.acos(c),a>b&&(c=t-c),c/=t),[360*c,h,d]};u.hsi=function(){return function(a,b,c){c.prototype=a.prototype;c=new c;a=a.apply(c,b);return Object(a)===a?a:c}(a,ja.call(arguments).concat(["hsi"]),function(){})};q.hsi=function(a,b,c){var d,e,f,g;return d=K(arguments),a=d[0],b=d[1],c=d[2],isNaN(a)&&(a=0),a/=360,a<1/3?(e=(1-b)/3,g=(1+b*G(t*a)/G(l-t*a))/3,f=1-(e+g)):a<2/3?(a-=1/3,g=(1-b)/3,f=(1+b*G(t*a)/G(l-t*a))/3,e=1-(g+f)):(a-=2/3,f=(1-b)/3,e=(1+b*G(t*a)/G(l-t*a))/3,g=1-(f+e)),g=la(c*g*3),f=la(c*f*3),e=la(c*e*3),[255*g,255*f,255*e,3<d.length?d[3]:1]};a.prototype.hsi=function(){return Da(this._rgb)};M=function(a,b,c,d){var e,f,g,h,k,l,m,n,p,t,r,q;return"hsl"===d?(r=a.hsl(),q=b.hsl()):"hsv"===d?(r=a.hsv(),q=b.hsv()):"hcg"===d?(r=a.hcg(),q=b.hcg()):"hsi"===d?(r=a.hsi(),q=b.hsi()):"lch"!==d&&"hcl"!==d||(d="hcl",r=a.hcl(),q=b.hcl()),"h"===d.substr(0,1)&&(g=r[0],p=r[1],l=r[2],h=q[0],t=q[1],m=q[2]),isNaN(g)||isNaN(h)?isNaN(g)?isNaN(h)?f=Number.NaN:(f=h,1!==l&&0!==l||"hsv"===d||(n=t)):(f=g,1!==m&&0!==m||"hsv"===d||(n=p)):(e=h>g&&180<h-g?h-(g+360):h<g&&180<g-h?h+360-g:h-g,f=g+c*e),null==n&&(n=p+c*(t-p)),k=l+c*(m-l),u[d](f,n,k)};x=x.concat(function(){var a,b,c,d;c="hsv hsl hsi hcl lch hcg".split(" ");d=[];b=0;for(a=c.length;b<a;b++)W=c[b],d.push([W,M]);return d}());x.push(["num",function(a,b,c,d){var e,f;return e=a.num(),f=b.num(),u.num(e+(f-e)*c,"num")}]);x.push(["lab",function(b,c,d,e){var f,g;return f=b.lab(),g=c.lab(),new a(f[0]+d*(g[0]-f[0]),f[1]+d*(g[1]-f[1]),f[2]+d*(g[2]-f[2]),e)}])}).call(this)}).call(g,d(110)(f))},function(f,g,d){(function(c){function b(a){var b=a?a.length:0;for(this.data={hash:h(null),set:new e};b--;)this.push(a[b])}var g=d(72),a=d(17),e=a(c,"Set"),h=a(Object,"create");b.prototype.push=g;f.exports=b}).call(g,function(){return this}())},function(f,g){f.exports=function(d,c){var b=-1,f=d.length;for(c||(c=Array(f));++b<f;)c[b]=d[b];return c}},function(f,g){f.exports=function(d,c){for(var b=-1,f=d.length,a=Array(f);++b<f;)a[b]=c(d[b],b,d);return a}},function(f,g){f.exports=function(d,c){for(var b=-1,f=c.length,a=d.length;++b<f;)d[a+b]=c[b];return d}},function(f,g){f.exports=function(d,c){for(var b=-1,f=d.length;++b<f;)if(c(d[b],b,d))return!0;return!1}},function(f,g){f.exports=function(d,c){return void 0===d?c:d}},function(f,g,d){var c=d(3);f.exports=function(b,d,a){for(var e=-1,f=c(d),g=f.length;++e<g;){var l=f[e],m=b[l],t=a(m,d[l],l,b,d);(t===t?t===m:m!==m)&&(void 0!==m||l in b)||(b[l]=t)}return b}},function(f,g,d){var c=d(62),b=d(71),l=d(73);f.exports=function(a,d){var e=a?a.length:0,f=[];if(!e)return f;var g=-1,m=c,t=!0,p=t&&200<=d.length?l(d):null,r=d.length;p&&(m=b,t=!1,d=p);a:for(;++g<e;)if(p=a[g],t&&p===p){for(var q=r;q--;)if(d[q]===p)continue a;f.push(p)}else 0>m(d,p,0)&&f.push(p);return f}},function(f,g){f.exports=function(d,c,b,f){var a;return b(d,function(b,d,g){if(c(b,d,g))return a=f?d:b,!1}),a}},function(f,g,d){var c=d(18);f.exports=function(b,d){for(var a=-1,e=d.length,f=-1,g=[];++a<e;){var l=d[a];c(b[l])&&(g[++f]=l)}return g}},function(f,g,d){var c=d(79);f.exports=function(b,d,a){if(d!==d)return c(b,a);--a;for(var e=b.length;++a<e;)if(b[a]===d)return a;return-1}},function(f,g,d){var c=d(74),b=d(75),l=d(76),a=d(2),e=d(19);g=Object.prototype;var h=g.hasOwnProperty,k=g.toString;f.exports=function(d,f,g,p,r,q,x){var m=a(d),n=a(f),t="[object Array]",E="[object Array]";m||(t=k.call(d),"[object Arguments]"==t?t="[object Object]":"[object Object]"!=t&&(m=e(d)));n||(E=k.call(f),"[object Arguments]"==E?E="[object Object]":"[object Object]"!=E&&e(f));var H="[object Object]"==t,n="[object Object]"==E;if((E=t==E)&&!m&&!H)return b(d,f,t);if(!r&&(t=H&&h.call(d,"__wrapped__"),n=n&&h.call(f,"__wrapped__"),t||n))return g(t?d.value():d,n?f.value():f,p,r,q,x);if(!E)return!1;q||(q=[]);x||(x=[]);for(t=q.length;t--;)if(q[t]==d)return x[t]==f;q.push(d);x.push(f);d=(m?c:l)(d,f,g,p,r,q,x);return q.pop(),x.pop(),d}},function(f,g,d){var c=d(35),b=d(5);f.exports=function(d,a,e){var f=a.length,g=f,l=!e;if(null==d)return!g;for(d=b(d);f--;){var m=a[f];if(l&&m[2]?m[1]!==d[m[0]]:!(m[0]in d))return!1}for(;++f<g;){var m=a[f],t=m[0],p=d[t],r=m[1];if(l&&m[2]){if(void 0===p&&!(t in d))return!1}else if(m=e?e(p,r,t):void 0,void 0===m?!c(r,p,e,!0):!m)return!1}return!0}},function(f,g,d){var c=d(64),b=d(78),l=d(5);f.exports=function(a){var d=b(a);if(1==d.length&&d[0][2]){var f=d[0][0],g=d[0][1];return function(a){return null!=a&&a[f]===g&&(void 0!==g||f in l(a))}}return function(a){return c(a,d)}}},function(f,g,d){var c=d(12),b=d(35),l=d(23),a=d(2),e=d(14),h=d(45),k=d(20),n=d(5),m=d(10);f.exports=function(d,f){var g=a(d),p=e(d)&&h(f),t=d+"";return d=m(d),function(a){if(null==a)return!1;var e=t;if(a=n(a),!(!g&&p||e in a)){if(a=1==d.length?a:c(a,l(d,0,-1)),null==a)return!1;e=k(d);a=n(a)}return a[e]===f?void 0!==f||e in a:b(f,a[e],void 0,!0)}}},function(f,g,d){function c(d,f,g,q,x){if(!h(d))return d;var p=e(f)&&(a(f)||n(f)),t=p?void 0:m(f);return b(t||f,function(a,b){if(t&&(b=a,a=f[b]),k(a))q||(q=[]),x||(x=[]),l(d,f,b,c,g,q,x);else{var e=d[b],h=g?g(e,a,b,d,f):void 0,m=void 0===h;m&&(h=a);void 0===h&&(!p||b in d)||!m&&(h===h?h===e:e!==e)||(d[b]=h)}}),d}var b=d(27),l=d(68),a=d(2),e=d(8),h=d(1),k=d(4),n=d(19),m=d(3);f.exports=c},function(f,g,d){var c=d(53),b=d(11),l=d(2),a=d(8),e=d(83),h=d(19),k=d(84);f.exports=function(d,f,g,p,r,q,x){for(var m=q.length,n=f[g];m--;)if(q[m]==n)return void(d[g]=x[m]);m=d[g];f=r?r(m,n,g,d,f):void 0;var t=void 0===f;t&&(f=n,a(n)&&(l(n)||h(n))?f=l(m)?m:a(m)?c(m):[]:e(n)||b(n)?f=b(m)?k(m):e(m)?m:{}:t=!1);q.push(n);x.push(f);t?d[g]=p(f,n,r,q,x):(f===f?f!==m:m===m)&&(d[g]=f)}},function(f,g,d){var c=d(12),b=d(10);f.exports=function(d){var a=d+"";return d=b(d),function(b){return c(b,d,a)}}},function(f,g){f.exports=function(d){return null==d?"":d+""}},function(f,g,d){var c=d(1);f.exports=function(b,d){var a=b.data;return("string"==typeof d||c(d)?a.set.has(d):a.hash[d])?0:-1}},function(f,g,d){var c=d(1);f.exports=function(b){var d=this.data;"string"==typeof b||c(b)?d.set.add(b):d.hash[b]=!0}},function(f,g,d){(function(c){var b=d(52),g=d(17),a=g(c,"Set"),e=g(Object,"create");f.exports=function(c){return e&&a?new b(c):null}}).call(g,function(){return this}())},function(f,g,d){var c=d(56);f.exports=function(b,d,a,e,f,g,n){var h=-1,k=b.length,l=d.length;if(k!=l&&!(f&&l>k))return!1;for(;++h<k;){var r=b[h],l=d[h],q=e?e(f?l:r,f?r:l,h):void 0;if(void 0!==q){if(q)continue;return!1}if(f){if(!c(d,function(b){return r===b||a(r,b,e,f,g,n)}))return!1}else if(r!==l&&!a(r,l,e,f,g,n))return!1}return!0}},function(f,g){f.exports=function(d,c,b){switch(b){case "[object Boolean]":case "[object Date]":return+d==+c;case "[object Error]":return d.name==c.name&&d.message==c.message;case "[object Number]":return d!=+d?c!=+c:d==+c;case "[object RegExp]":case "[object String]":return d==c+""}return!1}},function(f,g,d){var c=d(3),b=Object.prototype.hasOwnProperty;f.exports=function(d,a,e,f,g,n,m){var h=c(d),k=h.length,l=c(a).length;if(k!=l&&!g)return!1;for(l=k;l--;){var q=h[l];if(!(g?q in a:b.call(a,q)))return!1}for(var x=g;++l<k;){var q=h[l],A=d[q],F=a[q],D=f?f(g?F:A,g?A:F,q):void 0;if(void 0===D?!e(A,F,f,g,n,m):!D)return!1;x||(x="constructor"==q)}return x||(e=d.constructor,f=a.constructor,!(e!=f&&"constructor"in d&&"constructor"in a)||"function"==typeof e&&e instanceof e&&"function"==typeof f&&f instanceof f)?!0:!1}},function(f,g,d){g=d(36)("length");f.exports=g},function(f,g,d){var c=d(45),b=d(49);f.exports=function(d){d=b(d);for(var a=d.length;a--;)d[a][2]=c(d[a][1]);return d}},function(f,g){f.exports=function(d,c,b){var f=d.length;for(c+=b?0:-1;b?c--:++c<f;){var a=d[c];if(a!==a)return c}return-1}},function(f,g,d){function c(d,a){return void 0===d?a:b(d,a,c)}var b=d(26);f.exports=c},function(f,g,d){var c=d(11),b=d(2),l=d(13),a=d(9),e=d(6),h=Object.prototype.hasOwnProperty;f.exports=function(d){for(var f=e(d),g=f.length,k=g&&d.length,p=!!k&&a(k)&&(b(d)||c(d)),r=-1,q=[];++r<g;){var x=f[r];(p&&l(x,k)||h.call(d,x))&&q.push(x)}return q}},function(f,g,d){var c=d(18),b=d(4),l=/^\[object .+?Constructor\]$/,a=Function.prototype.toString,e=RegExp("^"+a.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");f.exports=function(d){return null!=d&&(c(d)?e.test(a.call(d)):b(d)&&l.test(d))}},function(f,g,d){var c=d(32),b=d(11),l=d(4);g=Object.prototype;var a=g.hasOwnProperty,e=g.toString;f.exports=function(d){var f;if(!l(d)||"[object Object]"!=e.call(d)||b(d)||!(a.call(d,"constructor")||(f=d.constructor,"function"!=typeof f||f instanceof f)))return!1;var g;return c(d,function(a,b){g=b}),void 0===g||a.call(d,g)}},function(f,g,d){var c=d(29),b=d(6);f.exports=function(d){return c(d,b(d))}},function(f,g,d){f.exports={assign:d(25),create:d(86),defaults:d(87),defaultsDeep:d(88),extend:d(89),findKey:d(90),findLastKey:d(91),forIn:d(92),forInRight:d(93),forOwn:d(94),forOwnRight:d(95),functions:d(48),get:d(96),has:d(97),invert:d(98),keys:d(3),keysIn:d(6),mapKeys:d(99),mapValues:d(100),merge:d(26),methods:d(101),omit:d(102),pairs:d(49),pick:d(103),result:d(104),set:d(105),transform:d(106),values:d(107),valuesIn:d(108)}},function(f,g,d){var c=d(28),b=d(30),l=d(24);f.exports=function(a,d,f){var e=b(a);return f&&l(a,d,f)&&(d=void 0),d?c(e,d):e}},function(f,g,d){g=d(25);var c=d(57);d=d(40)(g,c);f.exports=d},function(f,g,d){g=d(40);var c=d(26);d=d(80);d=g(c,d);f.exports=d},function(f,g,d){f.exports=d(25)},function(f,g,d){g=d(16);d=d(41)(g);f.exports=d},function(f,g,d){g=d(33);d=d(41)(g);f.exports=d},function(f,g,d){g=d(22);d=d(42)(g);f.exports=d},function(f,g,d){g=d(34);d=d(42)(g);f.exports=d},function(f,g,d){g=d(16);d=d(43)(g);f.exports=d},function(f,g,d){g=d(33);d=d(43)(g);f.exports=d},function(f,g,d){var c=d(12),b=d(10);f.exports=function(d,a,e){d=null==d?void 0:c(d,b(a),a+"");return void 0===d?e:d}},function(f,g,d){var c=d(12),b=d(23),l=d(11),a=d(2),e=d(13),h=d(14),k=d(9),n=d(20),m=d(10),t=Object.prototype.hasOwnProperty;f.exports=function(d,f){if(null==d)return!1;var g=t.call(d,f);if(!g&&!h(f)){if(f=m(f),d=1==f.length?d:c(d,b(f,0,-1)),null==d)return!1;f=n(f);g=t.call(d,f)}return g||k(d.length)&&e(f,d.length)&&(a(d)||l(d))}},function(f,g,d){var c=d(24),b=d(3),l=Object.prototype.hasOwnProperty;f.exports=function(a,d,f){f&&c(a,d,f)&&(d=void 0);f=-1;for(var e=b(a),g=e.length,h={};++f<g;){var t=e[f],p=a[t];d?l.call(h,p)?h[p].push(t):h[p]=[t]:h[p]=t}return h}},function(f,g,d){g=d(44)(!0);f.exports=g},function(f,g,d){g=d(44)();f.exports=g},function(f,g,d){f.exports=d(48)},function(f,g,d){var c=d(54),b=d(59),l=d(31),a=d(7),e=d(6),h=d(46),k=d(47);g=d(15)(function(d,f){if(null==d)return{};if("function"!=typeof f[0])return f=c(l(f),String),h(d,b(e(d),f));var g=a(f[0],f[1],3);return k(d,function(a,b,c){return!g(a,b,c)})});f.exports=g},function(f,g,d){var c=d(31),b=d(7),l=d(46),a=d(47);g=d(15)(function(d,f){return null==d?{}:"function"==typeof f[0]?a(d,b(f[0],f[1],3)):l(d,c(f))});f.exports=g},function(f,g,d){var c=d(12),b=d(23),l=d(18),a=d(14),e=d(20),h=d(10);f.exports=function(d,f,g){var k=null==d?void 0:d[f];return void 0===k&&(null==d||a(f,d)||(f=h(f),d=1==f.length?d:c(d,b(f,0,-1)),k=null==d?void 0:d[e(f)]),k=void 0===k?g:k),l(k)?k.call(d):k}},function(f,g,d){var c=d(13),b=d(14),l=d(1),a=d(10);f.exports=function(d,f,g){if(null==d)return d;var e=f+"";f=null!=d[e]||b(f,d)?[e]:a(f);for(var e=-1,h=f.length,k=h-1,p=d;null!=p&&++e<h;){var r=f[e];l(p)&&(e==k?p[r]=g:null==p[r]&&(p[r]=c(f[e+1])?[]:{}));p=p[r]}return d}},function(f,g,d){var c=d(27),b=d(21),l=d(30),a=d(16),e=d(2),h=d(18),k=d(1),n=d(19);f.exports=function(d,f,g,r){var m=e(d)||n(d);if(f=b(f,r,4),null==g)m||k(d)?(r=d.constructor,g=m?e(d)?new r:[]:l(h(r)?r.prototype:void 0)):g={};return(m?c:a)(d,function(a,b,c){return f(g,a,b,c)}),g}},function(f,g,d){var c=d(37),b=d(3);f.exports=function(d){return c(d,b(d))}},function(f,g,d){var c=d(37),b=d(6);f.exports=function(d){return c(d,b(d))}},function(f,g,d){var c=d(36),b=d(69),l=d(14);f.exports=function(a){return l(a)?c(a):b(a)}},function(f,g){f.exports=function(d){return d.webpackPolyfill||(d.deprecate=function(){},d.paths=[],d.children=[],d.webpackPolyfill=1),d}},function(f,g){f.exports=L}]);L.Ajax=L.Class.extend({_timeout:6E4,_defs:[],initialize:function(){jQuery.support.cors=!0;this._timeout=6E4;this._defs=[]},getDefs:function(){return this._defs},_removeDef:function(f){for(var g=0;g<this._defs.length;g++)this._defs[g]===f&&this._defs.splice(g,1)},abort:function(){for(var f=0;f<this._defs.length;f++)this._defs[f].abort();this._defs=[]},_isSamePort:function(f){var g=window.location.port;f=f.split("/")[2].split(":");var d="80";""==g&&(g="80");1!=f.length&&(d=f[1]);return d==g?!0:!1},_isCrossDomain:function(f){if(-1==f.indexOf("http"))return!1;if(0==this._isSamePort(f))return!0;var g=document.domain;f=f.split("/")[2].split(":")[0];return g==f?!1:!0},get:function(f,g,d,c,b,l){1==this._isCrossDomain(f)&&(f=PROXY+f+"?");return this._request({url:f,data:g,async:d,dataType:"json",type:"GET",context:c,success:b,error:l})},post:function(f,g,d,c,b,l){1==this._isCrossDomain(f)&&(f=PROXY+f);return this._request({url:f,data:g,async:d,dataType:"json",type:"POST",context:c,success:b,error:l})},request:function(f,g,d,c,b){return this._request({url:f,data:g,dataType:"jsonp",type:"GET",context:d,success:c,error:b})},requestXML:function(f,g,d,c,b){1==this._isCrossDomain(f)&&(f=PROXY+f);return this._request({url:f,data:g,async:async,dataType:"xml",type:"GET",context:d,success:c,error:b})},requestHtml:function(f,g,d,c,b,l){1==this._isCrossDomain(f)&&(f=PROXY+f+"?");return this._request({url:f,data:g,async:d,dataType:"html",type:"GET",context:c,success:b,error:l,timeout:1E4})},_request:function(f){var g;try{var d=this;null==f.error&&(f.error=d.error);g=$.ajax({dataType:f.dataType,type:f.type,contentType:f.contentType||"application/x-www-form-urlencoded; charset\x3dGB2312",async:f.async,url:f.url,cache:!1,context:f.context,data:f.data,timeout:f.timeout||d._timeout});g.then(function(c){d._removeDef(g);"html"==f.dataType&&f.success.call(f.context,c);"string"===typeof c&&(c=$.parseJSON(c));f.success.call(f.context,c)},function(c){d._removeDef(g);f.error.call(f.context,c)});this._defs.push(g)}catch(c){console.log(c.message)}return g},error:function(f){console.log(f.message)},getParamString:function(f){var g="",d;for(d in f)"context"!=d&&"success"!=d&&"error"!=d&&(g+=d+"\x3d"+f[d]+"\x26");""!=g&&(g=g.substring(0,g.length-1));return g}});L.drawLocal={draw:{toolbar:{actions:{title:"\u53d6\u6d88\u7ed8\u5236",text:"\u53d6\u6d88"},finish:{title:"\u5b8c\u6210\u7ed8\u5236",text:"\u5b8c\u6210"},undo:{title:"\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5df2\u7ed8\u5236\u7684\u70b9",text:"\u5220\u9664\u6700\u540e\u7ed8\u5236\u70b9"},buttons:{polyline:"\u7ed8\u5236\u591a\u6bb5\u7ebf",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",rectangle:"\u7ed8\u5236\u957f\u65b9\u5f62",circle:"\u7ed8\u5236\u5706",marker:"\u7ed8\u5236\u6807\u8bb0"}},handlers:{circle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706"},radius:"\u534a\u5f84"},marker:{tooltip:{start:"\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"}},polygon:{tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u9762",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u9762"}},polyline:{error:"\x3cstrong\x3e\u9519\u8bef:\x3c/strong\x3e \u4e0d\u53ef\u81ea\u4ea4\u53c9!",tooltip:{start:"\u70b9\u51fb\u5f00\u59cb\u7ed8\u5236\u7ebf",cont:"\u70b9\u51fb\u7ee7\u7eed\u7ed8\u5236\u9762",end:"\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u5b8c\u6210\u7ed8\u5236\u7ebf"}},rectangle:{tooltip:{start:"\u70b9\u51fb\u5e76\u62d6\u62fd\u4ee5\u7ed8\u5236\u5706\u77e9\u5f62"}},simpleshape:{tooltip:{end:"\u653e\u5f00\u9f20\u6807\u5b8c\u6210\u7ed8\u5236"}}}},edit:{toolbar:{actions:{save:{title:"\u4fdd\u5b58\u4fee\u6539",text:"\u4fdd\u5b58"},cancel:{title:"\u53d6\u6d88\u7f16\u8f91\uff0c\u653e\u5f03\u4fee\u6539",text:"\u53d6\u6d88"}},buttons:{edit:"\u7f16\u8f91\u56fe\u5c42",editDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u7f16\u8f91",remove:"\u5220\u9664\u56fe\u5c42",removeDisabled:"\u6ca1\u6709\u56fe\u5c42\u53ef\u5220\u9664"}},handlers:{edit:{tooltip:{text:"\u62d6\u52a8\u63a7\u5236\u70b9\u6216\u6807\u8bb0\u4ee5\u4fee\u6539\u8981\u7d20",subtext:"\u70b9\u51fb\u53d6\u6d88\u653e\u5f03\u4fee\u6539"}},remove:{tooltip:{text:"\u70b9\u51fb\u4e00\u4e2a\u8981\u7d20\u4ee5\u5220\u9664"}}}}};"use strict";L.GeoMap=L.Map.extend({options:{basetileLayer:null,featureLayer:{},legendControl:{},GeoCoder:!1},initialize:function(f,g){if(g.projection&&"EPSG:4326"==g.projection){for(var d=[],c=0;8>c;c++)d[c]=.0015228550437313788/Math.pow(2,c);d[8]=7.1383830174908385E-6;d[9]=4.758922011660559E-6;g.crs=new L.Proj.CRS("EPSG:4326","+proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +no_defs",{origin:[119,32],resolutions:d})}else if(g.projection&&"EPSG:2437"==g.projection){d=[];for(c=0;12>c;c++)d[c]=169.33367200067735/Math.pow(2,c);g.crs=new L.Proj.CRS("EPSG:2437","+proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +no_defs",{origin:[0,91E3],resolutions:d})}else{d=[];for(c=0;21>c;c++)d[c]=1.40625/Math.pow(2,c);g.crs=new L.Proj.CRS("EPSG:4326","+proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +no_defs",{origin:[-180,90],resolutions:d})}c=g;g=L.setOptions(this,g);L.Map.prototype.initialize.call(this,f,L.extend({},L.Map.prototype.options,g));c&&c.crs||(g.crs=crs);if(g.basetileLayer instanceof Array&&0<g.basetileLayer.length)for(c=0;c<g.basetileLayer.length;c++)this.addLayer(g.basetileLayer[c]);else g.basetileLayer instanceof Array&&0==g.basetileLayer.length||(g.projection&&"EPSG:4326"==g.projection?this.addLayer(new L.GeoWMTSLayer("http://www.wxmap.com.cn/serviceaccess/wmts/wxMapGZ84",{type:"geotdtwmts",name:"\u65e0\u9521\u77e2\u91cf",visibility:!0,minZoom:0,maxZoom:10,title:"\u5929\u5730\u56fe",autoload:!1,group:"\u77e2\u91cf\u5730\u56fe",layer:"0",style:"default",format:"image/png"})):g.projection&&"EPSG:2437"==g.projection?this.addLayer(new L.GeoWMTSLayer("http://172.10.0.30:8080/ogcservice/wmts/WXMAPHB2018",{type:"geotdtwmts",name:"\u65e0\u952154",visibility:!1,minZoom:0,maxZoom:10,title:"\u5929\u5730\u56fe",autoload:!1,group:"\u65e0\u952154",layer:"0",style:"default",format:"image/png"})):(this.addLayer(new L.GeoTDTLayer.Vector),this.addLayer(new L.GeoTDTLayer.VectorAnno)));g.center||(g.center=g.projection&&"EPSG:2437"==g.projection?[46966.38049276099,81931.46219625768]:[31.585402714344134,120.247218280816]);g.zoom||(g.zoom=g.projection&&"EPSG:2437"==g.projection?3:13);this.setView(L.latLng(g.center),g.zoom,{reset:!0})},renderResourceControl:function(){}});L.geomap=function(f,g){return new L.GeoMap(f,g)};